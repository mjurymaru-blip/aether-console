This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.agent/
  workflows/
    backup.md
    export-context.md
    publish.md
    review-feedback.md
    setup-dual-remote.md
  rules.md
.github/
  workflows/
    deploy.yml
docs/
  development_workflow.md
  phase2_plan.md
  roadmap.md
  spec-kit-format.md
  task.md
  tech_stack.md
  ui_design_plan.md
src/
  lib/
    assets/
      favicon.svg
    components/
      AgentCard.svelte
      AgentChat.svelte
      ApiKeyDialog.svelte
      ConsoleLayout.svelte
      ConsoleLog.svelte
      DiffVisualizer.svelte
      GlitchText.svelte
      MessageFlow.svelte
      Panel.svelte
      ProposalPanel.svelte
      ScenarioPlayer.svelte
      SpecPatcher.svelte
      StatusIndicator.svelte
      StudioStatus.svelte
    data/
      agents.ts
      patches.ts
      scenarios.ts
    stores/
      agent-executor.ts
      crypto-store.ts
      gemini-client.ts
      proposal-store.ts
      settings-store.ts
      simulation.ts
      spec-diff.ts
      studio-connection.ts
    types/
      agent.ts
      integration.ts
      scenario.ts
      spec-diff.ts
    index.ts
  routes/
    +layout.svelte
    +layout.ts
    +page.svelte
  app.d.ts
  app.html
  global.css
static/
  icons/
    icon-192.png
    icon-512.png
  robots.txt
.gitignore
.npmrc
package.json
README.md
svelte.config.js
tsconfig.json
vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".agent/workflows/backup.md">
---
description: Giteaã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹
---
# Giteaãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

ç¾åœ¨ã®ä½œæ¥­çŠ¶æ…‹ã‚’Giteaã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã—ã¦ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚

## æ‰‹é †

// turbo
1. `git status` ã§ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç¢ºèª
2. æœªã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ãŒã‚ã‚‹å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
// turbo
3. `git add -A && git commit -m "<ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸>"` ã§å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
// turbo
4. `git push origin` ã§Giteaã¸ãƒ—ãƒƒã‚·ãƒ¥
5. å®Œäº†ã‚’å ±å‘Š
</file>

<file path=".agent/workflows/export-context.md">
---
description: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Gemini/ChatGPTãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
---
# ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

repomixã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’1ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã—ã€å¤–éƒ¨AIãƒ¬ãƒ“ãƒ¥ãƒ¼ã«å‚™ãˆã¾ã™ã€‚

## å‰ææ¡ä»¶

repomixãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€‚
æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆã¯ `npm install -g repomix` ã‚’å®Ÿè¡Œã€‚

## æ‰‹é †

// turbo
1. `npx repomix --output context.txt` ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
2. ç”Ÿæˆã•ã‚ŒãŸ `context.txt` ã®å†…å®¹ã‚µãƒãƒªãƒ¼ã‚’å ±å‘Š
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã€Œcontext.txt ã‚’Gemini/ChatGPTã«æ¸¡ã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼ã—ã¦ãã ã•ã„ã€ã¨æ¡ˆå†…

## ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå¾Œã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```
ä»¥ä¸‹ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å…¨ä½“ã§ã™ã€‚
ä»¥ä¸‹ã®è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼š

1. è¨­è¨ˆãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ•´åˆæ€§
2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ‡¸å¿µ
3. UI/UXã®æ”¹å–„æ¡ˆ
4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ä½™åœ°

---
[context.txtã®å†…å®¹ã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘]
```
</file>

<file path=".agent/workflows/review-feedback.md">
---
description: å¤–éƒ¨AIã®ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã‚’å–ã‚Šè¾¼ã‚€
---
# ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å–ã‚Šè¾¼ã¿ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

ChatGPT/Geminiã‹ã‚‰ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã‚’æ•´ç†ã—ã€ä¿®æ­£ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

## å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆæ¨å¥¨ï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä»¥ä¸‹ã®å½¢å¼ã§ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼š

```markdown
## å¤–éƒ¨AIãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ

### æ¡ç”¨ã™ã‚‹æŒ‡æ‘˜
- [ ] â—‹â—‹ã®ä¿®æ­£
- [ ] â–³â–³ã®è¿½åŠ 

### æ¤œè¨ãŒå¿…è¦ãªæŒ‡æ‘˜
- â–¡â–¡ã«ã¤ã„ã¦ï¼ˆç†ç”±: ...ï¼‰

### å´ä¸‹ã™ã‚‹æŒ‡æ‘˜
- Ã—Ã—ï¼ˆå´ä¸‹ç†ç”±: ...ï¼‰
```

## æ‰‹é †

1. ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã®å†…å®¹ã‚’è§£æã—ã€å¯¾å¿œé …ç›®ã‚’ä¸€è¦§åŒ–
2. ã€Œæ¡ç”¨ã™ã‚‹æŒ‡æ‘˜ã€ã«ã¤ã„ã¦ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¿®æ­£å†…å®¹ã‚’ç‰¹å®š
3. ä¿®æ­£ã‚’å®Ÿè¡Œ
4. ã€Œæ¤œè¨ãŒå¿…è¦ãªæŒ‡æ‘˜ã€ã«ã¤ã„ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ç›¸è«‡
5. ä¿®æ­£å®Œäº†å¾Œã€é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆdocs/ï¼‰ã‚‚æ›´æ–°
6. å¤‰æ›´ã‚µãƒãƒªãƒ¼ã‚’å ±å‘Š
</file>

<file path=".agent/workflows/setup-dual-remote.md">
---
description: Gitea/GitHub Dual Remoteç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
---
# Dual Remote ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

1ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªã«2ã¤ã®ãƒªãƒ¢ãƒ¼ãƒˆï¼ˆGitea + GitHubï¼‰ã‚’è¨­å®šã—ã¾ã™ã€‚

## å‰ææ¡ä»¶

- GitåˆæœŸåŒ–æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨
- Giteaã¨GitHubã®ãƒªãƒã‚¸ãƒˆãƒªURLã‚’ç”¨æ„ã—ã¦ã„ã‚‹ã“ã¨

## æ‰‹é †

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«Giteaã®ãƒªãƒã‚¸ãƒˆãƒªURLã‚’ç¢ºèª
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«GitHubã®ãƒªãƒã‚¸ãƒˆãƒªURLã‚’ç¢ºèª
// turbo
3. `git remote add origin <Giteaã®URL>` ã§Giteaã‚’originã¨ã—ã¦è¿½åŠ 
// turbo
4. `git remote add public <GitHubã®URL>` ã§GitHubã‚’publicã¨ã—ã¦è¿½åŠ 
// turbo
5. `git remote -v` ã§ãƒªãƒ¢ãƒ¼ãƒˆè¨­å®šã‚’ç¢ºèª
6. è¨­å®šå®Œäº†ã‚’å ±å‘Š

## é‹ç”¨ãƒ«ãƒ¼ãƒ«

| ãƒªãƒ¢ãƒ¼ãƒˆå | ç”¨é€” | ãƒ—ãƒƒã‚·ãƒ¥ã‚¿ã‚¤ãƒŸãƒ³ã‚° |
|-----------|------|-------------------|
| `origin` (Gitea) | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»WIP | ä½œæ¥­ã®åŒºåˆ‡ã‚Šã”ã¨ |
| `public` (GitHub) | å…¬é–‹ãƒ»AIãƒ¬ãƒ“ãƒ¥ãƒ¼ | ã‚¹ã‚¯ãƒƒã‚·ãƒ¥ãƒãƒ¼ã‚¸å¾Œ |
</file>

<file path=".agent/rules.md">
# Workspace Rules
1. å¸¸ã« `docs/development_workflow.md` ã‚’æœ€å„ªå…ˆã®æŒ‡ç¤ºæ›¸ã¨ã—ã¦éµå®ˆã—ã€å…¨ã¦ã®ä½œæ¥­å‰ã«ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¨ç¾åœ¨ã®ã‚¿ã‚¹ã‚¯ã®æ•´åˆæ€§ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
2. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆPlan/Taskç­‰ï¼‰ã¯å¿…ãš `docs/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã§ç®¡ç†ã—ã¦ãã ã•ã„ã€‚
3. Plan / Task ã«è¨˜è¼‰ã•ã‚ŒãŸç›®çš„ãƒ»ã‚¹ã‚³ãƒ¼ãƒ—ãƒ»åˆ¶ç´„ã¯ã€äººé–“ã®æ‰¿èªãªã—ã«å¤‰æ›´ã—ã¦ã¯ãªã‚Šã¾ã›ã‚“ã€‚å¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ã€Œå¤‰æ›´ææ¡ˆã€ã¨ã—ã¦æ˜ç¤ºã—ã¦ãã ã•ã„ã€‚
4. å®Ÿè£…ä½œæ¥­ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€å¯¾å¿œã™ã‚‹ Plan / Task ãŒ docs/ é…ä¸‹ã«å­˜åœ¨ã™ã‚‹ã“ã¨ã‚’å¿…ãšç¢ºèªã—ã¦ãã ã•ã„ã€‚
5. æŒ‡ç¤ºã‚„ä»•æ§˜ã«æ›–æ˜§ã•ã‚„çŸ›ç›¾ã‚’æ„Ÿã˜ãŸå ´åˆã€è‡ªå·±åˆ¤æ–­ã§è£œå®Œã›ãšã€å¿…ãšè³ªå•ã¾ãŸã¯ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
</file>

<file path=".github/workflows/deploy.yml">
name: Deploy to GitHub Pages

on:
  push:
    branches: ['main']
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: 'pages'
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build
        env:
          NODE_ENV: production
        run: npm run build

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: 'build'

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
</file>

<file path="docs/development_workflow.md">
<!-- Antigravity Instruction -->
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä¸Šè¨˜ã€Œé–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€ã«å³å¯†ã«å¾“ã£ã¦é–‹ç™ºã•ã‚Œã¾ã™ã€‚
Antigravityã¯å¸¸ã«ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã€å®šç¾©ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ï¼ˆ/backup, /publish ç­‰ï¼‰ã¨ãƒ—ãƒ­ã‚»ã‚¹ã‚’éµå®ˆã—ã¦ãã ã•ã„ã€‚
Planã‚„Taskã¯Artifactsã§ã¯ãªãã€`docs/` é…ä¸‹ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ç®¡ç†ã—ã¦ãã ã•ã„ã€‚

# é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

## é‡è¦ãªåŸå‰‡ï¼ˆå¿…é ˆï¼‰
[!IMPORTANT]
**Plan / Task ã«è¨˜è¼‰ã•ã‚ŒãŸã€Œç›®çš„ãƒ»ã‚¹ã‚³ãƒ¼ãƒ—ãƒ»åˆ¶ç´„ã€ã¯ã€äººé–“ã®æ‰¿èªãªã—ã«å¤‰æ›´ã—ã¦ã¯ãªã‚‰ãªã„ã€‚**
å¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ã€å¿…ãšã€Œå¤‰æ›´ææ¡ˆã€ã¨ã—ã¦åˆ¥ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¨˜è¿°ã—ã€æ‰¿èªã‚’å¾…ã¤ã“ã¨ã€‚

## æ¦‚è¦

è¤‡æ•°ã®AIï¼ˆGemini/ChatGPT/Antigravityï¼‰ã‚’æ´»ç”¨ã—ãŸåŠ¹ç‡çš„ãªé–‹ç™ºãƒ•ãƒ­ãƒ¼ã§ã™ã€‚

## é–‹ç™ºãƒ•ãƒ­ãƒ¼å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢å‡ºã—: Gemini/ChatGPT                       â”‚
â”‚  2. ãƒ—ãƒ©ãƒ³ä½œæˆ: Antigravity â†’ /review-feedback          â”‚
â”‚  3. å®Ÿè£…: Antigravity                                   â”‚
â”‚  4. ãƒ­ãƒ¼ã‚«ãƒ«ç¢ºèª: npm run dev (+ mkcert HTTPS)          â”‚
â”‚  5. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: /backup (Gitea)                       â”‚
â”‚  6. AIãƒ¬ãƒ“ãƒ¥ãƒ¼: /export-context â†’ Gemini/ChatGPT        â”‚
â”‚  7. ä¿®æ­£: /review-feedback â†’ 3ã«æˆ»ã‚‹                    â”‚
â”‚  8. å…¬é–‹æº–å‚™å®Œäº†: /publish â†’ GitHub Public + Pages      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ®µéšåˆ¥ãƒªãƒã‚¸ãƒˆãƒªé‹ç”¨

| é–‹ç™ºæ®µéš | ãƒªãƒã‚¸ãƒˆãƒª | ç¢ºèªæ–¹æ³• | AIãƒ¬ãƒ“ãƒ¥ãƒ¼ |
|----------|-----------|----------|-----------|
| **åˆæœŸé–‹ç™º** | Gitea | ãƒ­ãƒ¼ã‚«ãƒ«HTTP/HTTPS | repomix â†’ è²¼ã‚Šä»˜ã‘ |
| **æ©Ÿèƒ½å®Ÿè£…ä¸­** | Gitea | ãƒ­ãƒ¼ã‚«ãƒ«HTTPS | repomix â†’ è²¼ã‚Šä»˜ã‘ |
| **å…¬é–‹æº–å‚™** | GitHub Public | Pages | URLç›´æ¥å…±æœ‰å¯èƒ½ |
| **å…¬é–‹å¾Œ** | GitHub Public | Pages | URLç›´æ¥å…±æœ‰ |

## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ | ä½¿ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚° |
|---------|------|---------------|
| `/backup` | Giteaã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— | ä½œæ¥­ã®åŒºåˆ‡ã‚Šã”ã¨ |
| `/publish` | GitHubã¸ã‚¹ã‚¯ãƒƒã‚·ãƒ¥ãƒãƒ¼ã‚¸ | å…¬é–‹æº–å‚™å®Œäº†æ™‚ |
| `/review-feedback` | å¤–éƒ¨AIãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã‚’å–ã‚Šè¾¼ã‚€ | ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œ |
| `/export-context` | repomixã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ | AIãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼å‰ |
| `/setup-dual-remote` | Dual Remoteè¨­å®š | åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚ |

## ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆ

| ãƒªãƒ¢ãƒ¼ãƒˆå | URL | ç”¨é€” |
|-----------|-----|------|
| `origin` | Gitea (ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ) | é–‹ç™ºãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| `public` | GitHub (ãƒ‘ãƒ–ãƒªãƒƒã‚¯) | å…¬é–‹ãƒ»Pages |

## ãƒ­ãƒ¼ã‚«ãƒ«HTTPSç’°å¢ƒï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

PWAã®Service Workerç­‰ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆï¼š

```bash
# mkcertã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆåˆå›ã®ã¿ï¼‰
sudo apt install mkcert
mkcert -install
mkcert localhost

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ™‚ã«HTTPSæœ‰åŠ¹åŒ–
npm run dev -- --https
```

## AIãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
ä»¥ä¸‹ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å…¨ä½“ã§ã™ã€‚
ä»¥ä¸‹ã®è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼š

1. è¨­è¨ˆãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ•´åˆæ€§
2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ‡¸å¿µ
3. UI/UXã®æ”¹å–„æ¡ˆ
4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ä½™åœ°

---
[context.txtã®å†…å®¹ã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘]
```

## ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å½¢å¼

å¤–éƒ¨AIã‹ã‚‰ã®æŒ‡æ‘˜ã‚’Antigravityã«æ¸¡ã™éš›ã®æ¨å¥¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼š

```markdown
## å¤–éƒ¨AIãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ

### æ¡ç”¨ã™ã‚‹æŒ‡æ‘˜
- [ ] â—‹â—‹ã®ä¿®æ­£
- [ ] â–³â–³ã®è¿½åŠ 

### æ¤œè¨ãŒå¿…è¦ãªæŒ‡æ‘˜
- â–¡â–¡ã«ã¤ã„ã¦ï¼ˆç†ç”±: ...ï¼‰

### å´ä¸‹ã™ã‚‹æŒ‡æ‘˜
- Ã—Ã—ï¼ˆå´ä¸‹ç†ç”±: ...ï¼‰
```
</file>

<file path="docs/phase2_plan.md">
# Phase 2: é™çš„ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ å®Ÿè£…è¨ˆç”»

## ç›®æ¨™

ã€ŒAIãŒã„ãªãã¦ã‚‚ã€"AIãŒåˆ¶å¾¡ã•ã‚Œã¦ã„ã‚‹æ„Ÿè¦š"ãŒä½“é¨“ã§ãã‚‹ã€

---

## Proposed Changes

### 1. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å±¤

#### [NEW] [types/agent.ts](file:///home/gemini1/workspace3/aether-console/src/lib/types/agent.ts)
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚·ãƒŠãƒªã‚ªã®å‹å®šç¾©
- Spec-Kitå½¢å¼ã‚’TypeScriptã§è¡¨ç¾

#### [NEW] [types/scenario.ts](file:///home/gemini1/workspace3/aether-console/src/lib/types/scenario.ts)
- ã‚·ãƒŠãƒªã‚ªã‚¹ãƒ†ãƒƒãƒ—ã®å‹å®šç¾©
- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—ï¼ˆset-state, send-message, console-logï¼‰

---

### 2. ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿

#### [NEW] [data/agents.ts](file:///home/gemini1/workspace3/aether-console/src/lib/data/agents.ts)
- 4ã¤ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©ï¼ˆAnalyzer, Predictor, Monitor, Plannerï¼‰
- Spec-Kitå½¢å¼ã«æº–æ‹ 

#### [NEW] [data/scenarios.ts](file:///home/gemini1/workspace3/aether-console/src/lib/data/scenarios.ts)
- ãƒ‡ãƒ¢ç”¨ã‚·ãƒŠãƒªã‚ªã€Œbasic-analysis-flowã€
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã®ä¼šè©±ãƒ•ãƒ­ãƒ¼

---

### 3. çŠ¶æ…‹ç®¡ç†ï¼ˆSvelte Storeï¼‰

#### [NEW] [stores/simulation.ts](file:///home/gemini1/workspace3/aether-console/src/lib/stores/simulation.ts)
- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®ç®¡ç†
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã€ãƒ­ã‚°
- ã‚·ãƒŠãƒªã‚ªå†ç”Ÿã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼

---

### 4. UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### [NEW] [ScenarioPlayer.svelte](file:///home/gemini1/workspace3/aether-console/src/lib/components/ScenarioPlayer.svelte)
- å†ç”Ÿ/ä¸€æ™‚åœæ­¢/ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
- é€²è¡ŒçŠ¶æ³ãƒãƒ¼
- å†ç”Ÿé€Ÿåº¦èª¿æ•´

#### [NEW] [MessageFlow.svelte](file:///home/gemini1/workspace3/aether-console/src/lib/components/MessageFlow.svelte)
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å¯è¦–åŒ–
- é€ä¿¡å…ƒ â†’ é€ä¿¡å…ˆã®ãƒ•ãƒ­ãƒ¼è¡¨ç¤º

#### [MODIFY] [+page.svelte](file:///home/gemini1/workspace3/aether-console/src/routes/+page.svelte)
- ScenarioPlayerã‚’çµ±åˆ
- å‹•çš„ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹è¡¨ç¤º
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ­ãƒ¼è¡¨ç¤º

---

## ã‚·ãƒŠãƒªã‚ªå†ç”Ÿã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ScenarioPlayer (ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â–¶ Play  â¸ Pause  â¹ Reset  â© 2x  â”‚    â”‚
â”‚  â”‚ â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 45%            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ dispatch
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  simulation store                           â”‚
â”‚  - currentTime: number                      â”‚
â”‚  - agentStates: Map<string, AgentState>     â”‚
â”‚  - messages: Message[]                      â”‚
â”‚  - logs: LogEntry[]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ subscribe
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI Components                              â”‚
â”‚  - AgentCard (çŠ¶æ…‹æ›´æ–°)                      â”‚
â”‚  - ConsoleLog (ãƒ­ã‚°è¿½åŠ )                     â”‚
â”‚  - MessageFlow (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Verification Plan

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã§ã®ç¢ºèª
```bash
npm run dev
```

### ç¢ºèªãƒã‚¤ãƒ³ãƒˆ
1. **ã‚·ãƒŠãƒªã‚ªå†ç”Ÿ**: Playãƒœã‚¿ãƒ³ã§ã‚·ãƒŠãƒªã‚ªãŒé–‹å§‹ã•ã‚Œã‚‹ã‹
2. **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹å¤‰åŒ–**: AgentCardã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å¤‰åŒ–ã™ã‚‹ã‹
3. **ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°**: ã‚·ãƒŠãƒªã‚ªé€²è¡Œã«åˆã‚ã›ã¦ãƒ­ã‚°ãŒè¿½åŠ ã•ã‚Œã‚‹ã‹
4. **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ­ãƒ¼**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã®é€šä¿¡ãŒå¯è¦–åŒ–ã•ã‚Œã‚‹ã‹
5. **ä¸€æ™‚åœæ­¢/ãƒªã‚»ãƒƒãƒˆ**: ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‹
</file>

<file path="docs/ui_design_plan.md">
# SFé¢¨UIãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰

## æ¦‚è¦

Aether Consoleç”¨ã®SFé¢¨ï¼ˆã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯/å¸ä»¤å®¤ï¼‰ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

## ãƒ‡ã‚¶ã‚¤ãƒ³ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

> **ã€Œæ·±å®‡å®™ã®å¸ä»¤å®¤ã€** â€” æš—é—˜ã‹ã‚‰æµ®ã‹ã³ä¸ŠãŒã‚‹ã‚·ã‚¢ãƒ³/ãƒ–ãƒ«ãƒ¼ã®ãƒã‚ªãƒ³ãƒ©ã‚¤ãƒˆã€
> ãƒ›ãƒ­ã‚°ãƒ©ãƒ é¢¨ã®åŠé€æ˜ãƒ‘ãƒãƒ«ã€ã‚°ãƒªãƒƒãƒã‚¨ãƒ•ã‚§ã‚¯ãƒˆ

### ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ

| å½¹å‰² | ã‚«ãƒ©ãƒ¼ | ç”¨é€” |
|------|--------|------|
| **èƒŒæ™¯** | `#0a0a1a` (Deep Space) | ãƒ¡ã‚¤ãƒ³èƒŒæ™¯ |
| **ã‚µãƒ–èƒŒæ™¯** | `#0f0f2a` | ãƒ‘ãƒãƒ«èƒŒæ™¯ |
| **ãƒ—ãƒ©ã‚¤ãƒãƒª** | `#00ffff` (Cyan) | ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã€ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ |
| **ã‚»ã‚«ãƒ³ãƒ€ãƒª** | `#00aaff` (Blue) | ãƒªãƒ³ã‚¯ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ– |
| **è­¦å‘Š** | `#ff6b35` (Orange) | è­¦å‘Šè¡¨ç¤º |
| **å±é™º** | `#ff3366` (Red) | ã‚¨ãƒ©ãƒ¼ã€å±é™º |
| **æˆåŠŸ** | `#00ff88` (Green) | æˆåŠŸã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ– |
| **ãƒ†ã‚­ã‚¹ãƒˆ** | `#e0e0e0` | æœ¬æ–‡ |
| **ãƒ†ã‚­ã‚¹ãƒˆæš—** | `#888888` | ã‚µãƒ–ãƒ†ã‚­ã‚¹ãƒˆ |

### ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ

1. **ã‚°ãƒ­ãƒ¼åŠ¹æœ** â€” ãƒ†ã‚­ã‚¹ãƒˆã‚„ãƒœãƒ¼ãƒ€ãƒ¼ã«ã‚·ã‚¢ãƒ³ã®ç™ºå…‰
2. **ã‚¹ã‚­ãƒ£ãƒ³ãƒ©ã‚¤ãƒ³** â€” CRTé¢¨ã®æ°´å¹³ç·šã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
3. **ã‚°ãƒªãƒƒãƒ** â€” ãƒ†ã‚­ã‚¹ãƒˆã®ãšã‚Œ/æ­ªã¿ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
4. **ãƒ‘ãƒãƒ«ãƒœãƒ¼ãƒ€ãƒ¼** â€” è§’ã‚’åˆ‡ã‚Šè½ã¨ã—ãŸSFé¢¨ãƒ•ãƒ¬ãƒ¼ãƒ 

---

## Proposed Changes

### ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ åŸºç›¤

#### [NEW] [global.css](file:///home/gemini1/workspace3/aether-console/src/global.css)
- CSSå¤‰æ•°ï¼ˆã‚«ãƒ©ãƒ¼ã€ã‚¹ãƒšãƒ¼ã‚·ãƒ³ã‚°ã€ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£ï¼‰
- ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒªã‚»ãƒƒãƒˆ
- SFé¢¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ï¼ˆ`.glow`, `.scanlines`, `.panel`ï¼‰

#### [MODIFY] [+layout.svelte](file:///home/gemini1/workspace3/aether-console/src/routes/+layout.svelte)
- `global.css`ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- åŸºæœ¬çš„ãªãƒšãƒ¼ã‚¸ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’è¿½åŠ 

---

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### [NEW] [Panel.svelte](file:///home/gemini1/workspace3/aether-console/src/lib/components/Panel.svelte)
- SFé¢¨ã®ãƒ‘ãƒãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- è§’ã‚’åˆ‡ã‚Šè½ã¨ã—ãŸãƒœãƒ¼ãƒ€ãƒ¼
- ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ãƒ˜ãƒƒãƒ€ãƒ¼/ã‚¿ã‚¤ãƒˆãƒ«

#### [NEW] [GlitchText.svelte](file:///home/gemini1/workspace3/aether-console/src/lib/components/GlitchText.svelte)
- ã‚°ãƒªãƒƒãƒã‚¨ãƒ•ã‚§ã‚¯ãƒˆä»˜ããƒ†ã‚­ã‚¹ãƒˆ
- ãƒ›ãƒãƒ¼æ™‚ã«ã‚°ãƒªãƒƒãƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

#### [NEW] [StatusIndicator.svelte](file:///home/gemini1/workspace3/aether-console/src/lib/components/StatusIndicator.svelte)
- AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºç”¨
- ãƒ‘ãƒ«ã‚¹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ã

---

### ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸

#### [MODIFY] [+page.svelte](file:///home/gemini1/workspace3/aether-console/src/routes/+page.svelte)
- ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼/ãƒ‡ãƒ¢
- å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¡¨ç¤ºç¢ºèª

---

## Verification Plan

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã§ã®ç¢ºèª
```bash
npm run dev
```
â†’ http://localhost:5173/ ã§ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ç¢ºèª

### ç¢ºèªãƒã‚¤ãƒ³ãƒˆ
1. ãƒ€ãƒ¼ã‚¯èƒŒæ™¯ã«ã‚·ã‚¢ãƒ³ã®ã‚°ãƒ­ãƒ¼åŠ¹æœãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
2. Panelã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è§’ãŒåˆ‡ã‚Šè½ã¨ã•ã‚Œã¦ã„ã‚‹ã‹
3. GlitchTextã®ãƒ›ãƒãƒ¼ã§ã‚°ãƒªãƒƒãƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ä½œã™ã‚‹ã‹
4. StatusIndicatorã®ãƒ‘ãƒ«ã‚¹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ä½œã™ã‚‹ã‹
</file>

<file path="src/lib/assets/favicon.svg">
<svg xmlns="http://www.w3.org/2000/svg" width="107" height="128" viewBox="0 0 107 128"><title>svelte-logo</title><path d="M94.157 22.819c-10.4-14.885-30.94-19.297-45.792-9.835L22.282 29.608A29.92 29.92 0 0 0 8.764 49.65a31.5 31.5 0 0 0 3.108 20.231 30 30 0 0 0-4.477 11.183 31.9 31.9 0 0 0 5.448 24.116c10.402 14.887 30.942 19.297 45.791 9.835l26.083-16.624A29.92 29.92 0 0 0 98.235 78.35a31.53 31.53 0 0 0-3.105-20.232 30 30 0 0 0 4.474-11.182 31.88 31.88 0 0 0-5.447-24.116" style="fill:#ff3e00"/><path d="M45.817 106.582a20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.503 18 18 0 0 1 .624-2.435l.49-1.498 1.337.981a33.6 33.6 0 0 0 10.203 5.098l.97.294-.09.968a5.85 5.85 0 0 0 1.052 3.878 6.24 6.24 0 0 0 6.695 2.485 5.8 5.8 0 0 0 1.603-.704L69.27 76.28a5.43 5.43 0 0 0 2.45-3.631 5.8 5.8 0 0 0-.987-4.371 6.24 6.24 0 0 0-6.698-2.487 5.7 5.7 0 0 0-1.6.704l-9.953 6.345a19 19 0 0 1-5.296 2.326 20.72 20.72 0 0 1-22.237-8.243 19.17 19.17 0 0 1-3.277-14.502 17.99 17.99 0 0 1 8.13-12.052l26.081-16.623a19 19 0 0 1 5.3-2.329 20.72 20.72 0 0 1 22.237 8.243 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-.624 2.435l-.49 1.498-1.337-.98a33.6 33.6 0 0 0-10.203-5.1l-.97-.294.09-.968a5.86 5.86 0 0 0-1.052-3.878 6.24 6.24 0 0 0-6.696-2.485 5.8 5.8 0 0 0-1.602.704L37.73 51.72a5.42 5.42 0 0 0-2.449 3.63 5.79 5.79 0 0 0 .986 4.372 6.24 6.24 0 0 0 6.698 2.486 5.8 5.8 0 0 0 1.602-.704l9.952-6.342a19 19 0 0 1 5.295-2.328 20.72 20.72 0 0 1 22.237 8.242 19.17 19.17 0 0 1 3.277 14.503 18 18 0 0 1-8.13 12.053l-26.081 16.622a19 19 0 0 1-5.3 2.328" style="fill:#fff"/></svg>
</file>

<file path="src/lib/components/AgentCard.svelte">
<!--
  AgentCard.svelte - AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰
  
  å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã‚«ãƒ¼ãƒ‰
-->
<script lang="ts">
	import StatusIndicator from './StatusIndicator.svelte';

	interface Props {
		name: string;
		role: string;
		status: 'active' | 'idle' | 'warning' | 'error' | 'offline';
		description?: string;
		currentTask?: string;
		progress?: number;
		metrics?: {
			tasksCompleted?: number;
			responseTime?: string;
			errorRate?: number;
		};
	}

	let { name, role, status, description, currentTask, progress, metrics } = $props<Props>();
</script>

<div class="agent-card" class:active={status === 'active'}>
	<div class="card-header">
		<div class="agent-identity">
			<span class="agent-icon">â—ˆ</span>
			<div class="agent-info">
				<h3 class="agent-name">{name}</h3>
				<span class="agent-role">{role}</span>
			</div>
		</div>
		<StatusIndicator {status} size="md" />
	</div>

	{#if description}
		<p class="agent-description">{description}</p>
	{/if}

	{#if currentTask}
		<div class="current-task">
			<span class="task-label">CURRENT TASK</span>
			<span class="task-value">{currentTask}</span>
			{#if progress !== undefined}
				<div class="progress-bar">
					<div class="progress-fill" style="width: {progress * 100}%"></div>
				</div>
			{/if}
		</div>
	{/if}

	{#if metrics}
		<div class="metrics">
			{#if metrics.tasksCompleted !== undefined}
				<div class="metric">
					<span class="metric-value">{metrics.tasksCompleted}</span>
					<span class="metric-label">Tasks</span>
				</div>
			{/if}
			{#if metrics.responseTime}
				<div class="metric">
					<span class="metric-value">{metrics.responseTime}</span>
					<span class="metric-label">Avg Time</span>
				</div>
			{/if}
			{#if metrics.errorRate !== undefined}
				<div class="metric">
					<span class="metric-value" class:error={metrics.errorRate > 0.1}>
						{(metrics.errorRate * 100).toFixed(1)}%
					</span>
					<span class="metric-label">Errors</span>
				</div>
			{/if}
		</div>
	{/if}
</div>

<style>
	.agent-card {
		background: var(--color-bg-panel);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-md);
		padding: var(--space-md);
		transition: all var(--transition-normal);
	}

	.agent-card:hover {
		border-color: var(--color-border-bright);
		box-shadow: 0 0 20px rgba(0, 255, 255, 0.1);
	}

	.agent-card.active {
		border-color: var(--color-green);
		box-shadow: 0 0 15px rgba(0, 255, 136, 0.2);
	}

	.card-header {
		display: flex;
		justify-content: space-between;
		align-items: flex-start;
		margin-bottom: var(--space-md);
	}

	.agent-identity {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
	}

	.agent-icon {
		font-size: 1.5rem;
		color: var(--color-cyan);
		text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
	}

	.agent-info {
		display: flex;
		flex-direction: column;
	}

	.agent-name {
		font-size: 1rem;
		font-weight: 600;
		margin: 0;
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.agent-role {
		font-size: 0.7rem;
		color: var(--color-text-dim);
		text-transform: uppercase;
		letter-spacing: 0.1em;
	}

	.agent-description {
		font-size: 0.8rem;
		color: var(--color-text-dim);
		margin: 0 0 var(--space-md);
		line-height: 1.5;
	}

	.current-task {
		background: rgba(0, 255, 255, 0.05);
		border-left: 2px solid var(--color-cyan);
		padding: var(--space-sm) var(--space-md);
		margin-bottom: var(--space-md);
	}

	.task-label {
		display: block;
		font-size: 0.6rem;
		color: var(--color-text-dim);
		text-transform: uppercase;
		letter-spacing: 0.1em;
		margin-bottom: var(--space-xs);
	}

	.task-value {
		font-size: 0.8rem;
		font-family: var(--font-mono);
		color: var(--color-cyan);
	}

	.progress-bar {
		height: 3px;
		background: var(--color-bg-secondary);
		margin-top: var(--space-sm);
		border-radius: var(--radius-sm);
		overflow: hidden;
	}

	.progress-fill {
		height: 100%;
		background: linear-gradient(90deg, var(--color-cyan), var(--color-blue));
		transition: width var(--transition-normal);
	}

	.metrics {
		display: flex;
		gap: var(--space-lg);
		padding-top: var(--space-sm);
		border-top: 1px solid var(--color-border);
	}

	.metric {
		display: flex;
		flex-direction: column;
		align-items: center;
	}

	.metric-value {
		font-size: 1rem;
		font-weight: 600;
		font-family: var(--font-mono);
		color: var(--color-text-bright);
	}

	.metric-value.error {
		color: var(--color-red);
	}

	.metric-label {
		font-size: 0.6rem;
		color: var(--color-text-dim);
		text-transform: uppercase;
	}
</style>
</file>

<file path="src/lib/components/ConsoleLog.svelte">
<!--
  ConsoleLog.svelte - ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›è¡¨ç¤º
  
  ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°è¡¨ç¤ºç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
-->
<script lang="ts">
	interface LogEntry {
		timestamp: string;
		level: 'info' | 'success' | 'warning' | 'error' | 'debug';
		source?: string;
		message: string;
	}

	interface Props {
		logs: LogEntry[];
		maxHeight?: string;
		autoScroll?: boolean;
	}

	let { logs, maxHeight = '300px', autoScroll = true } = $props<Props>();

	const levelColors: Record<string, string> = {
		info: 'var(--color-text-dim)',
		success: 'var(--color-green)',
		warning: 'var(--color-orange)',
		error: 'var(--color-red)',
		debug: 'var(--color-blue)'
	};

	const levelIcons: Record<string, string> = {
		info: 'â—‹',
		success: 'â—',
		warning: 'â—',
		error: 'â—‰',
		debug: 'â—‡'
	};
</script>

<div class="console-log" style="max-height: {maxHeight}">
	{#each logs as log}
		<div class="log-entry" style="--level-color: {levelColors[log.level]}">
			<span class="log-icon">{levelIcons[log.level]}</span>
			<span class="log-timestamp">[{log.timestamp}]</span>
			{#if log.source}
				<span class="log-source">{log.source}</span>
			{/if}
			<span class="log-message">{log.message}</span>
		</div>
	{/each}
</div>

<style>
	.console-log {
		font-family: var(--font-mono);
		font-size: 0.75rem;
		line-height: 1.6;
		overflow-y: auto;
		background: rgba(0, 0, 0, 0.3);
		border-radius: var(--radius-sm);
		padding: var(--space-sm);
	}

	.log-entry {
		display: flex;
		gap: var(--space-sm);
		padding: 2px 0;
		color: var(--level-color);
	}

	.log-entry:hover {
		background: rgba(0, 255, 255, 0.05);
	}

	.log-icon {
		flex-shrink: 0;
		width: 1em;
		text-align: center;
	}

	.log-timestamp {
		flex-shrink: 0;
		color: var(--color-text-dim);
	}

	.log-source {
		flex-shrink: 0;
		color: var(--color-cyan);
	}

	.log-source::after {
		content: ':';
	}

	.log-message {
		flex: 1;
		word-break: break-word;
	}
</style>
</file>

<file path="src/lib/components/DiffVisualizer.svelte">
<!--
  DiffVisualizer.svelte - å·®åˆ†ã®å¯è¦–åŒ–
-->
<script lang="ts">
	import { appliedPatchesStore } from '$lib/stores/spec-diff';
	import type { SpecDiff } from '$lib/types/spec-diff';

	// é©ç”¨æ¸ˆã¿ãƒ‘ãƒƒãƒã‹ã‚‰ã™ã¹ã¦ã®diffã‚’æŠ½å‡º
	let allDiffs = $derived(
		$appliedPatchesStore.flatMap(patch => 
			patch.diffs.map(d => ({ ...d, patchName: patch.name }))
		)
	);

	// æ“ä½œã‚¿ã‚¤ãƒ—åˆ¥ã‚¢ã‚¤ã‚³ãƒ³
	const operationIcons: Record<string, string> = {
		add: '+',
		remove: '-',
		modify: '~'
	};

	// æ“ä½œã‚¿ã‚¤ãƒ—åˆ¥è‰²
	const operationColors: Record<string, string> = {
		add: 'var(--color-green)',
		remove: 'var(--color-red)',
		modify: 'var(--color-orange)'
	};
</script>

<div class="diff-visualizer">
	{#if allDiffs.length === 0}
		<div class="empty-state">
			<span class="icon">â—‡</span>
			<p>é©ç”¨ä¸­ã®å·®åˆ†ãªã—</p>
			<span class="hint">ãƒ‘ãƒƒãƒã‚’é©ç”¨ã™ã‚‹ã¨å·®åˆ†ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</span>
		</div>
	{:else}
		<div class="diff-list">
			{#each allDiffs as diff}
				{@const color = operationColors[diff.operation]}
				<div class="diff-item" style="--op-color: {color}">
					<div class="diff-header">
						<span class="op-icon">{operationIcons[diff.operation]}</span>
						<span class="agent-name">{diff.agentName}</span>
						<span class="path">{diff.path}</span>
					</div>
					<div class="diff-content">
						{#if diff.operation === 'modify'}
							<div class="before">
								<span class="label">Before:</span>
								<code>{JSON.stringify(diff.before)}</code>
							</div>
							<div class="arrow">â†’</div>
							<div class="after">
								<span class="label">After:</span>
								<code>{JSON.stringify(diff.after)}</code>
							</div>
						{:else if diff.operation === 'add'}
							<div class="after">
								<span class="label">Add:</span>
								<code>{JSON.stringify(diff.after)}</code>
							</div>
						{:else}
							<div class="before">
								<span class="label">Remove:</span>
								<code>{JSON.stringify(diff.before)}</code>
							</div>
						{/if}
					</div>
					<div class="diff-footer">
						<span class="description">{diff.description}</span>
					</div>
				</div>
			{/each}
		</div>
	{/if}
</div>

<style>
	.diff-visualizer {
		min-height: 100px;
	}

	.empty-state {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		height: 100px;
		color: var(--color-text-dim);
		text-align: center;
	}

	.empty-state .icon {
		font-size: 1.5rem;
		opacity: 0.5;
		margin-bottom: var(--space-sm);
	}

	.empty-state p {
		font-size: 0.8rem;
		margin: 0;
	}

	.empty-state .hint {
		font-size: 0.65rem;
		margin-top: var(--space-xs);
	}

	.diff-list {
		display: flex;
		flex-direction: column;
		gap: var(--space-sm);
	}

	.diff-item {
		background: rgba(0, 0, 0, 0.3);
		border-left: 3px solid var(--op-color);
		border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
		padding: var(--space-sm);
		font-family: var(--font-mono);
		font-size: 0.75rem;
	}

	.diff-header {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
		margin-bottom: var(--space-xs);
	}

	.op-icon {
		width: 16px;
		height: 16px;
		display: flex;
		align-items: center;
		justify-content: center;
		background: var(--op-color);
		color: var(--color-bg-primary);
		border-radius: 2px;
		font-weight: bold;
	}

	.agent-name {
		color: var(--color-cyan);
		text-transform: capitalize;
	}

	.path {
		color: var(--color-text-dim);
	}

	.diff-content {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
		padding: var(--space-xs) 0;
		flex-wrap: wrap;
	}

	.before, .after {
		display: flex;
		align-items: center;
		gap: var(--space-xs);
	}

	.before .label {
		color: var(--color-red);
	}

	.after .label {
		color: var(--color-green);
	}

	.label {
		font-size: 0.65rem;
		text-transform: uppercase;
	}

	code {
		background: rgba(0, 0, 0, 0.3);
		padding: 2px 6px;
		border-radius: 2px;
		color: var(--color-text-bright);
	}

	.arrow {
		color: var(--color-text-dim);
	}

	.diff-footer {
		margin-top: var(--space-xs);
		padding-top: var(--space-xs);
		border-top: 1px solid var(--color-border);
	}

	.description {
		font-size: 0.7rem;
		color: var(--color-text-dim);
		font-family: var(--font-primary);
	}
</style>
</file>

<file path="src/lib/components/GlitchText.svelte">
<!--
  GlitchText.svelte - ã‚°ãƒªãƒƒãƒã‚¨ãƒ•ã‚§ã‚¯ãƒˆä»˜ããƒ†ã‚­ã‚¹ãƒˆ
  
  Usage:
    <GlitchText text="AETHER CONSOLE" />
-->
<script lang="ts">
	interface Props {
		text: string;
		tag?: 'h1' | 'h2' | 'h3' | 'h4' | 'span' | 'p';
		glitchOnHover?: boolean;
		intensity?: 'low' | 'medium' | 'high';
	}

	let { text, tag = 'span', glitchOnHover = true, intensity = 'medium' } = $props<Props>();
</script>

<svelte:element 
	this={tag}
	class="glitch-text"
	class:glitch-hover={glitchOnHover}
	class:intensity-low={intensity === 'low'}
	class:intensity-high={intensity === 'high'}
	data-text={text}
>
	{text}
</svelte:element>

<style>
	.glitch-text {
		position: relative;
		display: inline-block;
		color: var(--color-text-bright);
		text-shadow: var(--glow-cyan);
	}

	.glitch-text::before,
	.glitch-text::after {
		content: attr(data-text);
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		opacity: 0;
	}

	.glitch-text::before {
		color: var(--color-red);
		z-index: -1;
	}

	.glitch-text::after {
		color: var(--color-cyan);
		z-index: -2;
	}

	/* Hover Glitch Effect */
	.glitch-hover:hover {
		animation: glitch 0.3s infinite;
	}

	.glitch-hover:hover::before,
	.glitch-hover:hover::after {
		opacity: 0.8;
	}

	.glitch-hover:hover::before {
		animation: glitch-offset-1 0.3s infinite;
	}

	.glitch-hover:hover::after {
		animation: glitch-offset-2 0.3s infinite;
	}

	/* Intensity Variations */
	.intensity-low:hover {
		animation-duration: 0.5s;
	}

	.intensity-high:hover {
		animation-duration: 0.15s;
	}

	@keyframes glitch {
		0%, 100% { transform: translate(0); }
		20% { transform: translate(-2px, 2px); }
		40% { transform: translate(2px, -2px); }
		60% { transform: translate(-1px, 1px); }
		80% { transform: translate(1px, -1px); }
	}

	@keyframes glitch-offset-1 {
		0%, 100% { transform: translate(0); }
		20% { transform: translate(2px, -1px); }
		40% { transform: translate(-2px, 1px); }
		60% { transform: translate(1px, 2px); }
		80% { transform: translate(-1px, -2px); }
	}

	@keyframes glitch-offset-2 {
		0%, 100% { transform: translate(0); }
		20% { transform: translate(-1px, 2px); }
		40% { transform: translate(1px, -2px); }
		60% { transform: translate(2px, -1px); }
		80% { transform: translate(-2px, 1px); }
	}
</style>
</file>

<file path="src/lib/components/MessageFlow.svelte">
<!--
  MessageFlow.svelte - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å¯è¦–åŒ–
-->
<script lang="ts">
	import { messageStore } from '$lib/stores/simulation';
	import { agents } from '$lib/data/agents';

	// æœ€æ–°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
	let messages = $derived($messageStore.slice(-5));

	// ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåã‹ã‚‰ã‚¢ã‚¤ã‚³ãƒ³ã‚’å–å¾—
	function getAgentIcon(name: string): string {
		const agent = agents.find(a => a.name === name);
		return agent?.icon || 'â—¯';
	}

	// å„ªå…ˆåº¦ã«å¿œã˜ãŸè‰²
	function getPriorityColor(priority: string): string {
		switch (priority) {
			case 'critical': return 'var(--color-red)';
			case 'high': return 'var(--color-orange)';
			case 'normal': return 'var(--color-cyan)';
			default: return 'var(--color-text-dim)';
		}
	}
</script>

<div class="message-flow">
	{#if messages.length === 0}
		<div class="empty-state">
			<span class="icon">â—‡</span>
			<p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—</p>
		</div>
	{:else}
		<div class="messages">
			{#each messages as message (message.id)}
				<div class="message-item" style="--priority-color: {getPriorityColor(message.priority)}">
					<div class="message-header">
						<div class="agent from">
							<span class="agent-icon">{getAgentIcon(message.from)}</span>
							<span class="agent-name">{message.from}</span>
						</div>
						<div class="arrow">â†’</div>
						<div class="agent to">
							<span class="agent-icon">{getAgentIcon(message.to)}</span>
							<span class="agent-name">{message.to}</span>
						</div>
						<span class="priority-badge">{message.priority}</span>
					</div>
					<div class="message-content">
						<span class="message-type">{message.type}</span>
						<span class="message-summary">{message.content.summary}</span>
					</div>
				</div>
			{/each}
		</div>
	{/if}
</div>

<style>
	.message-flow {
		min-height: 150px;
	}

	.empty-state {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		height: 150px;
		color: var(--color-text-dim);
	}

	.empty-state .icon {
		font-size: 2rem;
		opacity: 0.5;
		margin-bottom: var(--space-sm);
	}

	.empty-state p {
		font-size: 0.8rem;
	}

	.messages {
		display: flex;
		flex-direction: column;
		gap: var(--space-sm);
	}

	.message-item {
		background: rgba(0, 0, 0, 0.2);
		border-left: 3px solid var(--priority-color);
		padding: var(--space-sm) var(--space-md);
		border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
		animation: slideIn 0.3s ease-out;
	}

	@keyframes slideIn {
		from {
			opacity: 0;
			transform: translateX(-10px);
		}
		to {
			opacity: 1;
			transform: translateX(0);
		}
	}

	.message-header {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
		margin-bottom: var(--space-xs);
	}

	.agent {
		display: flex;
		align-items: center;
		gap: var(--space-xs);
	}

	.agent-icon {
		color: var(--color-cyan);
		font-size: 0.9rem;
	}

	.agent-name {
		font-size: 0.75rem;
		text-transform: capitalize;
		font-weight: 500;
	}

	.arrow {
		color: var(--priority-color);
		font-weight: bold;
	}

	.priority-badge {
		margin-left: auto;
		font-size: 0.6rem;
		text-transform: uppercase;
		padding: 2px 6px;
		border-radius: var(--radius-sm);
		background: rgba(0, 0, 0, 0.3);
		color: var(--priority-color);
		border: 1px solid var(--priority-color);
	}

	.message-content {
		display: flex;
		flex-direction: column;
		gap: 2px;
	}

	.message-type {
		font-size: 0.65rem;
		color: var(--color-text-dim);
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.message-summary {
		font-size: 0.8rem;
		color: var(--color-text);
	}
</style>
</file>

<file path="src/lib/components/Panel.svelte">
<!--
  Panel.svelte - SFé¢¨ãƒ‘ãƒãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  
  Usage:
    <Panel title="SYSTEM STATUS">
      ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
    </Panel>
-->
<script lang="ts">
	interface Props {
		title?: string;
		variant?: 'default' | 'corner' | 'minimal';
		glow?: boolean;
	}

	let { title, variant = 'corner', glow = false, children } = $props<Props>();
</script>

<div 
	class="panel" 
	class:panel-corner={variant === 'corner'}
	class:panel-minimal={variant === 'minimal'}
	class:glow-box={glow}
>
	{#if title}
		<div class="panel-header">
			<span class="panel-title">{title}</span>
			<div class="panel-decoration"></div>
		</div>
	{/if}
	<div class="panel-content">
		{@render children?.()}
	</div>
</div>

<style>
	.panel {
		background: var(--color-bg-panel);
		border: 1px solid var(--color-border);
		position: relative;
		backdrop-filter: blur(10px);
		transition: border-color var(--transition-normal), box-shadow var(--transition-normal);
	}

	.panel:hover {
		border-color: var(--color-border-bright);
	}

	.panel-corner {
		clip-path: polygon(
			0 12px,
			12px 0,
			100% 0,
			100% calc(100% - 12px),
			calc(100% - 12px) 100%,
			0 100%
		);
	}

	.panel-minimal {
		background: transparent;
		border: none;
		border-left: 2px solid var(--color-cyan);
		padding-left: var(--space-md);
	}

	.panel-header {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
		padding: var(--space-sm) var(--space-md);
		border-bottom: 1px solid var(--color-border);
		background: rgba(0, 255, 255, 0.05);
	}

	.panel-title {
		font-size: 0.75rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: var(--color-cyan);
		text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
	}

	.panel-decoration {
		flex: 1;
		height: 1px;
		background: linear-gradient(90deg, var(--color-border-bright), transparent);
	}

	.panel-content {
		padding: var(--space-md);
	}

	.glow-box {
		box-shadow: var(--glow-cyan);
	}
</style>
</file>

<file path="src/lib/components/ProposalPanel.svelte">
<!--
  ProposalPanel.svelte - çµ±åˆææ¡ˆãƒ‘ãƒãƒ«
  è¤‡æ•°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ã®å‡ºåŠ›ã‚’çµ±åˆã—ã€æœ€çµ‚ææ¡ˆã‚’è¡¨ç¤º
-->
<script lang="ts">
	import { proposalStore } from '$lib/stores/proposal-store';
	import { settingsStore } from '$lib/stores/settings-store';

	let proposalState = $derived($proposalStore);
	let settings = $derived($settingsStore);

	let userInput = $state('');

	async function handleSubmit() {
		if (!userInput.trim() || proposalState.isRunning) return;

		const input = userInput;
		userInput = '';

		await proposalStore.runIntegratedAnalysis(input, settings.selectedModel);
	}

	function handleKeyDown(event: KeyboardEvent) {
		if (event.key === 'Enter' && !event.shiftKey) {
			event.preventDefault();
			handleSubmit();
		}
	}

	function getStatusIcon(status: string): string {
		switch (status) {
			case 'pending': return 'â—‹';
			case 'running': return 'â—‡';
			case 'completed': return 'âœ“';
			case 'error': return 'âœ—';
			default: return 'â—‹';
		}
	}

	function getStatusClass(status: string): string {
		switch (status) {
			case 'pending': return 'status-pending';
			case 'running': return 'status-running';
			case 'completed': return 'status-completed';
			case 'error': return 'status-error';
			default: return '';
		}
	}
</script>

<div class="proposal-panel">
	{#if !settings.apiKeyReady}
		<div class="api-notice">
			<span class="icon">ğŸ”‘</span>
			<p>çµ±åˆåˆ†æã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯APIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„</p>
		</div>
	{:else}
		<!-- å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ -->
		<div class="input-section">
			<textarea
				bind:value={userInput}
				onkeydown={handleKeyDown}
				placeholder="åˆ†æå¯¾è±¡ã‚’å…¥åŠ›... (Enter ã§å®Ÿè¡Œ)"
				disabled={proposalState.isRunning}
			></textarea>
			<button
				class="run-btn"
				onclick={handleSubmit}
				disabled={!userInput.trim() || proposalState.isRunning}
			>
				{proposalState.isRunning ? 'å®Ÿè¡Œä¸­...' : 'çµ±åˆåˆ†æ'}
			</button>
		</div>

		<!-- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€²æ— -->
		{#if proposalState.agentResults.length > 0}
			<div class="agent-progress">
				<div class="phase-indicator">
					{#if proposalState.currentPhase === 'gathering'}
						<span class="phase">ğŸ“¡ æƒ…å ±åé›†ä¸­</span>
					{:else if proposalState.currentPhase === 'synthesizing'}
						<span class="phase">ğŸ”„ çµ±åˆä¸­</span>
					{:else if proposalState.currentPhase === 'completed'}
						<span class="phase">âœ… å®Œäº†</span>
					{/if}
				</div>
				<div class="agent-list">
					{#each proposalState.agentResults as result}
						<div class="agent-item {getStatusClass(result.status)}">
							<span class="status-icon">{getStatusIcon(result.status)}</span>
							<span class="agent-name">{result.displayName}</span>
						</div>
					{/each}
				</div>
			</div>
		{/if}

		<!-- å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å›ç­” -->
		{#if proposalState.agentResults.some(r => r.response)}
			<div class="agent-responses">
				<h4>å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®åˆ†æ</h4>
				{#each proposalState.agentResults.filter(r => r.response) as result}
					<details class="response-item">
						<summary>{result.displayName}</summary>
						<pre>{result.response}</pre>
					</details>
				{/each}
			</div>
		{/if}

		<!-- æœ€çµ‚ææ¡ˆ -->
		{#if proposalState.finalProposal}
			<div class="final-proposal">
				<h4>ğŸ“‹ çµ±åˆææ¡ˆ</h4>
				<pre>{proposalState.finalProposal}</pre>
			</div>
		{/if}

		<!-- ã‚¨ãƒ©ãƒ¼è¡¨ç¤º -->
		{#if proposalState.error}
			<div class="error">
				<span>âš ï¸ {proposalState.error}</span>
			</div>
		{/if}
	{/if}
</div>

<style>
	.proposal-panel {
		display: flex;
		flex-direction: column;
		gap: var(--space-md);
		height: 100%;
	}

	.api-notice {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		height: 100%;
		color: var(--color-text-dim);
		text-align: center;
		gap: var(--space-sm);
	}

	.api-notice .icon {
		font-size: 2rem;
	}

	.input-section {
		display: flex;
		gap: var(--space-sm);
	}

	.input-section textarea {
		flex: 1;
		padding: var(--space-sm);
		background: var(--color-bg-primary);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-sm);
		color: var(--color-text);
		font-size: 0.85rem;
		resize: none;
		min-height: 60px;
	}

	.input-section textarea:focus {
		outline: none;
		border-color: var(--color-cyan);
	}

	.run-btn {
		padding: var(--space-sm) var(--space-md);
		background: rgba(0, 255, 136, 0.1);
		border: 1px solid var(--color-green);
		border-radius: var(--radius-sm);
		color: var(--color-green);
		cursor: pointer;
		font-size: 0.8rem;
		transition: all var(--transition-fast);
		white-space: nowrap;
	}

	.run-btn:hover:not(:disabled) {
		background: rgba(0, 255, 136, 0.2);
		box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
	}

	.run-btn:disabled {
		opacity: 0.5;
		cursor: not-allowed;
	}

	.agent-progress {
		padding: var(--space-sm);
		background: rgba(0, 0, 0, 0.2);
		border-radius: var(--radius-sm);
	}

	.phase-indicator {
		margin-bottom: var(--space-sm);
	}

	.phase {
		font-size: 0.75rem;
		color: var(--color-cyan);
	}

	.agent-list {
		display: flex;
		gap: var(--space-sm);
		flex-wrap: wrap;
	}

	.agent-item {
		display: flex;
		align-items: center;
		gap: var(--space-xs);
		font-size: 0.7rem;
		padding: var(--space-xs) var(--space-sm);
		border-radius: var(--radius-sm);
		background: rgba(0, 0, 0, 0.2);
	}

	.status-icon {
		font-size: 0.8rem;
	}

	.status-pending { color: var(--color-text-dim); }
	.status-running { color: var(--color-cyan); }
	.status-running .status-icon { animation: spin 1s linear infinite; }
	.status-completed { color: var(--color-green); }
	.status-error { color: var(--color-red); }

	@keyframes spin {
		from { transform: rotate(0deg); }
		to { transform: rotate(360deg); }
	}

	.agent-responses {
		flex: 1;
		overflow-y: auto;
	}

	.agent-responses h4 {
		font-size: 0.75rem;
		color: var(--color-text-dim);
		margin: 0 0 var(--space-sm) 0;
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.response-item {
		margin-bottom: var(--space-sm);
	}

	.response-item summary {
		font-size: 0.8rem;
		cursor: pointer;
		padding: var(--space-xs) var(--space-sm);
		background: rgba(0, 0, 0, 0.2);
		border-radius: var(--radius-sm);
		color: var(--color-cyan);
	}

	.response-item pre {
		margin: var(--space-xs) 0 0 0;
		padding: var(--space-sm);
		font-size: 0.75rem;
		white-space: pre-wrap;
		word-break: break-word;
		background: rgba(0, 0, 0, 0.1);
		border-radius: var(--radius-sm);
	}

	.final-proposal {
		padding: var(--space-md);
		background: rgba(0, 255, 255, 0.05);
		border: 1px solid rgba(0, 255, 255, 0.2);
		border-radius: var(--radius-sm);
	}

	.final-proposal h4 {
		font-size: 0.85rem;
		color: var(--color-cyan);
		margin: 0 0 var(--space-sm) 0;
	}

	.final-proposal pre {
		margin: 0;
		font-size: 0.8rem;
		white-space: pre-wrap;
		word-break: break-word;
		line-height: 1.6;
	}

	.error {
		padding: var(--space-sm);
		background: rgba(255, 85, 85, 0.1);
		border-radius: var(--radius-sm);
		color: var(--color-red);
		font-size: 0.8rem;
	}
</style>
</file>

<file path="src/lib/components/ScenarioPlayer.svelte">
<!--
  ScenarioPlayer.svelte - ã‚·ãƒŠãƒªã‚ªå†ç”Ÿã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
-->
<script lang="ts">
	import { simulationStore } from '$lib/stores/simulation';
	import { basicAnalysisFlow } from '$lib/data/scenarios';
	import { onMount } from 'svelte';

	// ã‚·ãƒŠãƒªã‚ªã‚’ãƒ­ãƒ¼ãƒ‰
	onMount(() => {
		simulationStore.loadScenario(basicAnalysisFlow);
	});

	// å†ç”ŸçŠ¶æ…‹
	let state = $derived($simulationStore);
	
	// é€²è¡Œç‡
	let progress = $derived(
		state.scenario ? (state.currentTime / state.scenario.duration) * 100 : 0
	);

	// æ™‚é–“ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
	function formatTime(ms: number): string {
		const seconds = Math.floor(ms / 1000);
		const minutes = Math.floor(seconds / 60);
		const secs = seconds % 60;
		return `${minutes}:${secs.toString().padStart(2, '0')}`;
	}

	function handlePlay() {
		if (state.isPaused) {
			simulationStore.resume();
		} else {
			simulationStore.play();
		}
	}

	function handlePause() {
		simulationStore.pause();
	}

	function handleReset() {
		simulationStore.reset();
	}

	function handleSpeedChange(speed: number) {
		simulationStore.setSpeed(speed);
	}
</script>

<div class="scenario-player">
	<div class="player-header">
		<span class="scenario-name">{state.scenario?.name || 'ã‚·ãƒŠãƒªã‚ªæœªé¸æŠ'}</span>
		<span class="scenario-desc">{state.scenario?.description || ''}</span>
	</div>

	<div class="player-controls">
		<div class="control-buttons">
			{#if !state.isPlaying || state.isPaused}
				<button class="btn play" onclick={handlePlay} disabled={!state.scenario}>
					â–¶
				</button>
			{:else}
				<button class="btn pause" onclick={handlePause}>
					â¸
				</button>
			{/if}
			<button class="btn reset" onclick={handleReset} disabled={state.currentTime === 0}>
				â¹
			</button>
		</div>

		<div class="progress-section">
			<div class="progress-bar">
				<div class="progress-fill" style="width: {progress}%"></div>
				<div class="progress-marker" style="left: {progress}%"></div>
			</div>
			<div class="time-display">
				<span class="current-time">{formatTime(state.currentTime)}</span>
				<span class="separator">/</span>
				<span class="total-time">{formatTime(state.scenario?.duration || 0)}</span>
			</div>
		</div>

		<div class="speed-controls">
			<span class="speed-label">Speed:</span>
			{#each [0.5, 1, 2, 4] as speed}
				<button 
					class="speed-btn" 
					class:active={state.playbackSpeed === speed}
					onclick={() => handleSpeedChange(speed)}
				>
					{speed}x
				</button>
			{/each}
		</div>
	</div>

	<div class="player-status">
		{#if state.isPlaying && !state.isPaused}
			<span class="status-dot playing"></span>
			<span class="status-text">å†ç”Ÿä¸­</span>
		{:else if state.isPaused}
			<span class="status-dot paused"></span>
			<span class="status-text">ä¸€æ™‚åœæ­¢</span>
		{:else if state.currentTime > 0}
			<span class="status-dot stopped"></span>
			<span class="status-text">åœæ­¢</span>
		{:else}
			<span class="status-dot ready"></span>
			<span class="status-text">å¾…æ©Ÿä¸­</span>
		{/if}
	</div>
</div>

<style>
	.scenario-player {
		background: var(--color-bg-panel);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-md);
		padding: var(--space-md);
	}

	.player-header {
		margin-bottom: var(--space-md);
	}

	.scenario-name {
		font-size: 0.8rem;
		font-weight: 600;
		color: var(--color-cyan);
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.scenario-desc {
		display: block;
		font-size: 0.7rem;
		color: var(--color-text-dim);
		margin-top: var(--space-xs);
	}

	.player-controls {
		display: flex;
		align-items: center;
		gap: var(--space-md);
		flex-wrap: wrap;
	}

	.control-buttons {
		display: flex;
		gap: var(--space-sm);
	}

	.btn {
		width: 36px;
		height: 36px;
		border: 1px solid var(--color-border);
		background: transparent;
		color: var(--color-text);
		border-radius: var(--radius-sm);
		cursor: pointer;
		font-size: 1rem;
		transition: all var(--transition-fast);
	}

	.btn:hover:not(:disabled) {
		border-color: var(--color-cyan);
		color: var(--color-cyan);
		box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
	}

	.btn:disabled {
		opacity: 0.3;
		cursor: not-allowed;
	}

	.btn.play:hover:not(:disabled) {
		border-color: var(--color-green);
		color: var(--color-green);
		box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
	}

	.progress-section {
		flex: 1;
		min-width: 200px;
	}

	.progress-bar {
		height: 6px;
		background: var(--color-bg-secondary);
		border-radius: var(--radius-sm);
		position: relative;
		overflow: visible;
	}

	.progress-fill {
		height: 100%;
		background: linear-gradient(90deg, var(--color-cyan), var(--color-blue));
		border-radius: var(--radius-sm);
		transition: width 0.1s linear;
	}

	.progress-marker {
		position: absolute;
		top: 50%;
		width: 12px;
		height: 12px;
		background: var(--color-cyan);
		border-radius: 50%;
		transform: translate(-50%, -50%);
		box-shadow: 0 0 10px var(--color-cyan);
	}

	.time-display {
		display: flex;
		justify-content: space-between;
		margin-top: var(--space-xs);
		font-family: var(--font-mono);
		font-size: 0.7rem;
	}

	.current-time {
		color: var(--color-cyan);
	}

	.separator {
		color: var(--color-text-dim);
	}

	.total-time {
		color: var(--color-text-dim);
	}

	.speed-controls {
		display: flex;
		align-items: center;
		gap: var(--space-xs);
	}

	.speed-label {
		font-size: 0.7rem;
		color: var(--color-text-dim);
	}

	.speed-btn {
		padding: 4px 8px;
		border: 1px solid var(--color-border);
		background: transparent;
		color: var(--color-text-dim);
		border-radius: var(--radius-sm);
		cursor: pointer;
		font-size: 0.65rem;
		font-family: var(--font-mono);
		transition: all var(--transition-fast);
	}

	.speed-btn:hover {
		border-color: var(--color-cyan);
		color: var(--color-cyan);
	}

	.speed-btn.active {
		border-color: var(--color-cyan);
		background: rgba(0, 255, 255, 0.1);
		color: var(--color-cyan);
	}

	.player-status {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
		margin-top: var(--space-md);
		padding-top: var(--space-sm);
		border-top: 1px solid var(--color-border);
	}

	.status-dot {
		width: 8px;
		height: 8px;
		border-radius: 50%;
	}

	.status-dot.playing {
		background: var(--color-green);
		box-shadow: 0 0 10px var(--color-green);
		animation: pulse 1s infinite;
	}

	.status-dot.paused {
		background: var(--color-orange);
		box-shadow: 0 0 10px var(--color-orange);
	}

	.status-dot.stopped {
		background: var(--color-red);
	}

	.status-dot.ready {
		background: var(--color-text-dim);
	}

	.status-text {
		font-size: 0.7rem;
		color: var(--color-text-dim);
	}

	@keyframes pulse {
		0%, 100% { opacity: 1; }
		50% { opacity: 0.5; }
	}
</style>
</file>

<file path="src/lib/components/SpecPatcher.svelte">
<!--
  SpecPatcher.svelte - Specå·®åˆ†é©ç”¨ãƒ‘ãƒãƒ«
-->
<script lang="ts">
	import { predefinedPatches } from '$lib/data/patches';
	import { appliedPatchesStore, appliedPatchIds } from '$lib/stores/spec-diff';
	import type { PredefinedPatch } from '$lib/types/spec-diff';

	// é©ç”¨æ¸ˆã¿ãƒ‘ãƒƒãƒID
	let appliedIds = $derived($appliedPatchIds);

	// ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚¢ã‚¤ã‚³ãƒ³è‰²
	const categoryColors: Record<string, string> = {
		capability: 'var(--color-cyan)',
		constraint: 'var(--color-orange)',
		communication: 'var(--color-green)',
		observability: 'var(--color-blue)'
	};

	// å½±éŸ¿åº¦åˆ¥è‰²
	const impactColors: Record<string, string> = {
		low: 'var(--color-text-dim)',
		medium: 'var(--color-orange)',
		high: 'var(--color-red)'
	};

	function handleToggle(patch: PredefinedPatch) {
		if (appliedIds.includes(patch.id)) {
			appliedPatchesStore.revert(patch.id);
		} else {
			appliedPatchesStore.apply(patch);
		}
	}

	function getMaxImpact(patch: PredefinedPatch): string {
		const impacts = patch.diffs.map(d => d.impact);
		if (impacts.includes('high')) return 'high';
		if (impacts.includes('medium')) return 'medium';
		return 'low';
	}
</script>

<div class="spec-patcher">
	<div class="patches-list">
		{#each predefinedPatches as patch}
			{@const isApplied = appliedIds.includes(patch.id)}
			{@const maxImpact = getMaxImpact(patch)}
			<div 
				class="patch-item"
				class:applied={isApplied}
				style="--category-color: {categoryColors[patch.category]}; --impact-color: {impactColors[maxImpact]}"
			>
				<div class="patch-header">
					<span class="patch-icon">{patch.icon}</span>
					<div class="patch-info">
						<span class="patch-name">{patch.name}</span>
						<span class="patch-desc">{patch.description}</span>
					</div>
					<button 
						class="toggle-btn"
						class:applied={isApplied}
						onclick={() => handleToggle(patch)}
					>
						{isApplied ? 'å–æ¶ˆ' : 'é©ç”¨'}
					</button>
				</div>
				<div class="patch-meta">
					<span class="category-badge">{patch.category}</span>
					<span class="impact-badge">Impact: {maxImpact}</span>
					<span class="diff-count">{patch.diffs.length} changes</span>
				</div>
			</div>
		{/each}
	</div>
</div>

<style>
	.spec-patcher {
		display: flex;
		flex-direction: column;
		gap: var(--space-sm);
	}

	.patches-list {
		display: flex;
		flex-direction: column;
		gap: var(--space-sm);
	}

	.patch-item {
		background: rgba(0, 0, 0, 0.2);
		border: 1px solid var(--color-border);
		border-left: 3px solid var(--category-color);
		border-radius: var(--radius-sm);
		padding: var(--space-sm) var(--space-md);
		transition: all var(--transition-fast);
	}

	.patch-item:hover {
		border-color: var(--category-color);
		background: rgba(0, 255, 255, 0.05);
	}

	.patch-item.applied {
		background: rgba(0, 255, 136, 0.1);
		border-color: var(--color-green);
	}

	.patch-header {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
	}

	.patch-icon {
		font-size: 1.2rem;
	}

	.patch-info {
		flex: 1;
		display: flex;
		flex-direction: column;
	}

	.patch-name {
		font-size: 0.85rem;
		font-weight: 600;
	}

	.patch-desc {
		font-size: 0.7rem;
		color: var(--color-text-dim);
	}

	.toggle-btn {
		padding: 4px 12px;
		border: 1px solid var(--color-border);
		background: transparent;
		color: var(--color-text);
		border-radius: var(--radius-sm);
		cursor: pointer;
		font-size: 0.7rem;
		transition: all var(--transition-fast);
	}

	.toggle-btn:hover {
		border-color: var(--color-cyan);
		color: var(--color-cyan);
	}

	.toggle-btn.applied {
		border-color: var(--color-orange);
		color: var(--color-orange);
	}

	.toggle-btn.applied:hover {
		background: rgba(255, 170, 0, 0.1);
	}

	.patch-meta {
		display: flex;
		gap: var(--space-sm);
		margin-top: var(--space-xs);
		padding-top: var(--space-xs);
	}

	.category-badge,
	.impact-badge,
	.diff-count {
		font-size: 0.6rem;
		text-transform: uppercase;
		letter-spacing: 0.05em;
		padding: 2px 6px;
		border-radius: var(--radius-sm);
		background: rgba(0, 0, 0, 0.3);
	}

	.category-badge {
		color: var(--category-color);
		border: 1px solid var(--category-color);
	}

	.impact-badge {
		color: var(--impact-color);
	}

	.diff-count {
		color: var(--color-text-dim);
	}
</style>
</file>

<file path="src/lib/components/StatusIndicator.svelte">
<!--
  StatusIndicator.svelte - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
  
  Usage:
    <StatusIndicator status="active" label="AI Agent" />
-->
<script lang="ts">
	interface Props {
		status: 'active' | 'idle' | 'warning' | 'error' | 'offline';
		label?: string;
		pulse?: boolean;
		size?: 'sm' | 'md' | 'lg';
	}

	let { status, label, pulse = true, size = 'md' } = $props<Props>();

	const statusColors: Record<string, string> = {
		active: 'var(--color-green)',
		idle: 'var(--color-cyan)',
		warning: 'var(--color-orange)',
		error: 'var(--color-red)',
		offline: 'var(--color-text-dim)'
	};

	const statusLabels: Record<string, string> = {
		active: 'ACTIVE',
		idle: 'IDLE',
		warning: 'WARNING',
		error: 'ERROR',
		offline: 'OFFLINE'
	};
</script>

<div class="status-indicator" class:size-sm={size === 'sm'} class:size-lg={size === 'lg'}>
	<div 
		class="status-dot" 
		class:pulse={pulse && status !== 'offline'}
		style="--status-color: {statusColors[status]}"
	></div>
	{#if label}
		<span class="status-label">{label}</span>
		<span class="status-text" style="color: {statusColors[status]}">{statusLabels[status]}</span>
	{/if}
</div>

<style>
	.status-indicator {
		display: inline-flex;
		align-items: center;
		gap: var(--space-sm);
	}

	.status-dot {
		width: 10px;
		height: 10px;
		border-radius: 50%;
		background-color: var(--status-color);
		box-shadow: 0 0 8px var(--status-color);
	}

	.pulse {
		animation: status-pulse 2s ease-in-out infinite;
	}

	.status-label {
		font-size: 0.875rem;
		color: var(--color-text);
		font-weight: 500;
	}

	.status-text {
		font-size: 0.75rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	/* Size Variations */
	.size-sm .status-dot {
		width: 6px;
		height: 6px;
	}

	.size-sm .status-label {
		font-size: 0.75rem;
	}

	.size-sm .status-text {
		font-size: 0.625rem;
	}

	.size-lg .status-dot {
		width: 14px;
		height: 14px;
	}

	.size-lg .status-label {
		font-size: 1rem;
	}

	@keyframes status-pulse {
		0%, 100% {
			opacity: 1;
			transform: scale(1);
		}
		50% {
			opacity: 0.6;
			transform: scale(0.9);
		}
	}
</style>
</file>

<file path="src/lib/components/StudioStatus.svelte">
<!--
  StudioStatus.svelte - Spec-Flow Studioæ¥ç¶šçŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
-->
<script lang="ts">
    import { studioConnection } from "$lib/stores/studio-connection";

    let connectionState = $derived($studioConnection);

    function handleToggle() {
        if (
            connectionState.status === "connected" ||
            connectionState.status === "connecting"
        ) {
            studioConnection.disconnect();
        } else {
            studioConnection.connect();
        }
    }

    function getStatusColor(status: string): string {
        switch (status) {
            case "connected":
                return "var(--color-green)";
            case "connecting":
                return "var(--color-yellow)";
            case "error":
                return "var(--color-red)";
            default:
                return "var(--color-text-dim)";
        }
    }

    function getStatusIcon(status: string): string {
        switch (status) {
            case "connected":
                return "â—‰";
            case "connecting":
                return "â—";
            case "error":
                return "â—ˆ";
            default:
                return "â—‹";
        }
    }

    function getStatusText(status: string): string {
        switch (status) {
            case "connected":
                return "Studioæ¥ç¶šä¸­";
            case "connecting":
                return "æ¥ç¶šä¸­...";
            case "error":
                return "æ¥ç¶šã‚¨ãƒ©ãƒ¼";
            default:
                return "Studioæœªæ¥ç¶š";
        }
    }
</script>

<div class="studio-status">
    <button
        class="status-btn"
        onclick={handleToggle}
        style="--status-color: {getStatusColor(connectionState.status)}"
        title={connectionState.status === "connected"
            ? "ã‚¯ãƒªãƒƒã‚¯ã§åˆ‡æ–­"
            : "ã‚¯ãƒªãƒƒã‚¯ã§æ¥ç¶š"}
    >
        <span
            class="icon"
            class:pulse={connectionState.status === "connecting"}
        >
            {getStatusIcon(connectionState.status)}
        </span>
        <span class="label">{getStatusText(connectionState.status)}</span>
    </button>
</div>

<style>
    .studio-status {
        display: flex;
        align-items: center;
    }

    .status-btn {
        display: flex;
        align-items: center;
        gap: var(--space-xs);
        padding: var(--space-xs) var(--space-sm);
        background: transparent;
        border: 1px solid var(--status-color);
        border-radius: var(--radius-sm);
        color: var(--status-color);
        cursor: pointer;
        font-size: 0.75rem;
        transition: all var(--transition-fast);
    }

    .status-btn:hover {
        background: rgba(255, 255, 255, 0.05);
    }

    .icon {
        font-size: 0.8rem;
    }

    .icon.pulse {
        animation: pulse 1s infinite;
    }

    @keyframes pulse {
        0%,
        100% {
            opacity: 1;
        }
        50% {
            opacity: 0.4;
        }
    }

    .label {
        font-family: var(--font-mono);
    }
</style>
</file>

<file path="src/lib/data/patches.ts">
/**
 * Predefined Spec Patches
 * ãƒ‡ãƒ¢ç”¨ã®äº‹å‰å®šç¾©ãƒ‘ãƒƒãƒ
 */

import type { PredefinedPatch } from '../types/spec-diff';

export const predefinedPatches: PredefinedPatch[] = [
    {
        id: 'patch-001',
        name: 'Analyzeré«˜é€ŸåŒ–',
        description: 'Analyzerã«ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è§£æèƒ½åŠ›ã‚’è¿½åŠ ',
        icon: 'âš¡',
        category: 'capability',
        diffs: [
            {
                agentName: 'analyzer',
                operation: 'add',
                path: 'capabilities',
                after: 'streaming-analysis',
                description: 'ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è§£æèƒ½åŠ›ã‚’è¿½åŠ ',
                impact: 'medium'
            }
        ]
    },
    {
        id: 'patch-002',
        name: 'Monitorç²¾åº¦å‘ä¸Š',
        description: 'Monitorã®èª¤æ¤œçŸ¥é˜²æ­¢åˆ¶ç´„ã‚’å¼·åŒ–',
        icon: 'ğŸ¯',
        category: 'constraint',
        diffs: [
            {
                agentName: 'monitor',
                operation: 'modify',
                path: 'constraints[0]',
                before: 'èª¤æ¤œçŸ¥ã‚’æœ€å°åŒ–ã™ã‚‹',
                after: 'èª¤æ¤œçŸ¥ç‡5%ä»¥ä¸‹ã‚’ç¶­æŒã™ã‚‹',
                description: 'èª¤æ¤œçŸ¥é˜²æ­¢åˆ¶ç´„ã‚’å³æ ¼åŒ–',
                impact: 'high'
            }
        ]
    },
    {
        id: 'patch-003',
        name: 'Plannerã‚ªãƒ³ãƒ©ã‚¤ãƒ³åŒ–',
        description: 'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®Plannerã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–',
        icon: 'ğŸ”Œ',
        category: 'communication',
        diffs: [
            {
                agentName: 'planner',
                operation: 'modify',
                path: 'state.status',
                before: 'offline',
                after: 'active',
                description: 'Plannerã‚’ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã«å¤‰æ›´',
                impact: 'high'
            }
        ]
    },
    {
        id: 'patch-004',
        name: 'Predictor-Analyzerç›´æ¥é€šä¿¡',
        description: 'PredictorãŒAnalyzerã«ç›´æ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«',
        icon: 'ğŸ”—',
        category: 'communication',
        diffs: [
            {
                agentName: 'predictor',
                operation: 'add',
                path: 'communication.canSendTo',
                after: 'analyzer',
                description: 'Predictorã‹ã‚‰Analyzerã¸ã®é€šä¿¡ã‚’è¨±å¯',
                impact: 'medium'
            },
            {
                agentName: 'analyzer',
                operation: 'add',
                path: 'communication.canReceiveFrom',
                after: 'predictor',
                description: 'AnalyzerãŒPredictorã‹ã‚‰ã®é€šä¿¡ã‚’å—ä¿¡å¯èƒ½ã«',
                impact: 'medium'
            }
        ]
    },
    {
        id: 'patch-005',
        name: 'ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«è©³ç´°åŒ–',
        description: 'å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’debugã«å¤‰æ›´',
        icon: 'ğŸ“‹',
        category: 'observability',
        diffs: [
            {
                agentName: 'analyzer',
                operation: 'modify',
                path: 'observability.logLevel',
                before: 'info',
                after: 'debug',
                description: 'ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’debugã«å¤‰æ›´',
                impact: 'low'
            },
            {
                agentName: 'predictor',
                operation: 'modify',
                path: 'observability.logLevel',
                before: 'info',
                after: 'debug',
                description: 'ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’debugã«å¤‰æ›´',
                impact: 'low'
            }
        ]
    }
];

export function getPatchById(id: string): PredefinedPatch | undefined {
    return predefinedPatches.find(p => p.id === id);
}
</file>

<file path="src/lib/data/scenarios.ts">
/**
 * Demo Scenarios
 * ã‚·ãƒŠãƒªã‚ªå†ç”Ÿç”¨ã®ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿
 */

import type { Scenario } from '../types/scenario';

export const basicAnalysisFlow: Scenario = {
    name: 'basic-analysis-flow',
    description: 'åŸºæœ¬çš„ãªåˆ†æãƒ•ãƒ­ãƒ¼ï¼šAnalyzer â†’ Predictor â†’ Monitor ã®é€£æº',
    duration: 15000, // 15ç§’
    steps: [
        // 0s: åˆæœŸçŠ¶æ…‹
        {
            time: 0,
            action: 'console-log',
            level: 'info',
            source: 'System',
            message: 'ã‚·ãƒŠãƒªã‚ªé–‹å§‹: basic-analysis-flow'
        },

        // 1s: AnalyzerãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
        {
            time: 1000,
            action: 'set-state',
            agent: 'analyzer',
            state: { status: 'active', currentTask: 'ãƒ‡ãƒ¼ã‚¿å—ä¿¡å¾…æ©Ÿä¸­' }
        },
        {
            time: 1000,
            action: 'console-log',
            level: 'success',
            source: 'Analyzer',
            message: 'Agent online - ãƒ‡ãƒ¼ã‚¿å—ä¿¡å¾…æ©Ÿä¸­'
        },

        // 2s: ãƒ‡ãƒ¼ã‚¿å—ä¿¡ãƒ»åˆ†æé–‹å§‹
        {
            time: 2000,
            action: 'set-state',
            agent: 'analyzer',
            state: { currentTask: 'input-001ã‚’åˆ†æä¸­', progress: 0.1 }
        },
        {
            time: 2000,
            action: 'console-log',
            level: 'info',
            source: 'Analyzer',
            message: 'ãƒ‡ãƒ¼ã‚¿å—ä¿¡: input-001 (1.2MB)'
        },

        // 3s: åˆ†æé€²è¡Œ
        {
            time: 3000,
            action: 'set-state',
            agent: 'analyzer',
            state: { progress: 0.4 }
        },
        {
            time: 3000,
            action: 'console-log',
            level: 'debug',
            source: 'Analyzer',
            message: 'ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ãƒ¢ãƒ‡ãƒ«é©ç”¨ä¸­...'
        },

        // 4s: ç•°å¸¸æ¤œå‡º
        {
            time: 4000,
            action: 'set-state',
            agent: 'analyzer',
            state: { progress: 0.7 }
        },
        {
            time: 4000,
            action: 'console-log',
            level: 'warning',
            source: 'Analyzer',
            message: 'ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º: CPUä½¿ç”¨ç‡ãŒé€šå¸¸ã‚ˆã‚Š20%é«˜ã„'
        },

        // 5s: åˆ†æå®Œäº†ã€Predictorã¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
        {
            time: 5000,
            action: 'set-state',
            agent: 'analyzer',
            state: { progress: 1.0, currentTask: 'åˆ†æå®Œäº†' }
        },
        {
            time: 5000,
            action: 'send-message',
            from: 'analyzer',
            to: 'predictor',
            message: {
                type: 'analysis-complete',
                priority: 'normal',
                content: {
                    summary: 'ãƒ‡ãƒ¼ã‚¿åˆ†æå®Œäº†',
                    findings: ['ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ç•°å¸¸ãªã—', 'CPUä½¿ç”¨ç‡ãŒé€šå¸¸ã‚ˆã‚Š20%é«˜ã„'],
                    confidence: 0.85,
                    anomalies: ['high-cpu-usage']
                }
            }
        },
        {
            time: 5000,
            action: 'console-log',
            level: 'success',
            source: 'Analyzer',
            message: 'åˆ†æå®Œäº† â†’ Predictorã¸çµæœé€ä¿¡'
        },

        // 6s: PredictorãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
        {
            time: 6000,
            action: 'set-state',
            agent: 'analyzer',
            state: { status: 'idle', currentTask: undefined, progress: undefined }
        },
        {
            time: 6000,
            action: 'set-state',
            agent: 'predictor',
            state: { status: 'active', currentTask: 'äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«å®Ÿè¡Œä¸­', progress: 0.0 }
        },
        {
            time: 6000,
            action: 'console-log',
            level: 'info',
            source: 'Predictor',
            message: 'Analyzerã‹ã‚‰ã®åˆ†æçµæœã‚’å—ä¿¡'
        },

        // 7s: äºˆæ¸¬å®Ÿè¡Œä¸­
        {
            time: 7000,
            action: 'set-state',
            agent: 'predictor',
            state: { progress: 0.3 }
        },
        {
            time: 7000,
            action: 'console-log',
            level: 'debug',
            source: 'Predictor',
            message: 'æ™‚ç³»åˆ—äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’é©ç”¨ä¸­...'
        },

        // 8s: äºˆæ¸¬é€²è¡Œ
        {
            time: 8000,
            action: 'set-state',
            agent: 'predictor',
            state: { progress: 0.6 }
        },

        // 9s: MonitorãŒã‚¦ã‚©ãƒ¼ãƒ‹ãƒ³ã‚°çŠ¶æ…‹ã«
        {
            time: 9000,
            action: 'set-state',
            agent: 'monitor',
            state: { status: 'warning', currentTask: 'é–¾å€¤ãƒã‚§ãƒƒã‚¯ä¸­' }
        },
        {
            time: 9000,
            action: 'console-log',
            level: 'warning',
            source: 'Monitor',
            message: 'CPUä½¿ç”¨ç‡ã®ç•°å¸¸ã‚’æ¤œå‡º - é–¾å€¤è¶…éã®å¯èƒ½æ€§'
        },

        // 10s: äºˆæ¸¬å®Œäº†ã€Monitorã¸é€ä¿¡
        {
            time: 10000,
            action: 'set-state',
            agent: 'predictor',
            state: { progress: 1.0, currentTask: 'äºˆæ¸¬å®Œäº†' }
        },
        {
            time: 10000,
            action: 'send-message',
            from: 'predictor',
            to: 'monitor',
            message: {
                type: 'prediction-complete',
                priority: 'high',
                content: {
                    summary: 'CPUä½¿ç”¨ç‡ã¯ä»Šå¾Œ30åˆ†ã§æ›´ã«ä¸Šæ˜‡ã™ã‚‹è¦‹è¾¼ã¿',
                    prediction: { cpuIn30min: 0.85, confidence: 0.78 },
                    recommendation: 'ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã‚’æ¤œè¨ã—ã¦ãã ã•ã„'
                }
            }
        },
        {
            time: 10000,
            action: 'console-log',
            level: 'success',
            source: 'Predictor',
            message: 'äºˆæ¸¬å®Œäº† â†’ Monitorã¸ã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡'
        },

        // 11s: MonitorãŒã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡
        {
            time: 11000,
            action: 'set-state',
            agent: 'predictor',
            state: { status: 'idle', currentTask: undefined, progress: undefined }
        },
        {
            time: 11000,
            action: 'set-state',
            agent: 'monitor',
            state: { status: 'active', currentTask: 'ã‚¢ãƒ©ãƒ¼ãƒˆç™ºå ±ä¸­' }
        },
        {
            time: 11000,
            action: 'console-log',
            level: 'error',
            source: 'Monitor',
            message: 'ã€ALERTã€‘CPUä½¿ç”¨ç‡ä¸Šæ˜‡äºˆæ¸¬ - 30åˆ†ä»¥å†…ã«85%åˆ°é”è¦‹è¾¼ã¿'
        },

        // 12s: Plannerã¸é€ä¿¡
        {
            time: 12000,
            action: 'send-message',
            from: 'monitor',
            to: 'planner',
            message: {
                type: 'alert-escalation',
                priority: 'critical',
                content: {
                    summary: 'ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆæ¨å¥¨',
                    alertType: 'capacity-warning',
                    urgency: 'high'
                }
            }
        },
        {
            time: 12000,
            action: 'console-log',
            level: 'info',
            source: 'Monitor',
            message: 'Plannerã¸ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é€ä¿¡'
        },

        // 13s: Plannerå¿œç­”ãªã—ï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼‰
        {
            time: 13000,
            action: 'console-log',
            level: 'error',
            source: 'System',
            message: 'Plannerã‹ã‚‰ã®å¿œç­”ãŒã‚ã‚Šã¾ã›ã‚“ - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³'
        },

        // 14s: MonitorãŒå¾…æ©ŸçŠ¶æ…‹ã«
        {
            time: 14000,
            action: 'set-state',
            agent: 'monitor',
            state: { status: 'idle', currentTask: undefined }
        },
        {
            time: 14000,
            action: 'console-log',
            level: 'info',
            source: 'System',
            message: 'ã‚·ãƒŠãƒªã‚ªå®Œäº†: basic-analysis-flow'
        }
    ]
};

export const scenarios: Scenario[] = [basicAnalysisFlow];

export function getScenarioByName(name: string): Scenario | undefined {
    return scenarios.find(s => s.name === name);
}
</file>

<file path="src/lib/stores/crypto-store.ts">
/**
 * Crypto Store
 * APIã‚­ãƒ¼ã®æš—å·åŒ–ä¿å­˜ï¼ˆBYOKæ–¹å¼ï¼‰
 * 
 * Security Weather Stationã¨åŒæ§˜ã®å®Ÿè£…ï¼š
 * - PBKDF2 (600,000å›) ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰éµå°å‡º
 * - AES-GCM ã§æš—å·åŒ–
 * - Session Storageã«å¾©å·æ¸ˆã¿ã‚­ãƒ¼ã‚’ä¿æŒï¼ˆã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹ã¨æ¶ˆå»ï¼‰
 */

const PBKDF2_ITERATIONS = 600000;
const SALT_LENGTH = 16;
const IV_LENGTH = 12;

// æš—å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®å½¢å¼
interface EncryptedData {
    salt: string;  // Base64
    iv: string;    // Base64
    data: string;  // Base64
}

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰æš—å·åŒ–ã‚­ãƒ¼ã‚’å°å‡º
async function deriveKey(password: string, salt: Uint8Array): Promise<CryptoKey> {
    const encoder = new TextEncoder();
    const keyMaterial = await crypto.subtle.importKey(
        'raw',
        encoder.encode(password),
        'PBKDF2',
        false,
        ['deriveKey']
    );

    return crypto.subtle.deriveKey(
        {
            name: 'PBKDF2',
            salt,
            iterations: PBKDF2_ITERATIONS,
            hash: 'SHA-256'
        },
        keyMaterial,
        { name: 'AES-GCM', length: 256 },
        false,
        ['encrypt', 'decrypt']
    );
}

// æš—å·åŒ–
export async function encrypt(plaintext: string, password: string): Promise<EncryptedData> {
    const encoder = new TextEncoder();
    const salt = crypto.getRandomValues(new Uint8Array(SALT_LENGTH));
    const iv = crypto.getRandomValues(new Uint8Array(IV_LENGTH));
    const key = await deriveKey(password, salt);

    const encrypted = await crypto.subtle.encrypt(
        { name: 'AES-GCM', iv },
        key,
        encoder.encode(plaintext)
    );

    return {
        salt: btoa(String.fromCharCode(...salt)),
        iv: btoa(String.fromCharCode(...iv)),
        data: btoa(String.fromCharCode(...new Uint8Array(encrypted)))
    };
}

// å¾©å·
export async function decrypt(encryptedData: EncryptedData, password: string): Promise<string> {
    const salt = Uint8Array.from(atob(encryptedData.salt), c => c.charCodeAt(0));
    const iv = Uint8Array.from(atob(encryptedData.iv), c => c.charCodeAt(0));
    const data = Uint8Array.from(atob(encryptedData.data), c => c.charCodeAt(0));

    const key = await deriveKey(password, salt);

    const decrypted = await crypto.subtle.decrypt(
        { name: 'AES-GCM', iv },
        key,
        data
    );

    return new TextDecoder().decode(decrypted);
}

// LocalStorage ã‚­ãƒ¼
const STORAGE_KEY = 'aether-console-api-key';
const SESSION_KEY = 'aether-console-decrypted-key';

// æš—å·åŒ–ã•ã‚ŒãŸAPIã‚­ãƒ¼ã‚’ä¿å­˜
export function saveEncryptedApiKey(encryptedData: EncryptedData): void {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(encryptedData));
}

// æš—å·åŒ–ã•ã‚ŒãŸAPIã‚­ãƒ¼ã‚’å–å¾—
export function getEncryptedApiKey(): EncryptedData | null {
    const stored = localStorage.getItem(STORAGE_KEY);
    return stored ? JSON.parse(stored) : null;
}

// å¾©å·æ¸ˆã¿APIã‚­ãƒ¼ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä¿å­˜ï¼ˆã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹ã¨æ¶ˆå»ï¼‰
export function setSessionApiKey(apiKey: string): void {
    sessionStorage.setItem(SESSION_KEY, apiKey);
}

// ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰APIã‚­ãƒ¼ã‚’å–å¾—
export function getSessionApiKey(): string | null {
    return sessionStorage.getItem(SESSION_KEY);
}

// APIã‚­ãƒ¼ã‚’ã‚¯ãƒªã‚¢
export function clearApiKey(): void {
    localStorage.removeItem(STORAGE_KEY);
    sessionStorage.removeItem(SESSION_KEY);
}

// æš—å·åŒ–ã•ã‚ŒãŸã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹
export function hasEncryptedApiKey(): boolean {
    return localStorage.getItem(STORAGE_KEY) !== null;
}

// ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã‚­ãƒ¼ãŒã‚ã‚‹ã‹
export function hasSessionApiKey(): boolean {
    return sessionStorage.getItem(SESSION_KEY) !== null;
}
</file>

<file path="src/lib/stores/proposal-store.ts">
/**
 * Proposal Store
 * è¤‡æ•°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‡ºåŠ›ã‚’çµ±åˆã—ã€æœ€çµ‚ææ¡ˆã‚’ç”Ÿæˆ
 */

import { writable, get } from 'svelte/store';
import { callGemini, callGeminiStream, isApiKeyAvailable, type AgentMessage, type AgentConfig } from './gemini-client';
import { agentStore, logStore } from './simulation';
import { agents as agentDefinitions, getAgentByName } from '../data/agents';
import type { Agent } from '../types/agent';

// çµ±åˆå¯¾è±¡ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆSynthesizerã¯é™¤ãï¼‰
const TARGET_AGENTS = ['analyzer', 'predictor', 'monitor', 'planner'];

interface AgentResult {
    agentName: string;
    displayName: string;
    response: string;
    status: 'pending' | 'running' | 'completed' | 'error';
    error?: string;
}

interface ProposalState {
    isRunning: boolean;
    currentPhase: 'idle' | 'gathering' | 'synthesizing' | 'completed';
    agentResults: AgentResult[];
    finalProposal: string;
    error: string | null;
}

function createProposalStore() {
    const { subscribe, set, update } = writable<ProposalState>({
        isRunning: false,
        currentPhase: 'idle',
        agentResults: [],
        finalProposal: '',
        error: null
    });

    // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆ
    function buildSystemPrompt(agent: Agent): string {
        return `# ã‚ãªãŸã¯ã€Œ${agent.displayName}ã€ã¨ã„ã†AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™

## å½¹å‰²
${agent.role}

## èƒ½åŠ›
${agent.capabilities.map(c => `- ${c}`).join('\n')}

## åˆ¶ç´„
${agent.constraints.map(c => `- ${c}`).join('\n')}

## å¿œç­”å½¢å¼
- ç°¡æ½”ã«è¦ç‚¹ã‚’ã¾ã¨ã‚ã¦ãã ã•ã„
- ç®‡æ¡æ›¸ãã‚’æ´»ç”¨ã—ã¦ãã ã•ã„
- 200æ–‡å­—ä»¥å†…ã§å›ç­”ã—ã¦ãã ã•ã„
`;
    }

    // Synthesizerã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
    function buildSynthesizerPrompt(input: string, results: AgentResult[]): string {
        const agentResponses = results
            .filter(r => r.status === 'completed')
            .map(r => `### ${r.displayName}\n${r.response}`)
            .join('\n\n');

        return `ä»¥ä¸‹ã¯å„å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ã®åˆ†æçµæœã§ã™ã€‚ã“ã‚Œã‚‰ã‚’çµ±åˆã—ã€åŒ…æ‹¬çš„ãªæœ€çµ‚ææ¡ˆã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›
${input}

## å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å›ç­”

${agentResponses}

## ã‚¿ã‚¹ã‚¯
ä¸Šè¨˜ã®å…¨ã¦ã®å›ç­”ã‚’çµ±åˆã—ã€ä»¥ä¸‹ã®å½¢å¼ã§æœ€çµ‚ææ¡ˆã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š

1. **ç·åˆè©•ä¾¡**: çŠ¶æ³ã®è¦ç´„
2. **é‡è¦ãƒã‚¤ãƒ³ãƒˆ**: å„ªå…ˆé †ä½é †ã«3ã¤
3. **æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: å…·ä½“çš„ãªæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
4. **ãƒªã‚¹ã‚¯ãƒ»æ³¨æ„ç‚¹**: è€ƒæ…®ã™ã¹ãäº‹é …
`;
    }

    return {
        subscribe,

        // çµ±åˆåˆ†æã‚’å®Ÿè¡Œ
        runIntegratedAnalysis: async (input: string, model?: string) => {
            if (!isApiKeyAvailable()) {
                update(s => ({ ...s, error: 'APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“' }));
                return;
            }

            // åˆæœŸåŒ–
            const initialResults: AgentResult[] = TARGET_AGENTS.map(name => {
                const agent = getAgentByName(name);
                return {
                    agentName: name,
                    displayName: agent?.displayName || name,
                    response: '',
                    status: 'pending' as const
                };
            });

            update(s => ({
                ...s,
                isRunning: true,
                currentPhase: 'gathering',
                agentResults: initialResults,
                finalProposal: '',
                error: null
            }));

            logStore.add({
                level: 'info',
                source: 'System',
                message: 'çµ±åˆåˆ†æã‚’é–‹å§‹...'
            });

            // Phase 1: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰å›ç­”ã‚’åé›†ï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰
            const promises = TARGET_AGENTS.map(async (agentName, index) => {
                const agent = getAgentByName(agentName);
                if (!agent) return;

                // çŠ¶æ…‹ã‚’ã€Œå®Ÿè¡Œä¸­ã€ã«æ›´æ–°
                update(s => {
                    const results = [...s.agentResults];
                    results[index] = { ...results[index], status: 'running' };
                    return { ...s, agentResults: results };
                });

                agentStore.updateState(agentName, { status: 'active', currentTask: 'åˆ†æä¸­...' });

                try {
                    const config: AgentConfig = {
                        systemPrompt: buildSystemPrompt(agent),
                        temperature: 0.7,
                        maxTokens: 512
                    };

                    const messages: AgentMessage[] = [
                        { role: 'user', content: input }
                    ];

                    const response = await callGemini(messages, config, model);

                    // çŠ¶æ…‹ã‚’ã€Œå®Œäº†ã€ã«æ›´æ–°
                    update(s => {
                        const results = [...s.agentResults];
                        results[index] = { ...results[index], response, status: 'completed' };
                        return { ...s, agentResults: results };
                    });

                    agentStore.updateState(agentName, { status: 'idle', currentTask: undefined });

                } catch (error) {
                    const errorMsg = error instanceof Error ? error.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼';
                    update(s => {
                        const results = [...s.agentResults];
                        results[index] = { ...results[index], status: 'error', error: errorMsg };
                        return { ...s, agentResults: results };
                    });

                    agentStore.updateState(agentName, { status: 'error', currentTask: 'ã‚¨ãƒ©ãƒ¼' });
                }
            });

            await Promise.all(promises);

            // Phase 2: Synthesizerã§çµ±åˆ
            update(s => ({ ...s, currentPhase: 'synthesizing' }));

            const synthesizer = getAgentByName('synthesizer');
            if (synthesizer) {
                agentStore.updateState('synthesizer', { status: 'active', currentTask: 'çµ±åˆä¸­...' });

                try {
                    const currentState = get({ subscribe });
                    const synthesizerPrompt = buildSynthesizerPrompt(input, currentState.agentResults);

                    const config: AgentConfig = {
                        systemPrompt: buildSystemPrompt(synthesizer),
                        temperature: 0.7,
                        maxTokens: 1024
                    };

                    const messages: AgentMessage[] = [
                        { role: 'user', content: synthesizerPrompt }
                    ];

                    let finalProposal = '';

                    // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã§çµ±åˆçµæœã‚’è¡¨ç¤º
                    for await (const chunk of callGeminiStream(messages, config, model)) {
                        finalProposal += chunk;
                        update(s => ({ ...s, finalProposal }));
                    }

                    agentStore.updateState('synthesizer', { status: 'idle', currentTask: undefined });

                    logStore.add({
                        level: 'success',
                        source: 'Synthesizer',
                        message: 'çµ±åˆåˆ†æå®Œäº†'
                    });

                } catch (error) {
                    const errorMsg = error instanceof Error ? error.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼';
                    update(s => ({ ...s, error: errorMsg }));
                    agentStore.updateState('synthesizer', { status: 'error', currentTask: 'ã‚¨ãƒ©ãƒ¼' });
                }
            }

            update(s => ({ ...s, isRunning: false, currentPhase: 'completed' }));
        },

        // ãƒªã‚»ãƒƒãƒˆ
        reset: () => {
            set({
                isRunning: false,
                currentPhase: 'idle',
                agentResults: [],
                finalProposal: '',
                error: null
            });
        }
    };
}

export const proposalStore = createProposalStore();
</file>

<file path="src/lib/stores/simulation.ts">
/**
 * Simulation Store
 * ã‚·ãƒŠãƒªã‚ªå†ç”Ÿã®çŠ¶æ…‹ç®¡ç†
 */

import { writable, derived, get } from 'svelte/store';
import type { Agent, AgentState, Message, LogEntry } from '../types/agent';
import type { Scenario, ScenarioStep, SimulationState } from '../types/scenario';
import { agents as initialAgents } from '../data/agents';

// ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹
function createAgentStore() {
    const { subscribe, set, update } = writable<Agent[]>(structuredClone(initialAgents));

    return {
        subscribe,
        reset: () => set(structuredClone(initialAgents)),
        updateState: (agentName: string, newState: Partial<AgentState>) => {
            update(agents => {
                return agents.map(agent => {
                    if (agent.name === agentName) {
                        return {
                            ...agent,
                            state: {
                                ...agent.state,
                                ...newState,
                                lastActivity: new Date()
                            }
                        };
                    }
                    return agent;
                });
            });
        },
        getByName: (name: string): Agent | undefined => {
            return get({ subscribe }).find(a => a.name === name);
        }
    };
}

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´
function createMessageStore() {
    const { subscribe, set, update } = writable<Message[]>([]);
    let messageId = 0;

    return {
        subscribe,
        reset: () => {
            set([]);
            messageId = 0;
        },
        add: (message: Omit<Message, 'id' | 'timestamp'>) => {
            update(messages => [
                ...messages,
                {
                    ...message,
                    id: `msg-${++messageId}`,
                    timestamp: new Date()
                } as Message
            ]);
        }
    };
}

// ãƒ­ã‚°
function createLogStore() {
    const { subscribe, set, update } = writable<LogEntry[]>([]);

    return {
        subscribe,
        reset: () => set([]),
        add: (entry: Omit<LogEntry, 'timestamp'>) => {
            const now = new Date();
            const timestamp = now.toLocaleTimeString('ja-JP', { hour12: false });
            update(logs => [...logs, { ...entry, timestamp }]);
        }
    };
}

// ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹
function createSimulationStore() {
    const { subscribe, set, update } = writable<SimulationState>({
        isPlaying: false,
        isPaused: false,
        currentTime: 0,
        playbackSpeed: 1,
        scenario: null
    });

    let intervalId: ReturnType<typeof setInterval> | null = null;
    let executedSteps: Set<number> = new Set();

    const executeStep = (step: ScenarioStep) => {
        switch (step.action) {
            case 'set-state':
                agentStore.updateState(step.agent, step.state);
                break;
            case 'send-message':
                messageStore.add({
                    from: step.from,
                    to: step.to,
                    type: step.message.type,
                    priority: step.message.priority || 'normal',
                    content: step.message.content
                });
                break;
            case 'console-log':
                logStore.add({
                    level: step.level || 'info',
                    source: step.source,
                    message: step.message
                });
                break;
        }
    };

    const tick = () => {
        update(state => {
            if (!state.scenario || !state.isPlaying || state.isPaused) {
                return state;
            }

            const newTime = state.currentTime + 100 * state.playbackSpeed;

            // å®Ÿè¡Œã™ã¹ãã‚¹ãƒ†ãƒƒãƒ—ã‚’æ¢ã™
            state.scenario.steps.forEach((step, index) => {
                if (step.time <= newTime && !executedSteps.has(index)) {
                    executeStep(step);
                    executedSteps.add(index);
                }
            });

            // ã‚·ãƒŠãƒªã‚ªçµ‚äº†åˆ¤å®š
            if (newTime >= state.scenario.duration) {
                if (intervalId) {
                    clearInterval(intervalId);
                    intervalId = null;
                }
                return {
                    ...state,
                    currentTime: state.scenario.duration,
                    isPlaying: false,
                    isPaused: false
                };
            }

            return { ...state, currentTime: newTime };
        });
    };

    return {
        subscribe,
        loadScenario: (scenario: Scenario) => {
            update(state => ({
                ...state,
                scenario,
                currentTime: 0,
                isPlaying: false,
                isPaused: false
            }));
            executedSteps.clear();
            agentStore.reset();
            messageStore.reset();
            logStore.reset();
        },
        play: () => {
            update(state => {
                if (!state.scenario) return state;
                if (intervalId) clearInterval(intervalId);
                intervalId = setInterval(tick, 100);
                return { ...state, isPlaying: true, isPaused: false };
            });
        },
        pause: () => {
            update(state => {
                if (intervalId) {
                    clearInterval(intervalId);
                    intervalId = null;
                }
                return { ...state, isPaused: true };
            });
        },
        resume: () => {
            update(state => {
                if (!state.scenario || !state.isPaused) return state;
                if (intervalId) clearInterval(intervalId);
                intervalId = setInterval(tick, 100);
                return { ...state, isPaused: false };
            });
        },
        reset: () => {
            if (intervalId) {
                clearInterval(intervalId);
                intervalId = null;
            }
            executedSteps.clear();
            agentStore.reset();
            messageStore.reset();
            logStore.reset();
            update(state => ({
                ...state,
                currentTime: 0,
                isPlaying: false,
                isPaused: false
            }));
        },
        setSpeed: (speed: number) => {
            update(state => ({ ...state, playbackSpeed: speed }));
        }
    };
}

// Store exports
export const agentStore = createAgentStore();
export const messageStore = createMessageStore();
export const logStore = createLogStore();
export const simulationStore = createSimulationStore();

// Derived stores
export const activeAgents = derived(agentStore, $agents =>
    $agents.filter(a => a.state.status === 'active')
);

export const recentMessages = derived(messageStore, $messages =>
    $messages.slice(-10)
);
</file>

<file path="src/lib/types/agent.ts">
/**
 * Spec-Kit Agent Types
 * ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å½¹å‰²ãƒ»èƒ½åŠ›ãƒ»åˆ¶ç´„ã‚’å®šç¾©ã™ã‚‹å‹
 */

export type AgentStatus = 'active' | 'idle' | 'warning' | 'error' | 'offline';

export interface AgentSpec {
    name: string;
    displayName: string;
    description: string;
    icon: string;
    role: string;
    capabilities: string[];
    constraints: string[];
    communication: {
        canSendTo: string[];
        canReceiveFrom: string[];
    };
}

export interface AgentState {
    agentName: string;
    status: AgentStatus;
    currentTask?: string;
    progress?: number;
    lastActivity: Date;
    metrics: {
        tasksCompleted: number;
        averageResponseTime: string;
        errorRate: number;
    };
}

export interface Agent extends AgentSpec {
    state: AgentState;
}

/**
 * Message Types
 * ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“é€šä¿¡ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‹
 */
export type MessagePriority = 'low' | 'normal' | 'high' | 'critical';

export interface Message {
    id: string;
    from: string;
    to: string;
    timestamp: Date;
    type: string;
    priority: MessagePriority;
    content: {
        summary: string;
        [key: string]: unknown;
    };
}

/**
 * Log Types
 * ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã®å‹
 */
export type LogLevel = 'info' | 'success' | 'warning' | 'error' | 'debug';

export interface LogEntry {
    timestamp: string;
    level: LogLevel;
    source?: string;
    message: string;
}
</file>

<file path="src/lib/types/integration.ts">
/**
 * Spec-Flow Studio Integration Types
 * 
 * Aether Consoleã¨Spec-Flow Studioã®é€£æºç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
 * Spec-Flow Studioå´ã§ã‚‚åŒã˜å‹å®šç¾©ã‚’ä½¿ç”¨ã™ã‚‹
 */

// ========================================
// Spec-Kitå½¢å¼ï¼ˆå…±é€šãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼‰
// ========================================

/**
 * ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä»•æ§˜
 */
export interface AgentSpec {
    name: string;
    displayName: string;
    role: string;
    capabilities: string[];
    constraints: string[];
    communication: {
        canSendTo: string[];
        canReceiveFrom: string[];
    };
}

/**
 * Specå·®åˆ†ï¼ˆä»•æ§˜å¤‰æ›´ï¼‰
 */
export interface SpecDiff {
    id: string;
    agentName: string;
    operation: 'add' | 'remove' | 'modify';
    path: string;
    before?: unknown;
    after?: unknown;
    description: string;
    impact: 'low' | 'medium' | 'high';
}

/**
 * ãƒ‘ãƒƒãƒï¼ˆå·®åˆ†ã®é›†åˆï¼‰
 */
export interface SpecPatch {
    id: string;
    name: string;
    description: string;
    diffs: SpecDiff[];
    appliedAt?: Date;
}

// ========================================
// é€£æºã‚¤ãƒ™ãƒ³ãƒˆ
// ========================================

/**
 * Aether Console â†’ Spec-Flow Studio
 * ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã‚¹ã‚¿ã‚¸ã‚ªã¸é€ä¿¡ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ
 */
export type ConsoleToStudioEvent =
    | { type: 'PATCH_APPLIED'; patch: SpecPatch }
    | { type: 'PATCH_REVERTED'; patchId: string }
    | { type: 'AGENT_EXECUTED'; agentName: string; input: string; output: string }
    | { type: 'PROPOSAL_GENERATED'; proposal: string; agentResults: AgentResultSummary[] }
    | { type: 'SYNC_REQUEST'; };

/**
 * Spec-Flow Studio â†’ Aether Console
 * ã‚¹ã‚¿ã‚¸ã‚ªã‹ã‚‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¸é€ä¿¡ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ
 */
export type StudioToConsoleEvent =
    | { type: 'SPEC_UPDATED'; agents: AgentSpec[] }
    | { type: 'PATCH_CREATED'; patch: SpecPatch }
    | { type: 'SCENARIO_CREATED'; scenario: ScenarioSummary }
    | { type: 'SYNC_RESPONSE'; agents: AgentSpec[]; patches: SpecPatch[] };

/**
 * ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œçµæœã®æ¦‚è¦
 */
export interface AgentResultSummary {
    agentName: string;
    displayName: string;
    status: 'completed' | 'error';
    responseSummary: string;
}

/**
 * ã‚·ãƒŠãƒªã‚ªã®æ¦‚è¦
 */
export interface ScenarioSummary {
    id: string;
    name: string;
    description: string;
    messageCount: number;
}

// ========================================
// é€£æºè¨­å®š
// ========================================

/**
 * é€£æºæ¥ç¶šè¨­å®š
 */
export interface IntegrationConfig {
    /** Spec-Flow Studioã®WebSocket URL */
    studioUrl: string;
    /** è‡ªå‹•åŒæœŸã‚’æœ‰åŠ¹ã«ã™ã‚‹ã‹ */
    autoSync: boolean;
    /** åŒæœŸé–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰ */
    syncInterval: number;
}

/**
 * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é€£æºè¨­å®š
 */
export const DEFAULT_INTEGRATION_CONFIG: IntegrationConfig = {
    studioUrl: 'ws://localhost:3001/api/ws',
    autoSync: false,
    syncInterval: 5000
};
</file>

<file path="src/lib/types/scenario.ts">
/**
 * Scenario Types
 * ã‚·ãƒŠãƒªã‚ªå†ç”Ÿç”¨ã®å‹å®šç¾©
 */

import type { AgentStatus, LogLevel, MessagePriority } from './agent';

export type ScenarioActionType = 'set-state' | 'send-message' | 'console-log';

export interface SetStateAction {
    time: number;
    action: 'set-state';
    agent: string;
    state: {
        status?: AgentStatus;
        currentTask?: string;
        progress?: number;
    };
}

export interface SendMessageAction {
    time: number;
    action: 'send-message';
    from: string;
    to: string;
    message: {
        type: string;
        priority?: MessagePriority;
        content: {
            summary: string;
            [key: string]: unknown;
        };
    };
}

export interface ConsoleLogAction {
    time: number;
    action: 'console-log';
    level?: LogLevel;
    source?: string;
    message: string;
}

export type ScenarioStep = SetStateAction | SendMessageAction | ConsoleLogAction;

export interface Scenario {
    name: string;
    description: string;
    duration: number; // ç·æ™‚é–“ï¼ˆmsï¼‰
    steps: ScenarioStep[];
}

export interface SimulationState {
    isPlaying: boolean;
    isPaused: boolean;
    currentTime: number;
    playbackSpeed: number;
    scenario: Scenario | null;
}
</file>

<file path="src/lib/types/spec-diff.ts">
/**
 * Spec Diff Types
 * ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆSpecå·®åˆ†ã®å‹å®šç¾©
 */

import type { AgentSpec } from './agent';

export type DiffOperation = 'add' | 'remove' | 'modify';

export interface SpecDiff {
    id: string;
    agentName: string;
    operation: DiffOperation;
    path: string; // e.g., "capabilities", "constraints", "communication.canSendTo"
    before?: unknown;
    after?: unknown;
    description: string;
    impact: 'low' | 'medium' | 'high';
}

export interface SpecPatch {
    id: string;
    name: string;
    description: string;
    diffs: SpecDiff[];
    createdAt: Date;
}

// äº‹å‰å®šç¾©ã•ã‚ŒãŸSpecå¤‰æ›´ãƒ‘ãƒƒãƒ
export interface PredefinedPatch {
    id: string;
    name: string;
    description: string;
    icon: string;
    category: 'capability' | 'constraint' | 'communication' | 'observability';
    diffs: Omit<SpecDiff, 'id'>[];
}
</file>

<file path="src/lib/index.ts">
// place files you want to import through the `$lib` alias in this folder.
</file>

<file path="src/routes/+layout.ts">
export const prerender = true;
export const trailingSlash = 'always';
</file>

<file path="src/app.d.ts">
// See https://svelte.dev/docs/kit/types#app.d.ts
// for information about these interfaces
declare global {
	namespace App {
		// interface Error {}
		// interface Locals {}
		// interface PageData {}
		// interface PageState {}
		// interface Platform {}
	}
}

export {};
</file>

<file path="src/global.css">
/* ========================================
   Aether Console - SFé¢¨ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
   ======================================== */

/* ----------------------------------------
   CSS Variables
   ---------------------------------------- */
:root {
	/* Colors - Deep Space Theme */
	--color-bg-primary: #0a0a1a;
	--color-bg-secondary: #0f0f2a;
	--color-bg-panel: rgba(15, 15, 42, 0.8);
	--color-bg-panel-hover: rgba(20, 20, 50, 0.9);

	/* Accent Colors */
	--color-cyan: #00ffff;
	--color-cyan-dim: #00aaaa;
	--color-blue: #00aaff;
	--color-green: #00ff88;
	--color-orange: #ff6b35;
	--color-red: #ff3366;

	/* Text */
	--color-text: #e0e0e0;
	--color-text-dim: #888888;
	--color-text-bright: #ffffff;

	/* Borders */
	--color-border: rgba(0, 255, 255, 0.3);
	--color-border-bright: rgba(0, 255, 255, 0.6);

	/* Shadows & Glows */
	--glow-cyan: 0 0 10px rgba(0, 255, 255, 0.5), 0 0 20px rgba(0, 255, 255, 0.3);
	--glow-cyan-strong: 0 0 10px rgba(0, 255, 255, 0.8), 0 0 30px rgba(0, 255, 255, 0.5), 0 0 50px rgba(0, 255, 255, 0.3);

	/* Typography */
	--font-primary: 'Rajdhani', 'Orbitron', 'Segoe UI', sans-serif;
	--font-mono: 'Fira Code', 'JetBrains Mono', monospace;

	/* Spacing */
	--space-xs: 0.25rem;
	--space-sm: 0.5rem;
	--space-md: 1rem;
	--space-lg: 1.5rem;
	--space-xl: 2rem;
	--space-2xl: 3rem;

	/* Border Radius */
	--radius-sm: 2px;
	--radius-md: 4px;
	--radius-lg: 8px;

	/* Transitions */
	--transition-fast: 150ms ease;
	--transition-normal: 300ms ease;
	--transition-slow: 500ms ease;
}

/* ----------------------------------------
   Global Reset & Base
   ---------------------------------------- */
*,
*::before,
*::after {
	box-sizing: border-box;
	margin: 0;
	padding: 0;
}

html {
	font-size: 16px;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

body {
	font-family: var(--font-primary);
	background-color: var(--color-bg-primary);
	color: var(--color-text);
	line-height: 1.6;
	min-height: 100vh;
	overflow-x: hidden;
}

/* ----------------------------------------
   Scanlines Overlay
   ---------------------------------------- */
.scanlines::before {
	content: '';
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	pointer-events: none;
	z-index: 9999;
	background: repeating-linear-gradient(
		0deg,
		rgba(0, 0, 0, 0.1) 0px,
		rgba(0, 0, 0, 0.1) 1px,
		transparent 1px,
		transparent 2px
	);
	opacity: 0.3;
}

/* ----------------------------------------
   Typography
   ---------------------------------------- */
h1, h2, h3, h4, h5, h6 {
	font-family: var(--font-primary);
	font-weight: 600;
	color: var(--color-text-bright);
	text-transform: uppercase;
	letter-spacing: 0.05em;
}

h1 { font-size: 2.5rem; }
h2 { font-size: 2rem; }
h3 { font-size: 1.5rem; }
h4 { font-size: 1.25rem; }

/* ----------------------------------------
   Glow Effects
   ---------------------------------------- */
.glow {
	text-shadow: var(--glow-cyan);
}

.glow-strong {
	text-shadow: var(--glow-cyan-strong);
}

.glow-box {
	box-shadow: var(--glow-cyan);
}

/* ----------------------------------------
   Panel Base Styles
   ---------------------------------------- */
.panel {
	background: var(--color-bg-panel);
	border: 1px solid var(--color-border);
	position: relative;
	backdrop-filter: blur(10px);
	transition: border-color var(--transition-normal), box-shadow var(--transition-normal);
}

.panel:hover {
	border-color: var(--color-border-bright);
	box-shadow: var(--glow-cyan);
}

/* Corner Cut Effect */
.panel-corner {
	clip-path: polygon(
		0 10px,
		10px 0,
		100% 0,
		100% calc(100% - 10px),
		calc(100% - 10px) 100%,
		0 100%
	);
}

.panel-corner::before {
	content: '';
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	border: 1px solid var(--color-border);
	clip-path: inherit;
	pointer-events: none;
}

/* ----------------------------------------
   Animations
   ---------------------------------------- */
@keyframes pulse {
	0%, 100% { opacity: 1; }
	50% { opacity: 0.5; }
}

@keyframes glow-pulse {
	0%, 100% { 
		box-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
	}
	50% { 
		box-shadow: 0 0 15px rgba(0, 255, 255, 0.8), 0 0 30px rgba(0, 255, 255, 0.4);
	}
}

@keyframes glitch {
	0%, 100% {
		transform: translate(0);
		text-shadow: var(--glow-cyan);
	}
	20% {
		transform: translate(-2px, 2px);
		text-shadow: -2px 0 var(--color-red), 2px 0 var(--color-cyan);
	}
	40% {
		transform: translate(2px, -2px);
		text-shadow: 2px 0 var(--color-red), -2px 0 var(--color-cyan);
	}
	60% {
		transform: translate(-1px, 1px);
		text-shadow: -1px 0 var(--color-red), 1px 0 var(--color-cyan);
	}
	80% {
		transform: translate(1px, -1px);
		text-shadow: 1px 0 var(--color-red), -1px 0 var(--color-cyan);
	}
}

.animate-pulse {
	animation: pulse 2s infinite;
}

.animate-glow-pulse {
	animation: glow-pulse 2s infinite;
}

/* ----------------------------------------
   Utility Classes
   ---------------------------------------- */
.text-cyan { color: var(--color-cyan); }
.text-blue { color: var(--color-blue); }
.text-green { color: var(--color-green); }
.text-orange { color: var(--color-orange); }
.text-red { color: var(--color-red); }
.text-dim { color: var(--color-text-dim); }

.font-mono { font-family: var(--font-mono); }

.border-glow {
	border: 1px solid var(--color-border-bright);
	box-shadow: var(--glow-cyan);
}

/* ----------------------------------------
   Layout Utilities
   ---------------------------------------- */
.container {
	width: 100%;
	max-width: 1400px;
	margin: 0 auto;
	padding: 0 var(--space-lg);
}

.grid {
	display: grid;
	gap: var(--space-md);
}

.flex {
	display: flex;
}

.flex-center {
	display: flex;
	align-items: center;
	justify-content: center;
}

/* ----------------------------------------
   Scrollbar Styling
   ---------------------------------------- */
::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

::-webkit-scrollbar-track {
	background: var(--color-bg-secondary);
}

::-webkit-scrollbar-thumb {
	background: var(--color-border);
	border-radius: var(--radius-sm);
}

::-webkit-scrollbar-thumb:hover {
	background: var(--color-border-bright);
}
</file>

<file path="static/robots.txt">
# allow crawling everything by default
User-agent: *
Disallow:
</file>

<file path=".npmrc">
engine-strict=true
</file>

<file path="tsconfig.json">
{
	"extends": "./.svelte-kit/tsconfig.json",
	"compilerOptions": {
		"rewriteRelativeImportExtensions": true,
		"allowJs": true,
		"checkJs": true,
		"esModuleInterop": true,
		"forceConsistentCasingInFileNames": true,
		"resolveJsonModule": true,
		"skipLibCheck": true,
		"sourceMap": true,
		"strict": true,
		"moduleResolution": "bundler"
	}
	// Path aliases are handled by https://svelte.dev/docs/kit/configuration#alias
	// except $lib which is handled by https://svelte.dev/docs/kit/configuration#files
	//
	// To make changes to top-level options such as include and exclude, we recommend extending
	// the generated config; see https://svelte.dev/docs/kit/configuration#typescript
}
</file>

<file path=".agent/workflows/publish.md">
---
description: GitHubã¸ã‚¯ãƒªãƒ¼ãƒ³ãªã‚³ãƒŸãƒƒãƒˆã‚’å…¬é–‹ã™ã‚‹ï¼ˆdocsé™¤å¤–ï¼‰
---
# GitHubå…¬é–‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

é–‹ç™ºãƒ–ãƒ©ãƒ³ãƒã®å¤‰æ›´ã‚’GitHubã¸å…¬é–‹ã—ã¾ã™ã€‚**docsãƒ•ã‚©ãƒ«ãƒ€ã¯è‡ªå‹•çš„ã«é™¤å¤–ã•ã‚Œã¾ã™ã€‚**

## æ‰‹é †

// turbo
1. `git stash` ã§æœªã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ã‚’é€€é¿
// turbo
2. `git checkout -b public-clean` ã§ä¸€æ™‚ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ
// turbo
3. `git rm -r --cached docs/ .agent/` ã§docsã¨.agentã‚’Gitè¿½è·¡ã‹ã‚‰é™¤å¤–
// turbo
4. `git commit -m "chore: Remove private docs for public release"` ã§ã‚³ãƒŸãƒƒãƒˆ
5. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ—ãƒƒã‚·ãƒ¥å†…å®¹ã‚’ç¢ºèªã™ã‚‹
// turbo
6. `git push public public-clean:main --force` ã§GitHubã¸ãƒ—ãƒƒã‚·ãƒ¥
// turbo
7. `git checkout main --force` ã§mainãƒ–ãƒ©ãƒ³ãƒã«æˆ»ã‚‹
// turbo
8. `git branch -D public-clean` ã§ä¸€æ™‚ãƒ–ãƒ©ãƒ³ãƒã‚’å‰Šé™¤
// turbo
9. `git stash pop` ã§é€€é¿ã—ãŸå¤‰æ›´ã‚’å¾©å…ƒ
10. å®Œäº†ã‚’å ±å‘Šã™ã‚‹

## é™¤å¤–ã•ã‚Œã‚‹ãƒ•ã‚©ãƒ«ãƒ€

- `docs/` - å†…éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `.agent/` - AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
</file>

<file path="docs/roadmap.md">
# Aether Console ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

## æ¦‚è¦

Aether Consoleã¯SFé¢¨ã®AIã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ PWAã€‚è¤‡æ•°ã®AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å¯è¦–åŒ–ãƒ»åˆ¶å¾¡ã—ã€æœ€çµ‚çš„ã«ã¯Spec-Flow Studioã‚’ç›£è¦–ã™ã‚‹ã€‚

## é–‹ç™ºæ–¹é‡

```
Aether Console (å…ˆè¡Œé–‹ç™º)
     â†“
Spec-Kitå½¢å¼ã‚’è¨­è¨ˆãƒ»å…±é€šåŒ–
     â†“
Spec-Flow Studio (å¾Œç¶šé–‹ç™º)
     â†“
ä¸¡è€…é€£æºã§å®Œæˆ
```

---

## Phase 1: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Œæˆ

**ç›®æ¨™**: SFé¢¨å¸ä»¤å®¤UIã®å®Œæˆã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§ã®å‹•ä½œç¢ºèª

| ã‚¿ã‚¹ã‚¯ | çŠ¶æ…‹ | è©³ç´° |
|--------|------|------|
| SvelteKitãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– | âœ… | TypeScript, PWAè¨­å®šæ¸ˆã¿ |
| SFé¢¨ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ  | âœ… | global.css, Panel, GlitchText, StatusIndicator |
| å¸ä»¤å®¤ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ | â¬œ | è¤‡æ•°ãƒ‘ãƒãƒ«ã®ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ |
| ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ‘ãƒãƒ« | â¬œ | å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®çŠ¶æ…‹è¡¨ç¤º |
| ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›è¡¨ç¤º | â¬œ | ãƒ­ã‚°/ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ è¡¨ç¤º |
| GitHub Pages ãƒ‡ãƒ—ãƒ­ã‚¤ | â¬œ | adapter-staticè¨­å®š |

**æˆæœç‰©**: é™çš„ãªSFé¢¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ï¼‰

---

## Phase 2: é™çš„ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**ç›®æ¨™**: ã€ŒAIãŒã„ãªãã¦ã‚‚ã€"AIãŒåˆ¶å¾¡ã•ã‚Œã¦ã„ã‚‹æ„Ÿè¦š"ãŒä½“é¨“ã§ãã‚‹ã€

| ã‚¿ã‚¹ã‚¯ | çŠ¶æ…‹ | è©³ç´° |
|--------|------|------|
| Spec-Kitå½¢å¼è¨­è¨ˆ | âœ… | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©ã®YAML/JSONå½¢å¼ |
| ãƒ¢ãƒƒã‚¯ã‚·ãƒŠãƒªã‚ªä½œæˆ | â¬œ | äº‹å‰å®šç¾©ã—ãŸä¼šè©±ã‚·ãƒŠãƒªã‚ª |
| ã‚·ãƒŠãƒªã‚ªå†ç”Ÿæ©Ÿèƒ½ | â¬œ | ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä¸Šã§ã‚·ãƒŠãƒªã‚ªã‚’å†ç”Ÿ |
| ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ä¼šè©±è¡¨ç¤º | â¬œ | ä¼šè©±ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚º |
| Specå·®åˆ†ã®é©ç”¨ãƒ»å†ç”Ÿ | â¬œ | ä»•æ§˜å¤‰æ›´ã®å³æ™‚åæ˜  |
| å·®åˆ†ã«ã‚ˆã‚‹æŒ™å‹•å¤‰åŒ–ã®å¯è¦–åŒ– | â¬œ | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè²¬ä»»å¢ƒç•Œã®å¯è¦–åŒ– |

**æˆæœç‰©**: 
- ã‚·ãƒŠãƒªã‚ªå†ç”Ÿå¯èƒ½ãªãƒ‡ãƒ¢
- Specå·®åˆ† â†’ æŒ™å‹•å¤‰åŒ–ã®å¯è¦–åŒ–
- å°†æ¥ç”Ÿæˆã•ã‚Œã‚‹UI/API/Testã®"äºˆå‘Šè¡¨ç¤º"ï¼ˆSpec-Flow Studioã®"å½±"ï¼‰

---

## Phase 3: AIçµ±åˆ

**ç›®æ¨™**: å®Ÿéš›ã®AI APIã¨æ¥ç¶šã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‹•ä½œ

| ã‚¿ã‚¹ã‚¯ | çŠ¶æ…‹ | è©³ç´° |
|--------|------|------|
| AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡ŒåŸºç›¤ | â¬œ | Gemini/Claude APIé€£æº |
| ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç† | â¬œ | Svelte storeã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ç®¡ç† |
| WebSocket/SSEæ¥ç¶š | â¬œ | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ |
| ææ¡ˆçµ±åˆæ©Ÿèƒ½ | â¬œ | è¤‡æ•°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‡ºåŠ›ã®ã¾ã¨ã‚ |
| Spec-Flow Studioé€£æº | â¬œ | ç›£è¦–å¯¾è±¡ã¨ã®æ¥ç¶š |

**æˆæœç‰©**: å®Ÿéš›ã«AIãŒå‹•ä½œã™ã‚‹å¸ä»¤å®¤

---

## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ§‹æˆï¼ˆäºˆå®šï¼‰

| ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ | å½¹å‰² | ç›£è¦–å¯¾è±¡ |
|-------------|------|---------|
| **Analyzer** | æƒ…å ±è§£æ | å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®åˆ†æ |
| **Predictor** | äºˆæ¸¬ | ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»ãƒªã‚¹ã‚¯äºˆæ¸¬ |
| **Planner** | è¨ˆç”»ç«‹æ¡ˆ | æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ææ¡ˆ |
| **Monitor** | ãƒªã‚¹ã‚¯ç›£è¦– | ç•°å¸¸æ¤œçŸ¥ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ |

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ |
|---------|------|
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | SvelteKit + TypeScript |
| ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° | Vanilla CSS |
| PWA | vite-plugin-pwa |
| ãƒ‡ãƒ—ãƒ­ã‚¤ | GitHub Pages â†’ Vercelï¼ˆPhase 3ï¼‰ |
| AI API | Gemini / Claudeï¼ˆPhase 3ï¼‰ |
| é€šä¿¡ | WebSocket / SSEï¼ˆPhase 3ï¼‰ |

---

## ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³

| ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ | ç›®æ¨™æ—¥ | å†…å®¹ |
|---------------|--------|------|
| M1: UIåŸºç›¤å®Œæˆ | - | Phase 1å®Œäº† |
| M2: ãƒ‡ãƒ¢å¯èƒ½ | - | Phase 2å®Œäº†ã€ã‚·ãƒŠãƒªã‚ªå†ç”Ÿ |
| M3: AIçµ±åˆ | - | Phase 3å®Œäº†ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‹•ä½œ |
| M4: Spec-Flowé€£æº | - | Spec-Flow Studioã¨é€£æº |
</file>

<file path="docs/spec-kit-format.md">
# Spec-Kit ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©å½¢å¼ï¼ˆDraftï¼‰

## æ¦‚è¦

Spec-Kitã¯ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å½¹å‰²ãƒ»èƒ½åŠ›ãƒ»åˆ¶ç´„ã‚’å®£è¨€çš„ã«å®šç¾©ã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€‚
Aether Consoleã¨Spec-Flow Studioã®ä¸¡æ–¹ã§å…±é€šåˆ©ç”¨ã™ã‚‹ã€‚

---

## åŸºæœ¬æ§‹é€ 

```yaml
# agent.spec.yaml
kind: Agent
version: v1
metadata:
  name: analyzer
  displayName: "Analyzer"
  description: "æƒ…å ±è§£æã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"
  icon: "ğŸ”"

spec:
  role: |
    å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€æ§‹é€ åŒ–ã•ã‚ŒãŸæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã€‚
    ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ç•°å¸¸ã‚’æ¤œå‡ºã—ã€ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å ±å‘Šã™ã‚‹ã€‚

  capabilities:
    - data-analysis
    - pattern-recognition
    - anomaly-detection

  constraints:
    - "æ¨æ¸¬ã§æƒ…å ±ã‚’è£œå®Œã—ãªã„"
    - "ç¢ºä¿¡åº¦ãŒä½ã„å ´åˆã¯æ˜ç¤ºã™ã‚‹"

  inputs:
    - type: text
      description: "åˆ†æå¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿"
    - type: structured-data
      description: "JSONå½¢å¼ã®æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿"

  outputs:
    - type: analysis-report
      schema:
        findings: string[]
        confidence: number
        anomalies: string[]

  triggers:
    - event: data-received
      action: analyze
    - event: request-from-planner
      action: deep-analyze

  communication:
    canSendTo:
      - predictor
      - planner
      - monitor
    canReceiveFrom:
      - planner
      - monitor

  # Aether Consoleã¸ã®å…¬é–‹è¨­å®š
  observability:
    expose:
      - status
      - progress
      - metrics.errorRate
    logLevel: info
```

---

## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“é€šä¿¡

```yaml
# message.spec.yaml
kind: Message
version: v1
metadata:
  id: "msg-001"
  from: analyzer
  to: predictor
  timestamp: "2026-01-14T00:30:00Z"

spec:
  type: analysis-complete
  priority: normal
  content:
    summary: "ãƒ‡ãƒ¼ã‚¿åˆ†æå®Œäº†"
    findings:
      - "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ç•°å¸¸ãªã—"
      - "CPUä½¿ç”¨ç‡ãŒé€šå¸¸ã‚ˆã‚Š20%é«˜ã„"
    confidence: 0.85
    requestPrediction: true
```

---

## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹

```yaml
# state.spec.yaml
kind: AgentState
version: v1
metadata:
  agentName: analyzer
  timestamp: "2026-01-14T00:30:00Z"

spec:
  status: active  # active | idle | warning | error | offline
  currentTask: "analyzing-input-001"
  progress: 0.65
  lastActivity: "2026-01-14T00:29:55Z"
  metrics:
    tasksCompleted: 42
    averageResponseTime: 1.2s
    errorRate: 0.02
```

---

## ã‚·ãƒŠãƒªã‚ªå®šç¾©ï¼ˆPhase 2ç”¨ï¼‰

```yaml
# scenario.spec.yaml
kind: Scenario
version: v1
metadata:
  name: "basic-analysis-flow"
  description: "åŸºæœ¬çš„ãªåˆ†æãƒ•ãƒ­ãƒ¼"

spec:
  steps:
    - time: 0
      action: set-state
      agent: analyzer
      state: { status: idle }

    - time: 1000
      action: set-state
      agent: analyzer
      state: { status: active, currentTask: "analyzing-input" }

    - time: 2000
      action: send-message
      from: analyzer
      to: predictor
      message:
        type: analysis-complete
        content: { summary: "åˆ†æå®Œäº†", confidence: 0.9 }

    - time: 3000
      action: set-state
      agent: predictor
      state: { status: active }

    - time: 5000
      action: console-log
      message: "[Predictor] äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿè¡Œä¸­..."
```

---

## è¨­è¨ˆåŸå‰‡

1. **å®£è¨€çš„**: ã€Œä½•ã‚’ã™ã‚‹ã‹ã€ã‚’è¨˜è¿°ã€ã€Œã©ã†ã‚„ã‚‹ã‹ã€ã¯å®Ÿè£…ãŒæ±ºã‚ã‚‹
2. **å‹å®‰å…¨**: ã‚¹ã‚­ãƒ¼ãƒã§input/outputã‚’æ˜ç¢ºåŒ–
3. **ç–çµåˆ**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é€šä¿¡
4. **å¯è¦–åŒ–ã—ã‚„ã™ã„**: Aether Consoleã§ã®è¡¨ç¤ºã‚’æ„è­˜ã—ãŸæ§‹é€ 

---

## ä»Šå¾Œã®æ¤œè¨äº‹é …

- [ ] ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆJSON Schema / Zodï¼‰
- [ ] ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰
- [ ] ä¼šè©±å±¥æ­´ã®æ°¸ç¶šåŒ–
- [ ] è¤‡æ•°ã‚·ãƒŠãƒªã‚ªã®åˆ‡ã‚Šæ›¿ãˆ
</file>

<file path="docs/tech_stack.md">
# æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®š

## æ±ºå®šäº‹é …

| é …ç›® | é¸æŠ | ç†ç”± |
|------|------|------|
| **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯** | SvelteKit | è»½é‡ã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¾—æ„ã€æ–°æŠ€è¡“ã¸ã®æŒ‘æˆ¦ |
| **ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«** | Vite | SvelteKitæ¨™æº–ã€é«˜é€Ÿ |
| **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°** | Vanilla CSS | SFé¢¨UIã®ãƒ•ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« |
| **ãƒ‡ãƒ—ãƒ­ã‚¤** | GitHub Pages | æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ´»ç”¨ã€ç„¡æ–™ |
| **PWA** | vite-plugin-pwa | Service Workerè‡ªå‹•ç”Ÿæˆ |

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç‰¹æ€§

- **SFé¢¨å¸ä»¤å®¤UI** â€” è¤‡æ•°ãƒ‘ãƒãƒ«ã€ã‚°ãƒªãƒƒãƒ/ã‚¹ã‚­ãƒ£ãƒ³ãƒ©ã‚¤ãƒ³ç­‰ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
- **è¤‡æ•°AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ** â€” çŠ¶æ…‹ç®¡ç†ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
- **PWA** â€” ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½
- **ä»•æ§˜é§†å‹•é–‹ç™ºã®å®Ÿé¨“** â€” AIä¸»ä½“ã§ã®ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

## å°†æ¥ã®æ‹¡å¼µ

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒå¿…è¦ã«ãªã£ãŸå ´åˆ â†’ Vercel/Cloudflare Pages ã¸ã®ç§»è¡Œã‚’æ¤œè¨
- Spec-Flow Studio ã¨ã®é€£æº â†’ åŒä¸€æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã§çµ±ä¸€
- **Phase 2**: ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ã« `zod` ã¾ãŸã¯ `valibot` ã‚’å°å…¥æ¤œè¨
  - ã€Œä»•æ§˜ãŒå£Šã‚ŒãŸã¨ãã«ã©ã†å£Šã‚ŒãŸã‹ã€ã‚’UIã«è¡¨ç¤ºå¯èƒ½ã«
- **å°†æ¥**: ãƒ†ãƒ¼ãƒãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ï¼ˆ`--theme-mode: ops | design`ï¼‰
  - Aether = æ´¾æ‰‹ï¼ˆopsï¼‰ã€Spec-Flow = æŠ‘åˆ¶ï¼ˆdesignï¼‰

## å‚è€ƒ

- [SvelteKitå…¬å¼](https://kit.svelte.dev/)
- [Vite PWA Plugin](https://vite-pwa-org.netlify.app/)
</file>

<file path="src/lib/components/ApiKeyDialog.svelte">
<!--
  ApiKeyDialog.svelte - APIã‚­ãƒ¼è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°
-->
<script lang="ts">
	import {
		encrypt,
		decrypt,
		saveEncryptedApiKey,
		getEncryptedApiKey,
		setSessionApiKey,
		clearApiKey,
		hasEncryptedApiKey,
		hasSessionApiKey
	} from '$lib/stores/crypto-store';
	import { settingsStore } from '$lib/stores/settings-store';

	interface Props {
		onClose: () => void;
		onKeySet: () => void;
	}

	let { onClose, onKeySet } = $props<Props>();

	let mode = $state<'input' | 'unlock' | 'ready'>(
		hasSessionApiKey() ? 'ready' : hasEncryptedApiKey() ? 'unlock' : 'input'
	);

	let apiKey = $state('');
	let password = $state('');
	let confirmPassword = $state('');
	let error = $state('');
	let isLoading = $state(false);

	async function handleSave() {
		error = '';

		if (!apiKey.trim()) {
			error = 'APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
			return;
		}

		if (!password) {
			error = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
			return;
		}

		if (password !== confirmPassword) {
			error = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“';
			return;
		}

		if (password.length < 8) {
			error = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„';
			return;
		}

		isLoading = true;
		try {
			const encrypted = await encrypt(apiKey.trim(), password);
			saveEncryptedApiKey(encrypted);
			setSessionApiKey(apiKey.trim());
			settingsStore.setApiKeyReady(true);
			// ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—
			await settingsStore.loadModels();
			mode = 'ready';
			onKeySet();
		} catch (e) {
			error = 'æš—å·åŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ';
		} finally {
			isLoading = false;
		}
	}

	async function handleUnlock() {
		error = '';

		if (!password) {
			error = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
			return;
		}

		const encryptedData = getEncryptedApiKey();
		if (!encryptedData) {
			error = 'ä¿å­˜ã•ã‚ŒãŸAPIã‚­ãƒ¼ãŒã‚ã‚Šã¾ã›ã‚“';
			return;
		}

		isLoading = true;
		try {
			const decryptedKey = await decrypt(encryptedData, password);
			setSessionApiKey(decryptedKey);
			settingsStore.setApiKeyReady(true);
			// ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—
			await settingsStore.loadModels();
			mode = 'ready';
			onKeySet();
		} catch {
			error = 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“';
		} finally {
			isLoading = false;
		}
	}

	function handleClear() {
		if (confirm('APIã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
			clearApiKey();
			settingsStore.setApiKeyReady(false);
			mode = 'input';
			apiKey = '';
			password = '';
			confirmPassword = '';
		}
	}

	function handleNewKey() {
		mode = 'input';
		apiKey = '';
		password = '';
		confirmPassword = '';
	}
</script>

<div class="dialog-overlay" onclick={onClose} role="presentation">
	<div class="dialog" onclick={(e) => e.stopPropagation()} role="dialog">
		<div class="dialog-header">
			<h2>ğŸ”‘ API Key Settings</h2>
			<button class="close-btn" onclick={onClose}>Ã—</button>
		</div>

		<div class="dialog-content">
			{#if mode === 'input'}
				<div class="security-notice">
					<span class="icon">ğŸ›¡ï¸</span>
					<div>
						<strong>BYOK (Bring Your Own Key)</strong>
						<p>ã‚ãªãŸã®APIã‚­ãƒ¼ã¯ãƒ–ãƒ©ã‚¦ã‚¶å¤–ã¸é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§æš—å·åŒ–ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚</p>
					</div>
				</div>

				<div class="form-group">
					<label for="apiKey">Gemini API Key</label>
					<input
						id="apiKey"
						type="password"
						bind:value={apiKey}
						placeholder="AIza..."
						autocomplete="off"
					/>
					<span class="hint">
						<a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">
							Google AI Studioã§ã‚­ãƒ¼ã‚’å–å¾—
						</a>
					</span>
				</div>

				<div class="form-group">
					<label for="password">æš—å·åŒ–ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
					<input
						id="password"
						type="password"
						bind:value={password}
						placeholder="8æ–‡å­—ä»¥ä¸Š"
						autocomplete="new-password"
					/>
				</div>

				<div class="form-group">
					<label for="confirmPassword">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª</label>
					<input
						id="confirmPassword"
						type="password"
						bind:value={confirmPassword}
						placeholder="ã‚‚ã†ä¸€åº¦å…¥åŠ›"
						autocomplete="new-password"
					/>
				</div>

				{#if error}
					<div class="error">{error}</div>
				{/if}

				<button class="btn primary" onclick={handleSave} disabled={isLoading}>
					{isLoading ? 'æš—å·åŒ–ä¸­...' : 'ä¿å­˜'}
				</button>

			{:else if mode === 'unlock'}
				<div class="security-notice">
					<span class="icon">ğŸ”</span>
					<div>
						<strong>ãƒ­ãƒƒã‚¯è§£é™¤</strong>
						<p>ä¿å­˜ã•ã‚ŒãŸAPIã‚­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
					</div>
				</div>

				<div class="form-group">
					<label for="unlockPassword">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
					<input
						id="unlockPassword"
						type="password"
						bind:value={password}
						placeholder="æš—å·åŒ–ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"
						autocomplete="current-password"
					/>
				</div>

				{#if error}
					<div class="error">{error}</div>
				{/if}

				<div class="button-group">
					<button class="btn primary" onclick={handleUnlock} disabled={isLoading}>
						{isLoading ? 'å¾©å·ä¸­...' : 'ãƒ­ãƒƒã‚¯è§£é™¤'}
					</button>
					<button class="btn secondary" onclick={handleNewKey}>
						æ–°ã—ã„ã‚­ãƒ¼ã‚’è¨­å®š
					</button>
				</div>

			{:else}
				<div class="security-notice success">
					<span class="icon">âœ…</span>
					<div>
						<strong>APIã‚­ãƒ¼è¨­å®šæ¸ˆã¿</strong>
						<p>Gemini APIãŒä½¿ç”¨å¯èƒ½ã§ã™ã€‚ã‚­ãƒ¼ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«è‡ªå‹•æ¶ˆå»ã•ã‚Œã¾ã™ã€‚</p>
					</div>
				</div>

				<div class="button-group">
					<button class="btn secondary" onclick={handleClear}>
						ã‚­ãƒ¼ã‚’å‰Šé™¤
					</button>
					<button class="btn primary" onclick={onClose}>
						é–‰ã˜ã‚‹
					</button>
				</div>
			{/if}
		</div>

		<div class="dialog-footer">
			<span class="warning">âš ï¸ XSSæ”»æ’ƒã‹ã‚‰ã¯å®Œå…¨ã«ã¯ä¿è­·ã•ã‚Œã¾ã›ã‚“</span>
		</div>
	</div>
</div>

<style>
	.dialog-overlay {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background: rgba(0, 0, 0, 0.8);
		display: flex;
		align-items: center;
		justify-content: center;
		z-index: 1000;
	}

	.dialog {
		background: var(--color-bg-secondary);
		border: 1px solid var(--color-border-bright);
		border-radius: var(--radius-lg);
		width: 90%;
		max-width: 450px;
		box-shadow: 0 0 50px rgba(0, 255, 255, 0.2);
	}

	.dialog-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		padding: var(--space-md) var(--space-lg);
		border-bottom: 1px solid var(--color-border);
	}

	.dialog-header h2 {
		margin: 0;
		font-size: 1rem;
	}

	.close-btn {
		background: none;
		border: none;
		color: var(--color-text-dim);
		font-size: 1.5rem;
		cursor: pointer;
		padding: 0;
		line-height: 1;
	}

	.close-btn:hover {
		color: var(--color-text);
	}

	.dialog-content {
		padding: var(--space-lg);
	}

	.security-notice {
		display: flex;
		gap: var(--space-md);
		padding: var(--space-md);
		background: rgba(0, 255, 255, 0.1);
		border-left: 3px solid var(--color-cyan);
		border-radius: var(--radius-sm);
		margin-bottom: var(--space-lg);
	}

	.security-notice.success {
		background: rgba(0, 255, 136, 0.1);
		border-color: var(--color-green);
	}

	.security-notice .icon {
		font-size: 1.5rem;
	}

	.security-notice strong {
		display: block;
		margin-bottom: var(--space-xs);
	}

	.security-notice p {
		margin: 0;
		font-size: 0.8rem;
		color: var(--color-text-dim);
	}

	.form-group {
		margin-bottom: var(--space-md);
	}

	.form-group label {
		display: block;
		font-size: 0.75rem;
		color: var(--color-text-dim);
		text-transform: uppercase;
		letter-spacing: 0.05em;
		margin-bottom: var(--space-xs);
	}

	.form-group input {
		width: 100%;
		padding: var(--space-sm) var(--space-md);
		background: var(--color-bg-primary);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-sm);
		color: var(--color-text);
		font-family: var(--font-mono);
		font-size: 0.9rem;
	}

	.form-group input:focus {
		outline: none;
		border-color: var(--color-cyan);
		box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
	}

	.hint {
		display: block;
		font-size: 0.7rem;
		color: var(--color-text-dim);
		margin-top: var(--space-xs);
	}

	.hint a {
		color: var(--color-cyan);
		text-decoration: none;
	}

	.hint a:hover {
		text-decoration: underline;
	}

	.error {
		color: var(--color-red);
		font-size: 0.8rem;
		margin-bottom: var(--space-md);
		padding: var(--space-sm);
		background: rgba(255, 85, 85, 0.1);
		border-radius: var(--radius-sm);
	}

	.btn {
		padding: var(--space-sm) var(--space-lg);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-sm);
		background: transparent;
		color: var(--color-text);
		cursor: pointer;
		font-size: 0.85rem;
		transition: all var(--transition-fast);
	}

	.btn.primary {
		background: rgba(0, 255, 255, 0.1);
		border-color: var(--color-cyan);
		color: var(--color-cyan);
		width: 100%;
	}

	.btn.primary:hover:not(:disabled) {
		background: rgba(0, 255, 255, 0.2);
		box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
	}

	.btn.secondary {
		border-color: var(--color-text-dim);
		color: var(--color-text-dim);
	}

	.btn.secondary:hover {
		border-color: var(--color-text);
		color: var(--color-text);
	}

	.btn:disabled {
		opacity: 0.5;
		cursor: not-allowed;
	}

	.button-group {
		display: flex;
		gap: var(--space-sm);
	}

	.button-group .btn {
		flex: 1;
	}

	.dialog-footer {
		padding: var(--space-sm) var(--space-lg);
		border-top: 1px solid var(--color-border);
		text-align: center;
	}

	.warning {
		font-size: 0.65rem;
		color: var(--color-orange);
	}
</style>
</file>

<file path="src/lib/data/agents.ts">
/**
 * Agent Definitions
 * Spec-Kitå½¢å¼ã«åŸºã¥ãã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©
 */

import type { Agent } from '../types/agent';

export const agents: Agent[] = [
    {
        name: 'analyzer',
        displayName: 'Analyzer',
        description: 'å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ç•°å¸¸ã‚’æ¤œå‡º',
        icon: 'â—ˆ',
        role: 'å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€æ§‹é€ åŒ–ã•ã‚ŒãŸæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã€‚ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ç•°å¸¸ã‚’æ¤œå‡ºã—ã€ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å ±å‘Šã™ã‚‹ã€‚',
        capabilities: ['data-analysis', 'pattern-recognition', 'anomaly-detection'],
        constraints: ['æ¨æ¸¬ã§æƒ…å ±ã‚’è£œå®Œã—ãªã„', 'ç¢ºä¿¡åº¦ãŒä½ã„å ´åˆã¯æ˜ç¤ºã™ã‚‹'],
        communication: {
            canSendTo: ['predictor', 'planner', 'monitor'],
            canReceiveFrom: ['planner', 'monitor']
        },
        state: {
            agentName: 'analyzer',
            status: 'idle',
            lastActivity: new Date(),
            metrics: {
                tasksCompleted: 42,
                averageResponseTime: '1.2s',
                errorRate: 0.02
            }
        }
    },
    {
        name: 'predictor',
        displayName: 'Predictor',
        description: 'ãƒˆãƒ¬ãƒ³ãƒ‰ã¨ãƒªã‚¹ã‚¯ã‚’äºˆæ¸¬ã—ã€å°†æ¥ã®çŠ¶æ…‹ã‚’æ¨å®š',
        icon: 'â—‡',
        role: 'éå»ã®ãƒ‡ãƒ¼ã‚¿ã¨ç¾åœ¨ã®åˆ†æçµæœã‹ã‚‰ã€å°†æ¥ã®ãƒˆãƒ¬ãƒ³ãƒ‰ã¨ãƒªã‚¹ã‚¯ã‚’äºˆæ¸¬ã™ã‚‹ã€‚',
        capabilities: ['trend-analysis', 'risk-prediction', 'forecasting'],
        constraints: ['äºˆæ¸¬ã®ä¿¡é ¼åŒºé–“ã‚’æ˜ç¤ºã™ã‚‹', 'ä¸ç¢ºå®Ÿæ€§ã‚’éš ã•ãªã„'],
        communication: {
            canSendTo: ['planner', 'monitor'],
            canReceiveFrom: ['analyzer', 'monitor']
        },
        state: {
            agentName: 'predictor',
            status: 'idle',
            lastActivity: new Date(),
            metrics: {
                tasksCompleted: 28,
                averageResponseTime: '2.1s',
                errorRate: 0.01
            }
        }
    },
    {
        name: 'monitor',
        displayName: 'Monitor',
        description: 'ç•°å¸¸æ¤œçŸ¥ã¨ã‚¢ãƒ©ãƒ¼ãƒˆç™ºå ±ã‚’æ‹…å½“',
        icon: 'â—‰',
        role: 'ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚’ç›£è¦–ã—ã€ç•°å¸¸ã‚’æ¤œçŸ¥ã—ãŸã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç™ºå ±ã™ã‚‹ã€‚',
        capabilities: ['anomaly-detection', 'alerting', 'threshold-monitoring'],
        constraints: ['èª¤æ¤œçŸ¥ã‚’æœ€å°åŒ–ã™ã‚‹', 'ã‚¢ãƒ©ãƒ¼ãƒˆç–²ã‚Œã‚’é˜²ã'],
        communication: {
            canSendTo: ['analyzer', 'predictor', 'planner'],
            canReceiveFrom: ['analyzer', 'predictor']
        },
        state: {
            agentName: 'monitor',
            status: 'idle',
            lastActivity: new Date(),
            metrics: {
                tasksCompleted: 156,
                averageResponseTime: '0.5s',
                errorRate: 0.15
            }
        }
    },
    {
        name: 'planner',
        displayName: 'Planner',
        description: 'æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ææ¡ˆã—ã€å®Ÿè¡Œè¨ˆç”»ã‚’ä½œæˆ',
        icon: 'â—†',
        role: 'ä»–ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ã®æƒ…å ±ã‚’çµ±åˆã—ã€æœ€é©ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã‚’ææ¡ˆã™ã‚‹ã€‚',
        capabilities: ['action-planning', 'resource-allocation', 'prioritization'],
        constraints: ['ãƒªã‚¹ã‚¯ã‚’è€ƒæ…®ã—ãŸè¨ˆç”»ã‚’ç«‹ã¦ã‚‹', 'å®Ÿè¡Œå¯èƒ½æ€§ã‚’æ‹…ä¿ã™ã‚‹'],
        communication: {
            canSendTo: ['analyzer', 'monitor'],
            canReceiveFrom: ['analyzer', 'predictor', 'monitor']
        },
        state: {
            agentName: 'planner',
            status: 'offline',
            lastActivity: new Date(),
            metrics: {
                tasksCompleted: 12,
                averageResponseTime: '3.5s',
                errorRate: 0.05
            }
        }
    },
    {
        name: 'synthesizer',
        displayName: 'Synthesizer',
        description: 'è¤‡æ•°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‡ºåŠ›ã‚’çµ±åˆã—ã€æœ€çµ‚ææ¡ˆã‚’ç”Ÿæˆ',
        icon: 'â—',
        role: 'å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆAnalyzer, Predictor, Monitor, Plannerï¼‰ã‹ã‚‰ã®å‡ºåŠ›ã‚’çµ±åˆã—ã€åŒ…æ‹¬çš„ãªæœ€çµ‚ææ¡ˆã‚’ç”Ÿæˆã™ã‚‹ã€‚çŸ›ç›¾ç‚¹ã‚’èª¿æ•´ã—ã€å„ªå…ˆé †ä½ã‚’ã¤ã‘ã¦æç¤ºã™ã‚‹ã€‚',
        capabilities: ['output-synthesis', 'conflict-resolution', 'priority-ranking'],
        constraints: ['å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å‡ºåŠ›ã‚’å°Šé‡ã™ã‚‹', 'é‡è¦ãªæƒ…å ±ã‚’çœç•¥ã—ãªã„', 'çŸ›ç›¾ç‚¹ã¯æ˜ç¤ºã™ã‚‹'],
        communication: {
            canSendTo: [],
            canReceiveFrom: ['analyzer', 'predictor', 'monitor', 'planner']
        },
        state: {
            agentName: 'synthesizer',
            status: 'idle',
            lastActivity: new Date(),
            metrics: {
                tasksCompleted: 0,
                averageResponseTime: '4.0s',
                errorRate: 0.0
            }
        }
    }
];

export function getAgentByName(name: string): Agent | undefined {
    return agents.find(a => a.name === name);
}
</file>

<file path="src/lib/stores/gemini-client.ts">
/**
 * Gemini API Client
 * Google Gemini APIã¨ã®é€šä¿¡
 */

import { getSessionApiKey } from './crypto-store';

const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models';
const DEFAULT_MODEL = 'gemini-2.0-flash';

interface GeminiMessage {
    role: 'user' | 'model';
    parts: { text: string }[];
}

interface GeminiRequest {
    contents: GeminiMessage[];
    generationConfig?: {
        temperature?: number;
        maxOutputTokens?: number;
        topP?: number;
        topK?: number;
    };
    systemInstruction?: {
        parts: { text: string }[];
    };
}

interface GeminiResponse {
    candidates: {
        content: {
            parts: { text: string }[];
            role: string;
        };
        finishReason: string;
    }[];
    usageMetadata?: {
        promptTokenCount: number;
        candidatesTokenCount: number;
        totalTokenCount: number;
    };
}

export interface AgentMessage {
    role: 'user' | 'assistant';
    content: string;
}

export interface AgentConfig {
    systemPrompt: string;
    temperature?: number;
    maxTokens?: number;
}

// APIã‚­ãƒ¼ãŒåˆ©ç”¨å¯èƒ½ã‹ç¢ºèª
export function isApiKeyAvailable(): boolean {
    return getSessionApiKey() !== null;
}

// Gemini APIã‚’å‘¼ã³å‡ºã™
export async function callGemini(
    messages: AgentMessage[],
    config: AgentConfig,
    model: string = DEFAULT_MODEL,
    signal?: AbortSignal
): Promise<string> {
    const apiKey = getSessionApiKey();
    if (!apiKey) {
        throw new Error('APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚è¨­å®šç”»é¢ã‹ã‚‰APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
    }

    const geminiMessages: GeminiMessage[] = messages.map(msg => ({
        role: msg.role === 'user' ? 'user' : 'model',
        parts: [{ text: msg.content }]
    }));

    const request: GeminiRequest = {
        contents: geminiMessages,
        generationConfig: {
            temperature: config.temperature ?? 0.7,
            maxOutputTokens: config.maxTokens ?? 1024
        }
    };

    if (config.systemPrompt) {
        request.systemInstruction = {
            parts: [{ text: config.systemPrompt }]
        };
    }

    const response = await fetch(
        `${GEMINI_API_URL}/${model}:generateContent?key=${apiKey}`,
        {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(request),
            signal
        }
    );

    if (!response.ok) {
        const error = await response.json();
        throw new Error(error.error?.message || `API Error: ${response.status}`);
    }

    const data: GeminiResponse = await response.json();

    if (!data.candidates || data.candidates.length === 0) {
        throw new Error('AIã‹ã‚‰ã®å¿œç­”ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ');
    }

    return data.candidates[0].content.parts.map(p => p.text).join('');
}

// ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¯¾å¿œã®Gemini APIå‘¼ã³å‡ºã—
export async function* callGeminiStream(
    messages: AgentMessage[],
    config: AgentConfig,
    model: string = DEFAULT_MODEL
): AsyncGenerator<string, void, unknown> {
    const apiKey = getSessionApiKey();
    if (!apiKey) {
        throw new Error('APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }

    const geminiMessages: GeminiMessage[] = messages.map(msg => ({
        role: msg.role === 'user' ? 'user' : 'model',
        parts: [{ text: msg.content }]
    }));

    const request: GeminiRequest = {
        contents: geminiMessages,
        generationConfig: {
            temperature: config.temperature ?? 0.7,
            maxOutputTokens: config.maxTokens ?? 1024
        }
    };

    if (config.systemPrompt) {
        request.systemInstruction = {
            parts: [{ text: config.systemPrompt }]
        };
    }

    const response = await fetch(
        `${GEMINI_API_URL}/${model}:streamGenerateContent?key=${apiKey}&alt=sse`,
        {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(request)
        }
    );

    if (!response.ok) {
        const error = await response.json();
        throw new Error(error.error?.message || `API Error: ${response.status}`);
    }

    const reader = response.body?.getReader();
    if (!reader) {
        throw new Error('ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’èª­ã¿å–ã‚Œã¾ã›ã‚“ã§ã—ãŸ');
    }

    const decoder = new TextDecoder();
    let buffer = '';

    while (true) {
        const { done, value } = await reader.read();
        if (done) break;

        buffer += decoder.decode(value, { stream: true });
        const lines = buffer.split('\n');
        buffer = lines.pop() || '';

        for (const line of lines) {
            if (line.startsWith('data: ')) {
                try {
                    const data = JSON.parse(line.slice(6));
                    const text = data.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (text) {
                        yield text;
                    }
                } catch {
                    // ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–
                }
            }
        }
    }
}
</file>

<file path="src/lib/stores/settings-store.ts">
/**
 * Settings Store
 * è¨­å®šã®çŠ¶æ…‹ç®¡ç†ï¼ˆãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼‰
 * ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã¯APIã‹ã‚‰å‹•çš„ã«å–å¾—
 */

import { writable, get } from 'svelte/store';
import { browser } from '$app/environment';

// ãƒ¢ãƒ‡ãƒ«æƒ…å ±ã®å‹
export interface ModelInfo {
    id: string;
    name: string;
    description: string;
}

// è¨­å®šã®å‹
interface Settings {
    selectedModel: string;
    apiKeyReady: boolean;
    availableModels: ModelInfo[];
    isLoadingModels: boolean;
    modelError: string | null;
    streamingEnabled: boolean;
}

// ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒã§ã®ã¿sessionStorageã‚’ãƒã‚§ãƒƒã‚¯
function getApiKey(): string | null {
    if (!browser) return null;
    return sessionStorage.getItem('aether-console-decrypted-key');
}

// Gemini APIã‹ã‚‰ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—
async function fetchAvailableModels(apiKey: string): Promise<ModelInfo[]> {
    const response = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`
    );

    if (!response.ok) {
        throw new Error('ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
    }

    const data = await response.json();

    // generateContentã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã®ã¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    const models: ModelInfo[] = data.models
        .filter((m: any) =>
            m.supportedGenerationMethods?.includes('generateContent') &&
            m.name.includes('gemini')
        )
        .map((m: any) => ({
            id: m.name.replace('models/', ''),
            name: m.displayName || m.name.replace('models/', ''),
            description: m.description || ''
        }))
        // Flash/Proã‚’å„ªå…ˆã€æœ€æ–°é †
        .sort((a: ModelInfo, b: ModelInfo) => {
            // flashãŒä¸Šã€proãŒä¸‹
            const aFlash = a.id.includes('flash');
            const bFlash = b.id.includes('flash');
            if (aFlash && !bFlash) return -1;
            if (!aFlash && bFlash) return 1;
            // æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸Š
            return b.id.localeCompare(a.id);
        });

    return models;
}

function createSettingsStore() {
    const { subscribe, set, update } = writable<Settings>({
        selectedModel: '',
        apiKeyReady: false,
        availableModels: [],
        isLoadingModels: false,
        modelError: null,
        streamingEnabled: true
    });

    return {
        subscribe,
        setModel: (modelId: string) => {
            update(s => ({ ...s, selectedModel: modelId }));
        },
        setApiKeyReady: (ready: boolean) => {
            update(s => ({ ...s, apiKeyReady: ready }));
        },
        // ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—
        loadModels: async () => {
            const apiKey = getApiKey();
            if (!apiKey) return;

            update(s => ({ ...s, isLoadingModels: true, modelError: null }));

            try {
                const models = await fetchAvailableModels(apiKey);
                update(s => ({
                    ...s,
                    availableModels: models,
                    selectedModel: models.length > 0 ? models[0].id : '',
                    isLoadingModels: false
                }));
            } catch (error) {
                update(s => ({
                    ...s,
                    modelError: error instanceof Error ? error.message : 'ãƒ¢ãƒ‡ãƒ«å–å¾—ã‚¨ãƒ©ãƒ¼',
                    isLoadingModels: false
                }));
            }
        },
        // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§åˆæœŸåŒ–
        init: async () => {
            if (!browser) return;

            const apiKey = getApiKey();
            if (apiKey) {
                update(s => ({ ...s, apiKeyReady: true }));
                // ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’è‡ªå‹•å–å¾—
                const store = get({ subscribe });
                if (store.availableModels.length === 0) {
                    await createSettingsStore().loadModels();
                }
            }
        },
        // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è¨­å®š
        setStreaming: (enabled: boolean) => {
            update(s => ({ ...s, streamingEnabled: enabled }));
        }
    };
}

export const settingsStore = createSettingsStore();
</file>

<file path="src/lib/stores/spec-diff.ts">
/**
 * Spec Diff Store
 * Specå·®åˆ†ã®çŠ¶æ…‹ç®¡ç†
 */

import { writable, derived, get } from 'svelte/store';
import type { SpecDiff, PredefinedPatch } from '../types/spec-diff';
import { agentStore, logStore } from './simulation';

// é©ç”¨æ¸ˆã¿ãƒ‘ãƒƒãƒ
function createAppliedPatchesStore() {
    const { subscribe, set, update } = writable<PredefinedPatch[]>([]);

    return {
        subscribe,
        reset: () => set([]),
        apply: (patch: PredefinedPatch) => {
            update(patches => {
                // æ—¢ã«é©ç”¨æ¸ˆã¿ãªã‚‰ã‚¹ã‚­ãƒƒãƒ—
                if (patches.some(p => p.id === patch.id)) {
                    return patches;
                }

                // ãƒ‘ãƒƒãƒã®diffã‚’é©ç”¨
                patch.diffs.forEach(diff => {
                    applyDiff(diff);
                });

                // ãƒ­ã‚°ã«è¨˜éŒ²
                logStore.add({
                    level: 'success',
                    source: 'SpecKit',
                    message: `Patché©ç”¨: ${patch.name}`
                });

                return [...patches, patch];
            });
        },
        revert: (patchId: string) => {
            update(patches => {
                const patch = patches.find(p => p.id === patchId);
                if (!patch) return patches;

                // ãƒ‘ãƒƒãƒã®diffã‚’å·»ãæˆ»ã™
                patch.diffs.forEach(diff => {
                    revertDiff(diff);
                });

                // ãƒ­ã‚°ã«è¨˜éŒ²
                logStore.add({
                    level: 'warning',
                    source: 'SpecKit',
                    message: `Patchå–æ¶ˆ: ${patch.name}`
                });

                return patches.filter(p => p.id !== patchId);
            });
        },
        isApplied: (patchId: string): boolean => {
            return get({ subscribe }).some(p => p.id === patchId);
        },
        // Studioã‹ã‚‰å—ä¿¡ã—ãŸãƒ‘ãƒƒãƒã‚’è¿½åŠ ï¼ˆé©ç”¨æ¸ˆã¿ã¨ã—ã¦ãƒãƒ¼ã‚¯ï¼‰
        addFromStudio: (patch: PredefinedPatch) => {
            update(patches => {
                // æ—¢ã«å­˜åœ¨ã™ã‚‹ãªã‚‰ã‚¹ã‚­ãƒƒãƒ—
                if (patches.some(p => p.id === patch.id)) {
                    return patches;
                }

                // ãƒ‘ãƒƒãƒã®diffã‚’é©ç”¨
                patch.diffs.forEach(diff => {
                    applyDiff(diff);
                });

                // ãƒ­ã‚°ã«è¨˜éŒ²
                logStore.add({
                    level: 'success',
                    source: 'Studio',
                    message: `Studioã‹ã‚‰ãƒ‘ãƒƒãƒå—ä¿¡: ${patch.name}`
                });

                return [...patches, patch];
            });
        }
    };
}

// å·®åˆ†ã‚’é©ç”¨
function applyDiff(diff: Omit<SpecDiff, 'id'>) {
    const { agentName, operation, path, after } = diff;

    // çŠ¶æ…‹å¤‰æ›´ã®ã¿ã‚’ã“ã“ã§å‡¦ç†ï¼ˆä»–ã®å¤‰æ›´ã¯å°†æ¥ã®æ‹¡å¼µç”¨ï¼‰
    if (path === 'state.status' && typeof after === 'string') {
        agentStore.updateState(agentName, {
            status: after as 'active' | 'idle' | 'warning' | 'error' | 'offline'
        });
    }

    // capabilityè¿½åŠ ã®ãƒ­ã‚°
    if (path === 'capabilities' && operation === 'add') {
        logStore.add({
            level: 'info',
            source: agentName,
            message: `æ–°èƒ½åŠ›è¿½åŠ : ${after}`
        });
    }

    // åˆ¶ç´„å¤‰æ›´ã®ãƒ­ã‚°
    if (path.startsWith('constraints') && operation === 'modify') {
        logStore.add({
            level: 'info',
            source: agentName,
            message: `åˆ¶ç´„æ›´æ–°: ${diff.before} â†’ ${after}`
        });
    }

    // é€šä¿¡è¨­å®šå¤‰æ›´ã®ãƒ­ã‚°
    if (path.startsWith('communication') && operation === 'add') {
        logStore.add({
            level: 'info',
            source: agentName,
            message: `é€šä¿¡è¨±å¯è¿½åŠ : ${after}`
        });
    }
}

// å·®åˆ†ã‚’å·»ãæˆ»ã™
function revertDiff(diff: Omit<SpecDiff, 'id'>) {
    const { agentName, operation, path, before } = diff;

    // çŠ¶æ…‹ã‚’å…ƒã«æˆ»ã™
    if (path === 'state.status' && typeof before === 'string') {
        agentStore.updateState(agentName, {
            status: before as 'active' | 'idle' | 'warning' | 'error' | 'offline'
        });
    }
}

// Store exports
export const appliedPatchesStore = createAppliedPatchesStore();

// Derived: é©ç”¨æ¸ˆã¿ãƒ‘ãƒƒãƒã®IDä¸€è¦§
export const appliedPatchIds = derived(appliedPatchesStore, $patches =>
    $patches.map(p => p.id)
);
</file>

<file path="src/lib/stores/studio-connection.ts">
/**
 * Spec-Flow Studio Connection Service
 * WebSocketã‚’ä½¿ç”¨ã—ãŸStudioã¨ã®æ¥ç¶šç®¡ç†
 */

import { writable, get } from 'svelte/store';
import { browser } from '$app/environment';
import type {
    ConsoleToStudioEvent,
    StudioToConsoleEvent,
    IntegrationConfig,
    DEFAULT_INTEGRATION_CONFIG
} from '../types/integration';
import { appliedPatchesStore } from './spec-diff';
import { logStore } from './simulation';

// æ¥ç¶šçŠ¶æ…‹
export type ConnectionStatus = 'disconnected' | 'connecting' | 'connected' | 'error';

interface StudioConnectionState {
    status: ConnectionStatus;
    studioUrl: string;
    autoSync: boolean;
    lastError: string | null;
    lastSyncTime: Date | null;
}

// WebSocketã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
let ws: WebSocket | null = null;
let reconnectTimer: ReturnType<typeof setTimeout> | null = null;

function createStudioConnectionStore() {
    const { subscribe, set, update } = writable<StudioConnectionState>({
        status: 'disconnected',
        studioUrl: 'ws://localhost:3001/api/ws',
        autoSync: false,
        lastError: null,
        lastSyncTime: null
    });

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ç”¨ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
    let onEventReceived: ((event: StudioToConsoleEvent) => void) | null = null;

    // WebSocketæ¥ç¶š
    function connect() {
        if (!browser) return;

        const state = get({ subscribe });

        if (ws && (ws.readyState === WebSocket.CONNECTING || ws.readyState === WebSocket.OPEN)) {
            console.log('Already connected or connecting');
            return;
        }

        update(s => ({ ...s, status: 'connecting', lastError: null }));

        try {
            ws = new WebSocket(state.studioUrl);

            ws.onopen = () => {
                update(s => ({ ...s, status: 'connected' }));
                logStore.add({
                    level: 'success',
                    source: 'Studio',
                    message: 'Spec-Flow Studioã«æ¥ç¶šã—ã¾ã—ãŸ'
                });

                // æ¥ç¶šå¾Œã«åŒæœŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
                sendEvent({ type: 'SYNC_REQUEST' });
            };

            ws.onclose = (event) => {
                update(s => ({ ...s, status: 'disconnected' }));
                logStore.add({
                    level: 'warning',
                    source: 'Studio',
                    message: `æ¥ç¶šãŒåˆ‡æ–­ã•ã‚Œã¾ã—ãŸ (code: ${event.code})`
                });
                ws = null;

                // è‡ªå‹•å†æ¥ç¶šï¼ˆautoSyncãŒæœ‰åŠ¹ãªå ´åˆï¼‰
                const currentState = get({ subscribe });
                if (currentState.autoSync && !reconnectTimer) {
                    reconnectTimer = setTimeout(() => {
                        reconnectTimer = null;
                        connect();
                    }, 5000);
                }
            };

            ws.onerror = (error) => {
                update(s => ({ ...s, status: 'error', lastError: 'æ¥ç¶šã‚¨ãƒ©ãƒ¼' }));
                logStore.add({
                    level: 'error',
                    source: 'Studio',
                    message: 'æ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'
                });
            };

            ws.onmessage = (event) => {
                try {
                    const data: StudioToConsoleEvent = JSON.parse(event.data);
                    handleStudioEvent(data);
                } catch (e) {
                    console.error('Failed to parse message:', e);
                }
            };
        } catch (error) {
            update(s => ({
                ...s,
                status: 'error',
                lastError: error instanceof Error ? error.message : 'æ¥ç¶šå¤±æ•—'
            }));
        }
    }

    // WebSocketåˆ‡æ–­
    function disconnect() {
        if (reconnectTimer) {
            clearTimeout(reconnectTimer);
            reconnectTimer = null;
        }

        if (ws) {
            ws.close();
            ws = null;
        }

        update(s => ({ ...s, status: 'disconnected' }));
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡
    function sendEvent(event: ConsoleToStudioEvent) {
        if (!ws || ws.readyState !== WebSocket.OPEN) {
            console.warn('WebSocket is not connected');
            return false;
        }

        try {
            ws.send(JSON.stringify(event));
            return true;
        } catch (error) {
            console.error('Failed to send event:', error);
            return false;
        }
    }

    // Studioã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
    function handleStudioEvent(event: StudioToConsoleEvent) {
        logStore.add({
            level: 'info',
            source: 'Studio',
            message: `ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡: ${event.type}`
        });

        switch (event.type) {
            case 'SPEC_UPDATED':
                // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä»•æ§˜ã®æ›´æ–°
                console.log('Spec updated:', event.agents);
                break;

            case 'PATCH_CREATED':
                // æ–°ã—ã„ãƒ‘ãƒƒãƒãŒä½œæˆã•ã‚ŒãŸ - Consoleã«é©ç”¨
                console.log('Patch created:', event.patch);
                // spec-diffã‚¹ãƒˆã‚¢ã«ãƒ‘ãƒƒãƒã‚’è¿½åŠ ï¼ˆãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§importæ¸ˆã¿ï¼‰
                appliedPatchesStore.addFromStudio({
                    id: event.patch.id,
                    name: event.patch.name,
                    description: event.patch.description,
                    icon: 'ğŸ”„',
                    category: 'capability',
                    diffs: event.patch.diffs.map(d => ({
                        agentName: d.agentName,
                        operation: d.operation,
                        path: d.path,
                        before: d.before,
                        after: d.after,
                        description: d.description,
                        impact: d.impact
                    }))
                });
                break;

            case 'SCENARIO_CREATED':
                // æ–°ã—ã„ã‚·ãƒŠãƒªã‚ªãŒä½œæˆã•ã‚ŒãŸ
                console.log('Scenario created:', event.scenario);
                break;

            case 'SYNC_RESPONSE':
                // åŒæœŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
                update(s => ({ ...s, lastSyncTime: new Date() }));
                console.log('Sync response received:', event);
                break;
        }

        // å¤–éƒ¨ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã«é€šçŸ¥
        if (onEventReceived) {
            onEventReceived(event);
        }
    }

    return {
        subscribe,

        // æ¥ç¶š
        connect,

        // åˆ‡æ–­
        disconnect,

        // ã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡
        send: sendEvent,

        // Studio URLã‚’è¨­å®š
        setStudioUrl: (url: string) => {
            update(s => ({ ...s, studioUrl: url }));
        },

        // è‡ªå‹•åŒæœŸã®è¨­å®š
        setAutoSync: (enabled: boolean) => {
            update(s => ({ ...s, autoSync: enabled }));
        },

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¨­å®š
        onEvent: (handler: (event: StudioToConsoleEvent) => void) => {
            onEventReceived = handler;
        },

        // ãƒ‘ãƒƒãƒé©ç”¨ã‚’é€šçŸ¥
        notifyPatchApplied: (patchId: string) => {
            const patches = get(appliedPatchesStore);
            const patch = patches.find(p => p.id === patchId);
            if (patch) {
                // PredefinedPatchå‹ã‚’SpecPatchå½¢å¼ã«å¤‰æ›ã—ã¦é€ä¿¡
                sendEvent({
                    type: 'PATCH_APPLIED',
                    patch: {
                        id: patch.id,
                        name: patch.name,
                        description: patch.description,
                        diffs: patch.diffs.map((d, i) => ({
                            id: `${patch.id}-diff-${i}`,
                            ...d
                        })),
                        appliedAt: new Date()
                    }
                });
            }
        },

        // ãƒ‘ãƒƒãƒå–æ¶ˆã‚’é€šçŸ¥
        notifyPatchReverted: (patchId: string) => {
            sendEvent({ type: 'PATCH_REVERTED', patchId });
        },

        // åŒæœŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        requestSync: () => {
            sendEvent({ type: 'SYNC_REQUEST' });
        }
    };
}

export const studioConnection = createStudioConnectionStore();
</file>

<file path="src/routes/+layout.svelte">
<script lang="ts">
	import '../global.css';

	let { children } = $props();
</script>

<svelte:head>
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" />
	<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet" />
</svelte:head>

<div class="app-wrapper scanlines">
	{@render children()}
</div>

<style>
	.app-wrapper {
		min-height: 100vh;
		width: 100%;
	}
</style>
</file>

<file path="src/app.html">
<!doctype html>
<html lang="ja">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="theme-color" content="#0a0a1a" />
		<meta name="description" content="SFé¢¨AIã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ " />
		<link rel="icon" href="%sveltekit.assets%/icons/icon-192.png" />
		<link rel="apple-touch-icon" href="%sveltekit.assets%/icons/icon-192.png" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
</file>

<file path=".gitignore">
node_modules

# Output
.output
.vercel
.netlify
.wrangler
/.svelte-kit
/build

# OS
.DS_Store
Thumbs.db

# Env
.env
.env.*
!.env.example
!.env.test

# Vite
vite.config.js.timestamp-*
vite.config.ts.timestamp-*
</file>

<file path="svelte.config.js">
import adapter from '@sveltejs/adapter-static';
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte';

/** @type {import('@sveltejs/kit').Config} */
const config = {
	preprocess: vitePreprocess(),

	kit: {
		adapter: adapter({
			pages: 'build',
			assets: 'build',
			fallback: 'index.html',
			precompress: false,
			strict: true
		}),
		paths: {
			base: process.env.NODE_ENV === 'production' ? '/aether-console' : ''
		}
	}
};

export default config;
</file>

<file path="vite.config.ts">
import { sveltekit } from '@sveltejs/kit/vite';
import { SvelteKitPWA } from '@vite-pwa/sveltekit';
import { defineConfig } from 'vite';

export default defineConfig({
	plugins: [
		sveltekit(),
		SvelteKitPWA({
			registerType: 'autoUpdate',
			manifest: {
				name: 'Aether Console',
				short_name: 'Aether',
				description: 'SFé¢¨AIã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ ',
				theme_color: '#0a0a1a',
				background_color: '#0a0a1a',
				display: 'standalone',
				icons: [
					{
						src: 'icons/icon-192.png',
						sizes: '192x192',
						type: 'image/png'
					},
					{
						src: 'icons/icon-512.png',
						sizes: '512x512',
						type: 'image/png'
					}
				]
			},
			workbox: {
				globPatterns: ['**/*.{js,css,html,svg,png,woff,woff2}']
			}
		})
	]
});
</file>

<file path="src/lib/components/AgentChat.svelte">
<!--
  AgentChat.svelte - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®ãƒãƒ£ãƒƒãƒˆãƒ‘ãƒãƒ«
-->
<script lang="ts">
	import { onMount } from 'svelte';
	import { agentExecutor } from '$lib/stores/agent-executor';
	import { agentStore } from '$lib/stores/simulation';
	import { settingsStore } from '$lib/stores/settings-store';

	let agents = $derived($agentStore);
	let executorState = $derived($agentExecutor);
	let settings = $derived($settingsStore);

	let selectedAgent = $state('analyzer');
	let userInput = $state('');

	// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§åˆæœŸåŒ–ï¼‹ãƒ¢ãƒ‡ãƒ«ä¸€è¦§å–å¾—
	onMount(async () => {
		settingsStore.init();
		if (settings.apiKeyReady && settings.availableModels.length === 0) {
			await settingsStore.loadModels();
		}
	});

	async function handleSubmit() {
		if (!userInput.trim() || executorState.isRunning) return;

		const input = userInput;
		userInput = '';

		try {
			if (settings.streamingEnabled) {
				await agentExecutor.executeStream(selectedAgent, input, settings.selectedModel);
			} else {
				await agentExecutor.execute(selectedAgent, input, settings.selectedModel);
			}
		} catch (error) {
			// ã‚¨ãƒ©ãƒ¼ã¯storeçµŒç”±ã§è¡¨ç¤º
		}
	}

	function handleKeyDown(event: KeyboardEvent) {
		if (event.key === 'Enter' && !event.shiftKey) {
			event.preventDefault();
			handleSubmit();
		}
	}
</script>

<div class="agent-chat">
	{#if !settings.apiKeyReady}
		<div class="api-notice">
			<span class="icon">ğŸ”‘</span>
			<p>AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯APIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„</p>
			<small>å³ä¸Šã® âš™ï¸ ãƒœã‚¿ãƒ³ã‹ã‚‰è¨­å®š</small>
		</div>
	{:else}
			<div class="chat-header">
			<div class="row">
				<select class="agent-select" bind:value={selectedAgent} disabled={executorState.isRunning}>
					{#each agents as agent}
						<option value={agent.name}>{agent.displayName}</option>
					{/each}
				</select>
				<select 
					class="model-select" 
					bind:value={settings.selectedModel} 
					onchange={(e) => settingsStore.setModel((e.target as HTMLSelectElement).value)}
					disabled={executorState.isRunning || settings.isLoadingModels}
				>
					{#if settings.isLoadingModels}
						<option>èª­è¾¼ä¸­...</option>
					{:else if settings.availableModels.length === 0}
						<option>ãƒ¢ãƒ‡ãƒ«ãªã—</option>
					{:else}
						{#each settings.availableModels as model}
							<option value={model.id}>{model.name}</option>
						{/each}
					{/if}
				</select>
				<label class="stream-toggle" title="ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¿œç­”">
					<input 
						type="checkbox" 
						checked={settings.streamingEnabled}
						onchange={() => settingsStore.setStreaming(!settings.streamingEnabled)}
						disabled={executorState.isRunning}
					/>
					<span class="toggle-icon">{settings.streamingEnabled ? 'âš¡' : 'ğŸ“¦'}</span>
				</label>
			</div>
		</div>

		<div class="chat-response">
			{#if executorState.isRunning}
				<div class="loading">
					<span class="spinner">â—‡</span>
					<span>æ€è€ƒä¸­...</span>
				</div>
			{:else if executorState.error}
				<div class="error">
					<span class="icon">âš ï¸</span>
					<span>{executorState.error}</span>
				</div>
			{:else if executorState.response}
				<div class="response">
					<pre>{executorState.response}</pre>
				</div>
			{:else}
				<div class="placeholder">
					<span class="icon">â—ˆ</span>
					<p>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚¿ã‚¹ã‚¯ã‚’ä¸ãˆã¦ãã ã•ã„</p>
				</div>
			{/if}
		</div>

		<div class="chat-input">
			<textarea
				bind:value={userInput}
				onkeydown={handleKeyDown}
				placeholder="ã‚¿ã‚¹ã‚¯ã‚’å…¥åŠ›... (Enter ã§é€ä¿¡)"
				disabled={executorState.isRunning}
			></textarea>
			{#if executorState.isRunning}
				<button
					class="cancel-btn"
					onclick={() => agentExecutor.cancel()}
				>
					â¹
				</button>
			{:else}
				<button
					class="send-btn"
					onclick={handleSubmit}
					disabled={!userInput.trim()}
				>
					â–¶
				</button>
			{/if}
		</div>
	{/if}
</div>

<style>
	.agent-chat {
		display: flex;
		flex-direction: column;
		height: 100%;
		min-height: 300px;
	}

	.api-notice {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		height: 100%;
		color: var(--color-text-dim);
		text-align: center;
		gap: var(--space-sm);
	}

	.api-notice .icon {
		font-size: 2rem;
	}

	.api-notice p {
		font-size: 0.8rem;
		margin: 0;
	}

	.api-notice small {
		font-size: 0.7rem;
		color: var(--color-cyan);
	}

	.chat-header {
		margin-bottom: var(--space-md);
	}

	.chat-header .row {
		display: flex;
		gap: var(--space-sm);
	}

	.agent-select {
		flex: 1;
	}

	.model-select {
		width: 160px;
	}

	.stream-toggle {
		display: flex;
		align-items: center;
		cursor: pointer;
		padding: var(--space-xs) var(--space-sm);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-sm);
		background: var(--color-bg-primary);
		transition: all var(--transition-fast);
	}

	.stream-toggle:hover {
		border-color: var(--color-cyan);
	}

	.stream-toggle input {
		display: none;
	}

	.toggle-icon {
		font-size: 1rem;
	}

	.chat-header select {
		padding: var(--space-sm);
		background: var(--color-bg-primary);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-sm);
		color: var(--color-text);
		font-size: 0.8rem;
	}

	.chat-header select:focus {
		outline: none;
		border-color: var(--color-cyan);
	}

	.chat-response {
		flex: 1;
		overflow-y: auto;
		padding: var(--space-md);
		background: rgba(0, 0, 0, 0.2);
		border-radius: var(--radius-sm);
		margin-bottom: var(--space-md);
		min-height: 150px;
	}

	.loading {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
		color: var(--color-cyan);
	}

	.spinner {
		animation: spin 1s linear infinite;
	}

	@keyframes spin {
		from { transform: rotate(0deg); }
		to { transform: rotate(360deg); }
	}

	.error {
		display: flex;
		align-items: flex-start;
		gap: var(--space-sm);
		color: var(--color-red);
		font-size: 0.8rem;
		word-break: break-all;
	}

	.response pre {
		margin: 0;
		white-space: pre-wrap;
		word-break: break-word;
		font-family: var(--font-mono);
		font-size: 0.8rem;
		line-height: 1.6;
	}

	.placeholder {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		height: 100%;
		color: var(--color-text-dim);
	}

	.placeholder .icon {
		font-size: 1.5rem;
		opacity: 0.5;
		margin-bottom: var(--space-sm);
	}

	.placeholder p {
		font-size: 0.8rem;
	}

	.chat-input {
		display: flex;
		gap: var(--space-sm);
	}

	.chat-input textarea {
		flex: 1;
		padding: var(--space-sm);
		background: var(--color-bg-primary);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-sm);
		color: var(--color-text);
		font-size: 0.85rem;
		resize: none;
		min-height: 60px;
	}

	.chat-input textarea:focus {
		outline: none;
		border-color: var(--color-cyan);
	}

	.send-btn {
		padding: var(--space-sm) var(--space-md);
		background: rgba(0, 255, 255, 0.1);
		border: 1px solid var(--color-cyan);
		border-radius: var(--radius-sm);
		color: var(--color-cyan);
		cursor: pointer;
		font-size: 1rem;
		transition: all var(--transition-fast);
	}

	.send-btn:hover:not(:disabled) {
		background: rgba(0, 255, 255, 0.2);
		box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
	}

	.send-btn:disabled {
		opacity: 0.3;
		cursor: not-allowed;
	}

	.cancel-btn {
		padding: var(--space-sm) var(--space-md);
		background: rgba(255, 85, 85, 0.2);
		border: 1px solid var(--color-red);
		border-radius: var(--radius-sm);
		color: var(--color-red);
		cursor: pointer;
		font-size: 1rem;
		transition: all var(--transition-fast);
		animation: pulse-cancel 1s infinite;
	}

	.cancel-btn:hover {
		background: rgba(255, 85, 85, 0.3);
		box-shadow: 0 0 15px rgba(255, 85, 85, 0.4);
	}

	@keyframes pulse-cancel {
		0%, 100% { opacity: 1; }
		50% { opacity: 0.7; }
	}
</style>
</file>

<file path="src/lib/components/ConsoleLayout.svelte">
<!--
  ConsoleLayout.svelte - å¸ä»¤å®¤ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
  
  NOCï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒ³ã‚¿ãƒ¼ï¼‰é¢¨ã®å›ºå®šã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
-->
<script lang="ts">
	import GlitchText from "./GlitchText.svelte";
	import StudioStatus from "./StudioStatus.svelte";

	interface Props {
		title?: string;
		subtitle?: string;
		onSettingsClick?: () => void;
	}

	let {
		title = "AETHER CONSOLE",
		subtitle = "AI Operations Command Center",
		onSettingsClick,
		children,
	} = $props<Props>();

	// ç¾åœ¨æ™‚åˆ»ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ï¼‰
	let currentTime = $state(new Date());

	$effect(() => {
		const interval = setInterval(() => {
			currentTime = new Date();
		}, 1000);
		return () => clearInterval(interval);
	});

	function formatTime(date: Date): string {
		return date.toLocaleTimeString("ja-JP", { hour12: false });
	}

	function formatDate(date: Date): string {
		return date.toLocaleDateString("ja-JP", {
			year: "numeric",
			month: "2-digit",
			day: "2-digit",
		});
	}
</script>

<div class="console-layout">
	<!-- Top Bar -->
	<header class="console-topbar">
		<div class="topbar-left">
			<div class="system-status">
				<span class="status-dot active"></span>
				<span class="status-label">SYSTEM ONLINE</span>
			</div>
			<StudioStatus />
		</div>
		<div class="topbar-center">
			<GlitchText text={title} tag="h1" intensity="medium" />
			<p class="subtitle">{subtitle}</p>
		</div>
		<div class="topbar-right">
			<button class="settings-btn" onclick={() => onSettingsClick?.()}>
				âš™ï¸
			</button>
			<div class="datetime">
				<span class="time">{formatTime(currentTime)}</span>
				<span class="date">{formatDate(currentTime)}</span>
			</div>
		</div>
	</header>

	<!-- Main Content Area -->
	<main class="console-main">
		{@render children?.()}
	</main>

	<!-- Bottom Status Bar -->
	<footer class="console-statusbar">
		<div class="statusbar-section">
			<span class="label">AGENTS</span>
			<span class="value text-cyan">4 / 8</span>
		</div>
		<div class="statusbar-section">
			<span class="label">CPU</span>
			<span class="value text-green">23%</span>
		</div>
		<div class="statusbar-section">
			<span class="label">MEMORY</span>
			<span class="value text-green">1.2GB</span>
		</div>
		<div class="statusbar-section">
			<span class="label">NETWORK</span>
			<span class="value text-cyan">â—</span>
		</div>
		<div class="statusbar-spacer"></div>
		<div class="statusbar-section">
			<span class="version">AETHER v0.0.1-alpha</span>
		</div>
	</footer>
</div>

<style>
	.console-layout {
		display: grid;
		grid-template-rows: auto 1fr auto;
		min-height: 100vh;
		overflow: hidden;
	}

	/* Top Bar */
	.console-topbar {
		display: grid;
		grid-template-columns: 1fr auto 1fr;
		align-items: center;
		padding: var(--space-md) var(--space-lg);
		background: linear-gradient(
			180deg,
			rgba(0, 255, 255, 0.05) 0%,
			transparent 100%
		);
		border-bottom: 1px solid var(--color-border);
	}

	.topbar-left {
		display: flex;
		align-items: center;
	}

	.topbar-center {
		text-align: center;
	}

	.topbar-center :global(h1) {
		font-size: 1.75rem;
		letter-spacing: 0.15em;
		margin: 0;
	}

	.subtitle {
		font-size: 0.7rem;
		color: var(--color-text-dim);
		text-transform: uppercase;
		letter-spacing: 0.2em;
		margin-top: var(--space-xs);
	}

	.topbar-right {
		display: flex;
		justify-content: flex-end;
		align-items: center;
		gap: var(--space-md);
	}

	.settings-btn {
		background: transparent;
		border: 1px solid var(--color-border);
		border-radius: var(--radius-sm);
		padding: var(--space-xs) var(--space-sm);
		cursor: pointer;
		font-size: 1rem;
		transition: all var(--transition-fast);
	}

	.settings-btn:hover {
		border-color: var(--color-cyan);
		box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
	}

	/* System Status */
	.system-status {
		display: flex;
		align-items: center;
		gap: var(--space-sm);
	}

	.status-dot {
		width: 8px;
		height: 8px;
		border-radius: 50%;
		background: var(--color-text-dim);
	}

	.status-dot.active {
		background: var(--color-green);
		box-shadow: 0 0 10px var(--color-green);
		animation: pulse 2s infinite;
	}

	.status-label {
		font-size: 0.7rem;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: var(--color-green);
	}

	/* DateTime */
	.datetime {
		display: flex;
		flex-direction: column;
		align-items: flex-end;
		font-family: var(--font-mono);
	}

	.time {
		font-size: 1.25rem;
		color: var(--color-cyan);
		text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
	}

	.date {
		font-size: 0.7rem;
		color: var(--color-text-dim);
	}

	/* Main Content */
	.console-main {
		padding: var(--space-lg);
		overflow: auto;
	}

	/* Status Bar */
	.console-statusbar {
		display: flex;
		align-items: center;
		gap: var(--space-lg);
		padding: var(--space-sm) var(--space-lg);
		background: rgba(0, 255, 255, 0.02);
		border-top: 1px solid var(--color-border);
		font-family: var(--font-mono);
		font-size: 0.7rem;
	}

	.statusbar-section {
		display: flex;
		align-items: center;
		gap: var(--space-xs);
	}

	.statusbar-section .label {
		color: var(--color-text-dim);
		text-transform: uppercase;
	}

	.statusbar-section .value {
		font-weight: 500;
	}

	.statusbar-spacer {
		flex: 1;
	}

	.version {
		color: var(--color-text-dim);
	}

	@keyframes pulse {
		0%,
		100% {
			opacity: 1;
		}
		50% {
			opacity: 0.5;
		}
	}

	/* Responsive */
	@media (max-width: 768px) {
		.console-topbar {
			grid-template-columns: 1fr;
			gap: var(--space-md);
			text-align: center;
		}

		.topbar-left,
		.topbar-right {
			justify-content: center;
		}

		.console-statusbar {
			flex-wrap: wrap;
			justify-content: center;
		}
	}
</style>
</file>

<file path="src/lib/stores/agent-executor.ts">
/**
 * AI Agent Executor
 * ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’AI APIã§å®Ÿè¡Œã™ã‚‹ï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯¾å¿œï¼‰
 */

import { writable, get } from 'svelte/store';
import { callGemini, callGeminiStream, isApiKeyAvailable, type AgentMessage, type AgentConfig } from './gemini-client';
import { agentStore, logStore } from './simulation';
import { agents as agentDefinitions } from '../data/agents';
import type { Agent } from '../types/agent';

interface AgentExecutionState {
    isRunning: boolean;
    currentAgent: string | null;
    response: string;
    error: string | null;
}

// AbortControllerã‚’ä¿æŒ
let currentAbortController: AbortController | null = null;

function createAgentExecutorStore() {
    const { subscribe, set, update } = writable<AgentExecutionState>({
        isRunning: false,
        currentAgent: null,
        response: '',
        error: null
    });

    // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆ
    function buildSystemPrompt(agent: Agent): string {
        return `# ã‚ãªãŸã¯ã€Œ${agent.displayName}ã€ã¨ã„ã†AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™

## å½¹å‰²
${agent.role}

## èƒ½åŠ›
${agent.capabilities.map(c => `- ${c}`).join('\n')}

## åˆ¶ç´„
${agent.constraints.map(c => `- ${c}`).join('\n')}

## é€šä¿¡å¯èƒ½ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
- é€ä¿¡å…ˆ: ${agent.communication.canSendTo.join(', ') || 'ãªã—'}
- å—ä¿¡å…ƒ: ${agent.communication.canReceiveFrom.join(', ') || 'ãªã—'}

## å¿œç­”å½¢å¼
- ç°¡æ½”ã«ã€å½¹å‰²ã«æ²¿ã£ãŸå¿œç­”ã‚’ã—ã¦ãã ã•ã„
- åˆ†æçµæœã‚„äºˆæ¸¬ã¯å…·ä½“çš„ã«ç¤ºã—ã¦ãã ã•ã„
- ä¸ç¢ºå®Ÿãªå ´åˆã¯æ˜ç¤ºã—ã¦ãã ã•ã„
`;
    }

    return {
        subscribe,

        // APIã‚­ãƒ¼ãŒåˆ©ç”¨å¯èƒ½ã‹ç¢ºèª
        isReady: () => isApiKeyAvailable(),

        // å®Ÿè¡Œã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        cancel: () => {
            if (currentAbortController) {
                currentAbortController.abort();
                currentAbortController = null;

                update(s => ({
                    ...s,
                    isRunning: false,
                    error: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ'
                }));

                // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
                const state = get({ subscribe });
                if (state.currentAgent) {
                    agentStore.updateState(state.currentAgent, { status: 'idle', currentTask: undefined });
                    logStore.add({
                        level: 'warning',
                        source: 'System',
                        message: 'ã‚¿ã‚¹ã‚¯ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ'
                    });
                }
            }
        },

        // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å®Ÿè¡Œ
        execute: async (agentName: string, input: string, model?: string): Promise<string> => {
            const agent = agentDefinitions.find(a => a.name === agentName);
            if (!agent) {
                throw new Error(`ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ${agentName} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
            }

            if (!isApiKeyAvailable()) {
                throw new Error('APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
            }

            // æ–°ã—ã„AbortControllerã‚’ä½œæˆ
            currentAbortController = new AbortController();

            update(s => ({ ...s, isRunning: true, currentAgent: agentName, response: '', error: null }));

            // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã‚’æ›´æ–°
            agentStore.updateState(agentName, { status: 'active', currentTask: 'å®Ÿè¡Œä¸­...' });

            // ãƒ­ã‚°ã«è¨˜éŒ²
            logStore.add({
                level: 'info',
                source: agent.displayName,
                message: `ã‚¿ã‚¹ã‚¯é–‹å§‹: ${input.substring(0, 50)}...`
            });

            try {
                const config: AgentConfig = {
                    systemPrompt: buildSystemPrompt(agent),
                    temperature: 0.7,
                    maxTokens: 1024
                };

                const messages: AgentMessage[] = [
                    { role: 'user', content: input }
                ];

                const response = await callGemini(messages, config, model, currentAbortController.signal);

                update(s => ({ ...s, response, isRunning: false }));

                // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã‚’æ›´æ–°
                agentStore.updateState(agentName, {
                    status: 'idle',
                    currentTask: undefined,
                    metrics: {
                        ...agent.state.metrics,
                        tasksCompleted: agent.state.metrics.tasksCompleted + 1
                    }
                });

                // ãƒ­ã‚°ã«è¨˜éŒ²
                logStore.add({
                    level: 'success',
                    source: agent.displayName,
                    message: 'ã‚¿ã‚¹ã‚¯å®Œäº†'
                });

                currentAbortController = null;
                return response;
            } catch (error) {
                currentAbortController = null;

                // AbortErrorã®å ´åˆã¯ç‰¹åˆ¥å‡¦ç†
                if (error instanceof Error && error.name === 'AbortError') {
                    update(s => ({ ...s, error: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ', isRunning: false }));
                    agentStore.updateState(agentName, { status: 'idle', currentTask: undefined });
                    throw error;
                }

                const errorMessage = error instanceof Error ? error.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼';

                update(s => ({ ...s, error: errorMessage, isRunning: false }));

                // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã‚’æ›´æ–°
                agentStore.updateState(agentName, { status: 'error', currentTask: 'ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ' });

                // ãƒ­ã‚°ã«è¨˜éŒ²
                logStore.add({
                    level: 'error',
                    source: agent.displayName,
                    message: `ã‚¨ãƒ©ãƒ¼: ${errorMessage}`
                });

                throw error;
            }
        },

        // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å®Ÿè¡Œï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¿œç­”ï¼‰
        executeStream: async (agentName: string, input: string, model?: string): Promise<string> => {
            const agent = agentDefinitions.find(a => a.name === agentName);
            if (!agent) {
                throw new Error(`ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ${agentName} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
            }

            if (!isApiKeyAvailable()) {
                throw new Error('APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
            }

            update(s => ({ ...s, isRunning: true, currentAgent: agentName, response: '', error: null }));

            // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã‚’æ›´æ–°
            agentStore.updateState(agentName, { status: 'active', currentTask: 'å¿œç­”ä¸­...' });

            // ãƒ­ã‚°ã«è¨˜éŒ²
            logStore.add({
                level: 'info',
                source: agent.displayName,
                message: `ã‚¿ã‚¹ã‚¯é–‹å§‹: ${input.substring(0, 50)}...`
            });

            const config: AgentConfig = {
                systemPrompt: buildSystemPrompt(agent),
                temperature: 0.7,
                maxTokens: 1024
            };

            const messages: AgentMessage[] = [
                { role: 'user', content: input }
            ];

            let fullResponse = '';

            try {
                for await (const chunk of callGeminiStream(messages, config, model)) {
                    fullResponse += chunk;
                    update(s => ({ ...s, response: fullResponse }));
                }

                // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã‚’æ›´æ–°
                agentStore.updateState(agentName, {
                    status: 'idle',
                    currentTask: undefined,
                    metrics: {
                        ...agent.state.metrics,
                        tasksCompleted: agent.state.metrics.tasksCompleted + 1
                    }
                });

                // ãƒ­ã‚°ã«è¨˜éŒ²
                logStore.add({
                    level: 'success',
                    source: agent.displayName,
                    message: 'ã‚¿ã‚¹ã‚¯å®Œäº†'
                });

                update(s => ({ ...s, isRunning: false }));
                return fullResponse;
            } catch (error) {
                const errorMessage = error instanceof Error ? error.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼';

                update(s => ({ ...s, error: errorMessage, isRunning: false }));

                // ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ã‚’æ›´æ–°
                agentStore.updateState(agentName, { status: 'error', currentTask: 'ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ' });

                // ãƒ­ã‚°ã«è¨˜éŒ²
                logStore.add({
                    level: 'error',
                    source: agent.displayName,
                    message: `ã‚¨ãƒ©ãƒ¼: ${errorMessage}`
                });

                throw error;
            }
        },

        // ãƒªã‚»ãƒƒãƒˆ
        reset: () => {
            if (currentAbortController) {
                currentAbortController.abort();
                currentAbortController = null;
            }
            set({
                isRunning: false,
                currentAgent: null,
                response: '',
                error: null
            });
        }
    };
}

export const agentExecutor = createAgentExecutorStore();
</file>

<file path="package.json">
{
	"name": "aether-console",
	"private": true,
	"version": "0.0.1",
	"type": "module",
	"scripts": {
		"dev": "vite dev",
		"build": "vite build",
		"preview": "vite preview",
		"prepare": "svelte-kit sync || echo ''",
		"check": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json",
		"check:watch": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json --watch"
	},
	"devDependencies": {
		"@sveltejs/adapter-auto": "^7.0.0",
		"@sveltejs/adapter-static": "^3.0.10",
		"@sveltejs/kit": "^2.49.1",
		"@sveltejs/vite-plugin-svelte": "^6.2.1",
		"@vite-pwa/sveltekit": "^1.1.0",
		"svelte": "^5.45.6",
		"svelte-check": "^4.3.4",
		"typescript": "^5.9.3",
		"vite": "^7.2.6",
		"vite-plugin-pwa": "^1.2.0"
	}
}
</file>

<file path="README.md">
# Aether Console

SFé¢¨ã®AIã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ  â€” è¤‡æ•°ã®AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å¯è¦–åŒ–ãƒ»åˆ¶å¾¡ã™ã‚‹PWAã€‚

## ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

> ç”»é¢ã¯SFã®å¸ä»¤å®¤ã€‚è¤‡æ•°ã®AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå½¹å‰²ã«å¿œã˜ã¦æƒ…å ±ã‚’è§£æã—ã€æœ€çµ‚çš„ãªææ¡ˆã‚’ã¾ã¨ã‚ã‚‹ã€‚

- **ä¸–ç•Œè¦³ Ã— æŠ€è¡“ Ã— PWA** ã®èåˆ
- Spec-Kitã§å„AIã®å½¹å‰²ã‚’å®šç¾©
- AIåŒå£«ãŒå”èª¿ãƒ»ä¼šè©±ã—ã€çµæœã‚’æç¤º

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **SvelteKit** + **TypeScript**
- **Vite** (ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«)
- **Vanilla CSS** (ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°)
- **GitHub Pages** (ãƒ‡ãƒ—ãƒ­ã‚¤)

## åˆ©ç”¨æ–¹æ³•

### 1. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
git clone https://github.com/mjurymaru-blip/aether-console.git
cd aether-console
npm install
```

### 2. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5173 ã‚’é–‹ã

### 3. APIã‚­ãƒ¼è¨­å®š

1. å³ä¸Šã® âš™ï¸ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. Gemini APIã‚­ãƒ¼ã‚’å…¥åŠ›
3. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ä¿å­˜

### 4. æ©Ÿèƒ½ã‚’ä½¿ã†

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| **AI Agent Chat** | å€‹åˆ¥ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®å¯¾è©± |
| **Integrated Proposal** | è¤‡æ•°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®çµ±åˆåˆ†æ |
| **Spec Patcher** | ä»•æ§˜å¤‰æ›´ã®é©ç”¨ |
| **Studioé€£æº** | Spec-Flow Studioã¨ã®æ¥ç¶š |

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
src/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ components/   # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ stores/       # çŠ¶æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ types/        # å‹å®šç¾©
â”‚   â””â”€â”€ data/         # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©
â”œâ”€â”€ routes/           # ãƒšãƒ¼ã‚¸
â””â”€â”€ app.html          # HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
static/               # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
```

> **Note:** `docs/` ã¨ `.agent/` ã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªï¼ˆGiteaï¼‰ã®ã¿ã«å­˜åœ¨ã—ã¾ã™ã€‚

## ãƒ“ãƒ«ãƒ‰

```bash
# æœ¬ç•ªãƒ“ãƒ«ãƒ‰
npm run build

# ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
npm run preview
```

## Spec-Flow Studioé€£æº

Spec-Flow Studioã¨WebSocketã§é€£æºã—ã€ä»•æ§˜å¤‰æ›´ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã§ãã¾ã™ã€‚

```typescript
// æ¥ç¶šå…ˆ
ws://localhost:3001/api/ws
```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
</file>

<file path="src/routes/+page.svelte">
<script lang="ts">
	import ConsoleLayout from '$lib/components/ConsoleLayout.svelte';
	import AgentCard from '$lib/components/AgentCard.svelte';
	import ConsoleLog from '$lib/components/ConsoleLog.svelte';
	import Panel from '$lib/components/Panel.svelte';
	import ScenarioPlayer from '$lib/components/ScenarioPlayer.svelte';
	import MessageFlow from '$lib/components/MessageFlow.svelte';
	import SpecPatcher from '$lib/components/SpecPatcher.svelte';
	import DiffVisualizer from '$lib/components/DiffVisualizer.svelte';
	import AgentChat from '$lib/components/AgentChat.svelte';
	import ProposalPanel from '$lib/components/ProposalPanel.svelte';
	import ApiKeyDialog from '$lib/components/ApiKeyDialog.svelte';
	import { agentStore, logStore } from '$lib/stores/simulation';

	// Store ã‹ã‚‰çŠ¶æ…‹ã‚’å–å¾—
	let agents = $derived($agentStore);
	let logs = $derived($logStore);

	// ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°
	let activeCount = $derived(agents.filter(a => a.state.status === 'active').length);
	let warningCount = $derived(agents.filter(a => a.state.status === 'warning').length);
	let errorCount = $derived(agents.filter(a => a.state.status === 'error' || a.state.status === 'offline').length);

	// è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°
	let showSettings = $state(false);

	function handleSettingsClick() {
		showSettings = true;
	}

	function handleSettingsClose() {
		showSettings = false;
	}

	function handleKeySet() {
		// APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚ŒãŸã‚‰UIã‚’æ›´æ–°
	}
</script>

<ConsoleLayout onSettingsClick={handleSettingsClick}>
	<div class="dashboard-grid">
		<!-- Left Column -->
		<section class="left-column">
			<!-- AI Chat -->
			<Panel title="AI AGENT CHAT" variant="corner" glow>
				<AgentChat />
			</Panel>

			<!-- Spec Patcher -->
			<Panel title="SPEC PATCHER">
				<SpecPatcher />
			</Panel>
		</section>

		<!-- Center Column -->
		<section class="center-column">
			<!-- Agent Cards -->
			<Panel title="AGENT STATUS" variant="corner">
				<div class="agents-grid">
					{#each agents as agent}
						<AgentCard 
							name={agent.displayName}
							role={agent.description}
							status={agent.state.status}
							currentTask={agent.state.currentTask}
							progress={agent.state.progress}
							metrics={{
								tasksCompleted: agent.state.metrics.tasksCompleted,
								responseTime: agent.state.metrics.averageResponseTime,
								errorRate: agent.state.metrics.errorRate
							}}
						/>
					{/each}
				</div>
			</Panel>

			<!-- Quick Stats -->
			<Panel title="SYSTEM METRICS">
				<div class="metrics-grid">
					<div class="metric-card">
						<span class="metric-value text-cyan">{activeCount}</span>
						<span class="metric-label">Active</span>
					</div>
					<div class="metric-card">
						<span class="metric-value text-green">{agents.length}</span>
						<span class="metric-label">Total</span>
					</div>
					<div class="metric-card">
						<span class="metric-value text-orange">{warningCount}</span>
						<span class="metric-label">Warnings</span>
					</div>
					<div class="metric-card">
						<span class="metric-value text-red">{errorCount}</span>
						<span class="metric-label">Errors</span>
					</div>
					</div>
			</Panel>

			<!-- Integrated Proposal -->
			<Panel title="INTEGRATED PROPOSAL" variant="corner" glow>
				<ProposalPanel />
			</Panel>
		</section>

		<!-- Right Column -->
		<section class="right-column">
			<!-- Scenario Player -->
			<Panel title="SCENARIO PLAYER">
				<ScenarioPlayer />
			</Panel>

			<!-- Applied Changes -->
			<Panel title="APPLIED CHANGES">
				<DiffVisualizer />
			</Panel>

			<!-- Console Output -->
			<Panel title="CONSOLE OUTPUT" variant="minimal">
				<ConsoleLog {logs} maxHeight="200px" />
			</Panel>
		</section>
	</div>
</ConsoleLayout>

{#if showSettings}
	<ApiKeyDialog onClose={handleSettingsClose} onKeySet={handleKeySet} />
{/if}

<style>
	.dashboard-grid {
		display: grid;
		grid-template-columns: 380px 1fr 320px;
		gap: var(--space-lg);
		height: 100%;
	}

	/* Left Column */
	.left-column {
		display: flex;
		flex-direction: column;
		gap: var(--space-lg);
	}

	/* Center Column */
	.center-column {
		display: flex;
		flex-direction: column;
		gap: var(--space-lg);
	}

	/* Right Column */
	.right-column {
		display: flex;
		flex-direction: column;
		gap: var(--space-lg);
	}

	/* Agents Grid */
	.agents-grid {
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: var(--space-md);
	}

	/* Metrics Grid */
	.metrics-grid {
		display: grid;
		grid-template-columns: repeat(4, 1fr);
		gap: var(--space-sm);
	}

	.metric-card {
		background: rgba(0, 0, 0, 0.2);
		padding: var(--space-md);
		border-radius: var(--radius-md);
		text-align: center;
	}

	.metric-card .metric-value {
		display: block;
		font-size: 1.5rem;
		font-weight: 600;
		font-family: var(--font-mono);
	}

	.metric-card .metric-label {
		font-size: 0.65rem;
		color: var(--color-text-dim);
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	/* Responsive */
	@media (max-width: 1400px) {
		.dashboard-grid {
			grid-template-columns: 1fr 1fr;
		}

		.left-column {
			grid-column: 1 / 2;
		}

		.center-column {
			grid-column: 2 / 3;
		}

		.right-column {
			grid-column: 1 / 3;
		}
	}

	@media (max-width: 1024px) {
		.dashboard-grid {
			grid-template-columns: 1fr;
		}

		.left-column,
		.center-column,
		.right-column {
			grid-column: 1;
		}

		.agents-grid {
			grid-template-columns: 1fr;
		}

		.metrics-grid {
			grid-template-columns: repeat(2, 1fr);
		}
	}
</style>
</file>

<file path="docs/task.md">
# Aether Console ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ

> è©³ç´°ãªãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¯ [roadmap.md](./roadmap.md) ã‚’å‚ç…§

## Phase 1: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Œæˆ

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŸºç›¤
- [x] ãƒªãƒã‚¸ãƒˆãƒªåˆæœŸåŒ–ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ï¼‰
- [x] Gitea ãƒªãƒ¢ãƒ¼ãƒˆè¨­å®š
- [x] æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®šï¼ˆSvelteKit + TypeScriptï¼‰
- [x] SvelteKitãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–
- [x] PWAè¨­å®š
- [x] GitHub Pages ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š

### UIåŸºç›¤
- [x] SFé¢¨ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰
- [x] å¸ä»¤å®¤ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®Ÿè£…
- [x] åŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ

## Phase 2: é™çš„ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

- [x] Spec-Kitå½¢å¼è¨­è¨ˆï¼ˆåˆç¨¿ï¼‰
- [x] ãƒ¢ãƒƒã‚¯ã‚·ãƒŠãƒªã‚ªä½œæˆ
- [x] ã‚·ãƒŠãƒªã‚ªå†ç”Ÿæ©Ÿèƒ½
- [x] ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ä¼šè©±è¡¨ç¤º
- [x] Specå·®åˆ†ã®é©ç”¨ãƒ»å†ç”Ÿ
- [x] å·®åˆ†ã«ã‚ˆã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæŒ™å‹•å¤‰åŒ–ã®å¯è¦–åŒ–

## Phase 3: AIçµ±åˆ

- [x] AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡ŒåŸºç›¤
- [x] ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†
- [x] WebSocket/SSEæ¥ç¶š
- [x] ææ¡ˆçµ±åˆæ©Ÿèƒ½
- [/] Spec-Flow Studioé€£æºï¼ˆWebSocketæ¥ç¶šä¸­ï¼‰

## Future: Spec-Flow Studio

> åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦é–‹ç™ºäºˆå®š
</file>

</files>
